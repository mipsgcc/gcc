2011-11-05  Catherine Moore  <clm@codesourcery.com>

	Issue #12139

	* release-notes-csl.xml: Document.

	Backport from gcc-4_5 branch:

	2011-03-08  Richard Guenther  <rguenther@suse.de>

	Backport from mainline
	2011-02-10  Richard Guenther  <rguenther@suse.de>

	* tree-ssa-structalias.c (bitpos_of_field): Use BITS_PER_UNIT, not 8.

	2010-10-18  Richard Guenther  <rguenther@suse.de>

	PR tree-optimization/45967
	* tree-ssa-structalias.c (type_could_have_pointers): Remove.
	(could_have_pointers): Likewise.
	(handle_rhs_call, handle_const_call, handle_pure_call,
	find_func_aliases, intra_create_variable_infos): Remove calls to them.
	(struct fieldoff): Add must_have_pointers field.
	(type_must_have_pointers): New function.
	(field_must_have_pointers): Likewise.
	(push_fields_onto_fieldstack): Remove must_have_pointers_p argument.
	Adjust field merging.
	(create_function_info_for): May-have-pointers of varinfo is
	almost always true.
	(create_variable_info_for_1): Likewise.

	* gcc.dg/torture/pr45967.c: New testcase.
	* gcc.dg/torture/pr45967-2.c: Likewise.
	* gcc.dg/torture/pr45967-3.c: Likewise.
	* gcc.dg/torture/pr39074-2.c: Adjust. 
	* gcc.dg/torture/pta-escape-1.c: Likewise
	* gcc.dg/torture/pta-ptrarith-1.c: Likewise
	* gcc.dg/tree-ssa/pta-callused.c: Likewise
	* gcc.dg/tree-ssa/pta-escape-1.c: Likewise
	* gcc.dg/tree-ssa/pta-escape-2.c: Likewise
	* gcc.dg/tree-ssa/pta-escape-3.c: Likewise
	* gcc.dg/tree-ssa/ssa-pre-21.c: Likewise

	2010-10-12  Richard Guenther  <rguenther@suse.de>

	* tree-ssa-structalias.c (get_constraint_for_1): Constants
	only point to nonlocal, not anything.

2011-11-04  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #11931

	gcc/
	* config/mips/mips16.S (RET_FUNCTION): Set hidden ELF symbol
	visibility.

	* release-notes-csl.xml (MIPS16 register corruption fix): New.

2011-10-25  Chung-Lin Tang  <cltang@codesourcery.com>

	* release-notes-csl.xml (MIPS16 support and multilibs): New note.
	(MIPS16 Thread-Local Storage support added): New note.
	(OpenMP fix for MIPS Linux targets): New note.

2011-10-25  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config/mips/mips.md (PIC_JUMP_REGNUM): New constant.
	(tls_get_tp_<mode>_mips16,*tls_get_tp_<mode>_mips16_rdhwr): Add
	clobbers of register PIC_JUMP_REGNUM, add explaining comment.
	* config/mips/mips16.S (__mips16_rdhwr): Correct inaccuracy in
	comments about symbol being hidden.

2011-10-21  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config.gcc (mips64*-*-linux*,mipsisa64*-*-linux*,mips*-*-linux*):
	Use config/t-slibgcc-libgcc.
	* config/mips/mips.h (CRT_CALL_STATIC_FUNCTION): Define versions
	for MIPS16 O32.
	* config/mips/mips-protos.h (mips_symbol_type): Add
	SYMBOL_DTPREL_HI,SYMBOL_TPREL_HI. Update in comments.
	(mips_output_tls_reloc_directive): New prototype.
	* config/mips/mips16.S (__mips16_rdhwr): New.
	* config/mips/t-libgcc-mips16 (LIB1ASMFUNCS): Add _m16rdhwr.
	* config/mips/mips-ftypes.def: Add (0, (POINTER)) entry.
	* config/mips/predicates.md (tls_reloc_operand): New predicate.
	* config/mips/crtfastmath.c (set_fast_math): Add 'nomips16'
	attribute.
	* config/mips/cs-sgxx-linux.h (SYSROOT_SUFFIX_SPEC): Add MIPS16
	multlibs.
	* config/mips/cs-sgxxlite-linux.h (SYSROOT_SUFFIX_SPEC): Same.
	* config/mips/t-sgxx-linux
	(MULTILIB_OPTIONS,MULTILIB_DIRNAMES,MULTILIB_EXCEPTIONS): Same.
	* config/mips/t-sgxxlite-linux
	(MULTILIB_OPTIONS,MULTILIB_DIRNAMES,MULTILIB_EXCEPTIONS): Same.
	* config/mips/mips.md (V0_REGNUM): New constant.
	(MIPS16 %dtprel_hi,%tprel_hi split pattern): New.
	(consttable_tls_reloc): New.
	(tls_get_tp_<mode>_mips16): New insn and split pattern.
	(*tls_get_tp_<mode>_mips16_rdhwr): New insn pattern.
	* config/mips/mips.c (MIPS_FTYPE_NAME0): New.
	(mips_builtin_type): Add MIPS_BUILTIN_THREAD_POINTER.
	(mips_symbolic_constant_p): Add SYMBOL_DTPREL_HI,SYMBOL_TPREL_HI
	switch cases.
	(mips_symbol_insns_1): Same.
	(mips_cannot_force_const_mem): Return false for SYMBOL_DTPREL/TPREL
	unspecs under TARGET_MIPS16_PCREL_LOADS.
	(mips_get_tp): Add 'target' parameter, add case for TARGET_MIPS16.
	(mips_legitimize_tls_address): Remove MIPS16 TLS sorry(). Add
	required MIPS16 changes to TLS_MODEL_LOCAL_DYNAMIC and
	TLS_MODEL_LOCAL_EXEC cases.
	(mips_init_relocs): Avoid SYMBOL_DTPREL/TPREL initializations
	under TARGET_MIPS16_PCREL_LOADS. Add proper init for
	SYMBOL_DTPREL_HI/TPREL_HI.
	(mips_builtin_description): Update comments for 'avail' field.
	(THREAD_POINTER_BUILTIN): New.
	(mips_builtins): Add __builtin_mips_thread_pointer and
	__builtin_thread_pointer using THREAD_POINTER_BUILTIN().
	(MIPS_FTYPE_ATYPES0): New.
	(mips_init_builtins): Add init code for MIPS_BUILTIN_THREAD_POINTER.
	(mips_expand_builtin): Do not assume mips_builtins[]->avail is
	always non-NULL. Add MIPS_BUILTIN_THREAD_POINTER case.
	(mips16_rewrite_pool_refs): Call force_const_mem() when operand
	is tls_reloc_operand. Filter out UNSPEC_TLS_GET_TP.
	(mips_output_tls_reloc_directive): New.

	libgomp/
	* config/linux/mips/futex.h (sys_futex0): Change to static
	function with noinline, nomips16 attributes under MIPS16.

2011-10-20  Chung-Lin Tang  <cltang@codesourcery.com>

	libgomp/
	* config/linux/mips/futex.h (sys_futex0): Adjust asm statement
	to place 'li v0,SYS_futex' immediately before syscall insn.

2011-10-20  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* tree.c: Include ssaexpand.h.
	(get_callee_fndecl): Expand SSA names by TER to obtain the
	function decl.
	* Makefile.in (tree.o): Add ssaexpand.h to dependencies.

2011-10-02  Tom de Vries  <tom@codesourcery.com>

	Issue #12157

	gcc/
	* reorg.c (redundant_insn): Handle label in delay slot.

2011-09-28  Catherine Moore  <clm@codesourcery.com>

	Issue #12036

	gcc/
	* config/mips/mips.c (WALK_INSNS): New macro.
	(OK_FOR_MIPS16_BRANCH_OFFSET): New macro.
	(mips16_count_matching_branches): New function.
	(walk_insns_forward): New function.
	(walk_insns_reverse): New function.
	(mips16_update_branch_info): New function.
	(mips16_zero_branch_info): New function.
	(mips16_check_branches): New function.
	(mips_reorg_process_instructions): Call mips16_check_branches.
	* config/mips.h (mips16_branch_info_t): New typedef.

	* release-notes-csl.xml: Document.

2011-09-26  Paul Brook  <paul@codesourcery.com>

	Backport from trunk:
	gcc/
	* except.c (switch_to_exception_section): Place tables for
	DECL_ONE_ONLY functions in comdat groups.

2011-09-11  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* final.c (shorten_branches): Handle deleted label in delay slot.
	* emit-rtl.c (verify_rtl_sharing): Same.
	* cfglayout.c (reemit_insn_block_notes): Same.
	* reorg.c (try_merge_delay_insns): Same.
	(redundant_insn): Handle (deleted) label in delay slot.
	(first_real_insn_in_seq): New function.
	(relax_delay_slots): Use first_insn.
	* rtl.h (DELETED_NOTE_P): Define.

2011-09-10  Tom de Vries  <tom@codesourcery.com>

	Issue #12030

	gcc/
	* stmt.c (emit_case_bit_tests): Calculate total_prob.  Scale label
	probabilities to total_prob.  Don't set jump probabilities if profile
	absent.

2011-09-06  Tom de Vries  <tom@codesourcery.com>

	Issue #11755
	* release-notes-csl.xml (Wrong-code bug fix): New note.

2011-09-06  Tom de Vries  <tom@codesourcery.com>

	Issue #11755

	gcc/
	* reorg.c (steal_delay_list_from_target): Fix handling
	of annullable insns.

2011-07-24  Sandra Loosemore  <sandra@codesourcery.com>

	gcc/
	Backport from mainline:

	2011-07-24  H.J. Lu  <hongjiu.lu@intel.com>

	PR bootstrap/49835
	* collect2.c (demangle_flag): Removed.

2011-07-13  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #11564

	* release-notes-csl.xml (Map file name demangling bug fix):
	New note.

	gcc/
	* configure.ac (demangler_in_ld): Default to yes.
	* configure: Regenerated.
	* collect2.c (main): When HAVE_LD_DEMANGLE is defined, don't mess with
	COLLECT_NO_DEMANGLE, and just pass --demangle and --no-demangle options
	straight through to ld.  When HAVE_LD_DEMANGLE is not defined, set
	COLLECT_NO_DEMANGLE in a way that has the intended effect on Windows.

2011-07-08  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #6223
	Issue #6234
	Issue #9116

	gcc/
	* config/m68k/m68k-devices.def: Add 51ag, 51je and 51mm.
	* doc/invoke.texi (M680x0 Options): Document.

	* release-notes.csl.xml: Add note.

2011-07-01  Julian Brown  <julian@codesourcery.com>

	Issue #11669

	* release-note-csl.xml (MIPS16 switch statement compilation fix):
	Add note.

	gcc/
	* config/mips/mips.md (MIPS16_T_REGNUM): New constant.
	(tablejump): Don't use for MIPS16_SHORT_JUMP_TABLES.
	(casesi): New.
	(casesi_internal_mips16): New.
	* config/mips/mips.h (TARGET_MIPS16_SHORT_JUMP_TABLES): Update
	comment.
	(CASE_VECTOR_MODE): Use ptr_mode unconditionally.
	(CASE_VECTOR_SHORTEN_MODE): Define.
	(ASM_OUTPUT_ADDR_DIFF_ELT): Output word-sized addr_diff_elts when
	necessary for MIPS16_SHORT_JUMP_TABLES.

2011-06-24  Julian Brown  <julian@codesourcery.com>

	Issue #11548

	* release-notes-csl.xml (MIPS16 static data bug fix): Add note.

	Backport from mainline:

	2010-11-14  Richard Sandiford  <rdsandiford@googlemail.com>

	* config/mips/mips.c (machine_function): Remove
	initialized_mips16_gp_pseudo_p.
	(mips16_gp_pseudo_reg): Use cfun->machine->mips16_gp_pseudo_rtx
	to detect whether a pseudo has already been created.
	Unconditionally create a new one if not.
	(mips_pic_base_register): Only call mips16_gp_pseudo_reg when
	expanding to rtl.  Create a new pseudo otherwise, if allowed.

2011-06-22  Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-eabi* | arm*-*-nucleuseabi* |
	arm*-*-symbianelf*): Handle --enable-extra-brewmp-multilibs.
	* config/arm/t-brewmp-eabi: New.

2011-06-22  Meador Inge  <meador_inge@mentor.com>

	Issue #11590

	* release-notes-csl.xml: New note.
	* backport from mainline:

	(There were actually two checkins originally. The latter checkin
	 fixing a typo in the first.  I merged the two.)

	2011-03-15  Ramana Radhakrishnan  <ramana.radhakrishnan@linaro.org>

	PR target/46788

	gcc/
	* config/arm/arm.md (arm_movtas_ze): Use 'L' instead of 'c'
	in the output template.

	gcc/testsuite/
	* gcc.target/arm/pr46788.c: New.

2011-06-16  Catherine Moore  <clm@codesourcery.com>

	Issue #11516

	gcc/
	* config/mips/mips.h (BASE_DRIVER_SELF_SPECS): -m14ke*
	implies -mdspr2.
	* config/mips/mips.c (mips_cpu_info_table): Add m14ke and -m14kec.
	* doc/invoke.texi: Document.

	* release-notes-csl.xml: Document.

2011-06-16  Maciej Rozycki  <macro@codesourcery.com>
	    Julian Brown  <julian@codesourcery.com>

	Issue #10390

	gcc/
	* config/mips/mips.c (mips16_local_function_p): Also reject weak
	and linkonce definitions.

2011-06-14  Maciej Rozycki  <macro@codesourcery.com>
	    Julian Brown  <julian@codesourcery.com>

	Issue #10390

	gcc/
	* config/mips/mips.c (mips16_local_alias): Use
	LOCAL_LABEL_PREFIX for the symbol generated.
	(mips16_build_function_stub): Declare stub once-only if target
	function is likewise.
	(mips16_build_call_stub): Likewise.

2011-06-02  Julian Brown  <julian@codesourcery.com>

	Issue #11371

	* release-notes-csl.xml (Fixed-point bugs in big-endian mode): Add
	note.

	gcc/
	* calls.c (emit_library_call_value_1): Honour BLOCK_REG_PADDING
	and return_in_msb target hook for arguments and return value of
	libcalls.
	* config/arm/arm.c (aapcs_libcall_value): Promote libcall return
	register to SImode for small fixed-point values in big-endian
	mode.
	(arm_return_in_msb): Return fixed-point types in MSB.
	(arm_pad_arg_upwards): Pad half-float type arguments downwards.
	(arm_pad_reg_upwards): Pass fixed-point types in MSB of registers
	(pad upwards).

2011-06-02  Julian Brown  <julian@codesourcery.com>

	Issue #11371

	gcc/
	* config/arm/arm-fixed.md (mulsq3, mulsa3, mulusa3): Use
	gen_highpart instead of simplify_gen_subreg.

2011-05-27  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #11469

	gcc/
	* regcprop.c (early_copyprop_hardreg_forward): Call
	split_all_insns.

2011-05-26  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #11372

	gcc/
	* passes.c (init_optimization_passes): Move the first
	pass_cprop_hardreg before split_after_reload.

	* release-notes-csl.xml: Document.

2011-05-23  Mark Mitchell <mark@codesourcery.com>

	Issue #10390

	gcc/
	* config/mips/mips.c (mips16_build_function_stub): New argument alias.
	(mips16_build_function_stub_and_local_alias): New function.
	(mips_output_function_prologue):  Call
	mips16_build_function_stub_and_local_alias if TARGET_HARD_FLOAT_ABI
	and either a floating-point return value or floating-pointe arguments.

	gcc/testsuite
	* gcc.target/mips/mips.exp 
	* gcc.target/mips/mips16-fn-local.c: New test.

	* release-notes-csl.xml: Document.

2011-05-17  Julian Brown  <julian@codesourcery.com>

	Issue #11348

	gcc/
	* config/arm/arm.md (extv): Fix expansion in extract-register
	case. Add machine modes to pattern.

2011-05-17  Julian Brown  <julian@codesourcery.com>

	Issue #11087

	gcc/
	* config/arm/arm-fixed.md (ssmulha3): Fix insn condition.
	(usmuluha3): Likewise.

2011-05-11  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* cfgrtl.c (try_redirect_by_replacing_jump): Treat EXIT_BLOCK_PTR case
	separately before call to redirect_jump(). Add assertion.
	(patch_jump_insn): Same.

2011-05-06  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #11148

	* release-note-csl.xml: Add note.

	Backport from mainline:

	2010-07-07  Bernd Schmidt  <bernds@codesourcery.com>

	PR rtl-optimization/44787
	gcc/
	* config/arm/arm.md (arith_shiftsi): Allow stack pointer in operand 2.
	* config/arm/thumb2.md (thumb2_arith_shiftsi): Likewise.

	gcc/testsuite/
	* gcc.c-torture/compile/pr44788.c: New test.
	* gcc.target/arm/pr44788.c: New test.

2011-05-03  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* stmt.c (set_jump_prob): Make robust against *inv_scale == 0.

2011-04-25  Paul Woegerer  <paul_woegerer@mentor.com>

	* release-notes-csl.xml: New note.

	gcc/
	* libfuncs.h (enum libfunc_index): Add LTO_profile_call_entry,
	LTI_profile_call_inside, LTI_profile_call_exit.
	(profile_call_entry_libfunc, profile_call_inside_libfunc): Define.
	(profile_call_exit_libfunc): Define.
	* optabs.c (init_optabs): Initialize them.
	* builtins.c (is_inexpensive_builtin): Add BUILT_IN_VA_START.
	* builtins.def (BUILT_IN_PROFILE_CALL_ENTER): Define.
	(BUILT_IN_PROFILE_CALL_INSIDE, BUILT_IN_PROFILE_CALL_EXIT): Define.
	* gimplify.c (fndecl_for_call_instrumentation): New function.
	(maybe_add_profile_call): New function.
	(replace_body_for_instrumentation): New function.
	(gimplify_call_expr): Call maybe_add_profile_call.
	(gimplify_modify_expr): Likewise.
	(gimplify_function_tree): Likewise.
	* common.opt (finstrument-function-calls): New option.
	* doc/invoke.texi: Document it.


2011-04-22  Tom de Vries  <tom@codesourcery.com>

	Issue #10109

	* release-notes-csl.xml: Add 'Interprocedural stack optimization'
	note.

2011-04-22  Tom de Vries  <tom@codesourcery.com>

	Issue #10109

	* release-notes-csl.xml: Add 'Interprocedural register optimization'
	note.

2011-04-22  Zoran Jovanovic  <zoran.jovanovic@rt-rk.com>

	Issue #10109

	gcc/
	* config/mips/mips.opt (mframe-header-opt): New option.
	* config/mips/mips.c (struct mips_frame_info): Add
	skip_stack_frame_allocation_p field.
	(struct machine_function): Add fields callees_use_frame_header_p,
	uses_frame_header_p, initial_total_size.
	(struct frame_header_usage): New struct.
	(frame_header_usage_htab): New variable.
	(mips_rest_of_frame_header_opt, frame_header_usage_htab_hash)
	(frame_header_usage_htab_eq, mips_find_if_frame_header_is_used)
	(mips_callee_use_frame_header, mips_callees_use_frame_header_p)
	(mips_cfun_use_frame_header_p): New function.
	(mips_compute_frame_info): Add parameter recalculate.  Move frame to
	parameter.  Move cprestore_size init up.  Use recalculate.  Use
	mips_must_initialize_gp_p.
	(mips_frame_pointer_required, mips_initial_elimination_offset): Add
	args to call to mips_compute_frame_info.
	(mips_expand_prologue): Use mips_compute_frame_info.  Move frame init
	up.  Set initial_total_size.
	(mips_gp_expand_needed_p): Factor new function out of
	mips_expand_ghost_gp_insns.
	(mips_expand_ghost_gp_insns): Use mips_gp_expand_needed_p.
	(mips_reorg): Use mips_rest_of_frame_header_opt.
	(mips_override_options): Switch off flag_frame_header_optimization if
	flag_exceptions or flag_unwind_tables.
	(mips_get_updated_offset, mips_skip_stack_frame_alloc)
	(mips_frame_header_update_insn): New function.

2011-04-22  Zoran Jovanovic  <zoran.jovanovic@rt-rk.com>

	Issue #10109

	gcc/
	* common.opt (fuse-caller-save): New option.
	* final.c (collect_fn_hard_reg_usage, fn_hard_reg_usage_hash)
	(fn_hard_reg_usage_eq, get_fn_reg_set_usage, get_call_fndecl_rec)
	(get_call_fndecl, get_call_reg_set_usage): New function.
	(compute_alignments): Use collect_fn_hard_reg_usage.
	(struct fn_hard_reg_usage): New struct.
	(fn_hard_reg_usage_htab): New variable.
	* regs.h (get_call_reg_set_usage): Declare.
	* df-scan.c (df_get_call_refs): Use get_call_reg_set_usage.
	* caller-save.c (setup_save_areas, save_call_clobbered_regs): Use
	get_call_reg_set_usage.
	* resource.c (mark_set_resources, mark_target_live_regs): Use
	get_call_reg_set_usage.
	* ira-int.h (struct ira_allocno): Add crossed_calls_clobbered_regs
	field.
	(ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS): Define.
	* ira-lives.c (process_bb_node_lives): Use get_call_reg_set_usage.
	Calculate ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS.
	* ira-build.c (ira_create_allocno): Init
	ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS.
	(create_cap_allocno, propagate_allocno_info)
	(propagate_some_info_from_allocno)
	( copy_info_to_removed_store_destinations): Handle
	ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS.
	* ira-costs.c (ira_tune_allocno_costs_and_cover_classes): Use
	ALLOCNO_CROSSED_CALLS_CLOBBERED_REGS to adjust costs.

2011-04-21  Catherine Moore  <clm@codesourcery.com>

	Issue #10594
 
	* config/mips/mips.opt (mfix-24k): New.
	* config/mips/mips.h (ASM_SPEC): Handle -mfix-24k.
	* config/mips/mips.md (length): Increase by 4 for stores if
	fixing 24K errata.
	* config/mips/mips.c (mips_reorg_process_insns): Do not allow
	all noreorder if fixing 24K errata.
	* doc/invoke.texi: Document mfix-24k.

2011-04-19  Catherine Moore  <clm@codesourcery.com>

	Issue #10598

	* release-note-csl.xml: Add note.

	gcc/
	* config/mips/mips.h (ADJUST_REG_ALLOC_ORDER): Delete.
	* config/mips/mips.c (mips_order_regs_for_local_alloc): Delete.

2011-04-15  Julian Brown  <julian@codesourcery.com>

	Issue #10787

	* release-notes-csl.xml (Fixed-point arithmetic support): Add note.

	gcc/
	* optabs.c (prepare_cmp_insn): Use correct biasing for fixed-point
	comparison helpers.
	* final.c (output_addr_const): Print fixed-point constants as
	decimal not hex (avoiding an assembler overflow warning for
	negative byte constants).
	* tree-ssa-sccvn.c (copy_reference_ops_from_ref): Support FIXED_CST.
	* config/arm/arm.c (arm_fixed_point_supported_p): New.
	(TARGET_FIXED_POINT_SUPPORTED_P): Define target macro using above.
	(arm_fixed_mode_set): New struct.
	(arm_set_fixed_optab_libfunc): New.
	(arm_set_fixed_conv_libfunc): New.
	(arm_init_libfuncs): Initialise fixed-point helper libfuncs with
	ARM-specific names.
	(arm_scalar_mode_supported_p): Support fixed-point modes.
	(arm_vector_mode_supported_p): Support vector fixed-point modes.
	* config/arm/arm-modes.def (FRACT, UFRACT, ACCUM, UACCUM): Declare
	vector modes.
	* predicates.md (sat_shift_operator): New predicate.
	* config/arm/arm-fixed.md: New.
	* config/arm/arm.md: Include arm-fixed.md.
	* config/arm/fixed-bit-machine.h: New.
	* config/fixed-bit.h (fixed-bit-machine.h): Include.
	(DECORATE_FIXED_NAME): Conditionally define if undefined. Use
	throughout file to decorate function names.
	* config/fixed-bit-mach-generic.h: New.
 
	libgcc/
	* config.host (arm*-*-linux*, arm*-*-uclinux*, arm*-*-eabi*)
	(arm*-*-nucleuseabi*, arm*-*-symbianelf*): Add arm/t-fixed-point
	makefile fragment.
	* Makefile.in (FIXED_BIT_MACHINE): New rule. Include
	target-specific or generic fixed_bit_machine_header to decorate the
	names of fixed-point helper functions.
	* config/arm/t-fixed-point: New.
	* fixed-obj.mk ($(o)_s$(objext)): Depend on $(FIXED_BIT_MACHINE).

	gcc/testsuite/
	* gcc.target/arm/fixed-point-exec.c: New test.
	* gcc.dg/fixed-point/func-scalar.c: Include longlong-support.h.
	Avoid long long tests on targets which don't support them.
	* gcc.dg/fixed-point/unary.c: Likewise.
	* gcc.dg/fixed-point/muldiv-warning.c: Likewise.
	* gcc.dg/fixed-point/operator-logical.c: Likewise.
	* gcc.dg/fixed-point/func-array.c: Likewise.
	* gcc.dg/fixed-point/func-struct.c: Likewise.
	* gcc.dg/fixed-point/func-vararg-mixed.c: Likewise.
	* gcc.dg/fixed-point/binary.c: Likewise.
	* gcc.dg/fixed-point/comma.c: Likewise.
	* gcc.dg/fixed-point/func-mixed.c: Likewise.
	* gcc.dg/fixed-point/func-vararg.c: Likewise.
	* gcc.dg/fixed-point/operator-cond.c: Likewise.
	* gcc.dg/fixed-point/loop-index.c: Likewise.
	* gcc.dg/fixed-point/convert.c: Likewise.
	* gcc.dg/fixed-point/allop-const.c: Likewise.
	* gcc.dg/fixed-point/call-by-value.c: Likewise.
	* gcc.dg/fixed-point/longlong-support.h: New.

2011-04-15  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* target.h (gcc_target): Add promote_libcall_mode.
	* target-def.h (TARGET_PROMOTE_LIBCALL_MODE): New.
	* config/arm/arm.c (arm_promote_libcall_mode): New.
	(TARGET_PROMOTE_LIBCALL_MODE): Define target hook.
	(arm_function_value): Promote fixed-point types like integer types.

	Backport from mainline:

	2011-03-04  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>

	PR middle-end/46399
	* calls.c (emit_library_call_value_1): Promote libcall arguments
	using promote_libcall_mode.
	* explow.c (promote_libcall_mode): New function.
	* expr.h (promote_libcall_mode): New prototype.
	* target.def (promote_libcall_mode): New target hook.
	* targhooks.c (default_promote_libcall_mode): New function.
	* targhooks.h (default_promote_libcall_mode): New prototype.
	* config/s390/s390.c (s390_promote_libcall_mode): New function.

2011-04-15  Tom de Vries  <tom@codesourcery.com>

	Revert:
	2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-ssa-loop-ivopts.c (niter_for_exit): Return COND_EXPR if
	!integer_zerop (desc->may_be_zero).
	(cand_valid_pointer_at_use_p, get_lt_bound, iv_elimination_compare_lt):
	New function.
	(may_eliminate_iv): Use iv_elimination_compare_lt.

2011-04-13  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* opts.c (decode_options): Don't set flag_shrink_wrap by default.
	* doc/invoke.texi (-fshrink-wrap): Not enabled by -O anymore.

	* release-notes-csl.xml: Update.

2011-04-13  Julian Brown  <julian@codesourcery.com>

	Issue #10917

	* release-notes-csl.xml (Inline assembly and volatile fields): New
	note.

2011-04-12  Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.target/arm/pr43698.c: Remove -march option.
	* gcc.target/arm/sync-1.c: Limit to sync_int_long, do not use
	-march option.

2011-04-11  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2011-03-23  Chung-Lin Tang  <cltang@codesourcery.com>

	PR target/46934
	gcc/
	* config/arm/arm.md (casesi): Use the gen_int_mode() function
	to subtract lower bound instead of GEN_INT().

	gcc/testsuite/
	* gcc.target/arm/pr46934.c: New.

	2011-03-17  Chung-Lin Tang  <cltang@codesourcery.com>

	PR target/43872
	gcc/
	* config/arm/arm.c (arm_get_frame_offsets): Adjust early
	return condition with !cfun->calls_alloca.

2011-04-11  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #10944

	* release-notes-csl.xml: Document it.

	Backport from mainline, trunk:

	2011-03-11  Jakub Jelinek  <jakub@redhat.com>

	PR c++/48035

	gcc/cp/
	* init.c (build_zero_init_1): Extracted from build_zero_init.
	Add FIELD_SIZE argument, if non-NULL and field bit_position
	as not smaller than that, don't add that field's initializer.
	Pass DECL_SIZE as last argument to build_zero_init_1
	for DECL_FIELD_IS_BASE fields.
	(build_zero_init): Use build_zero_init_1.

	gcc/testsuite/
	* g++.dg/inherit/virtual8.C: New test.

2011-04-11  Julian Brown  <julian@codesourcery.com>

	Issue #10917

	gcc/
	Backport from mainline:

	2011-03-23  Julian Brown  <julian@codesourcery.com>

	* expr.c (expand_expr_real_1): Only use BLKmode for volatile
	accesses which are not naturally aligned.

2011-04-11  Catherine Moore  <clm@codesourcery.com>
	    Chao-Ying Fu <fu@mips.com>

	Issue #10954

	gcc/
	* config/mips/mips.md (*jump_absolute): Use branch for microMIPS.
	(*jump_pic): Likewise.

	* release-note-csl.xml: New note.

2011-04-11  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #9845
	* release-notes-csl.xml (Internal compiler error with pointer casting):
	New note.

	gcc/
	* config/arm/arm.h (ARM_LEGITIMIZE_RELOAD_ADDRESS): Do not handle
	when DImode address has unaligned index under TARGET_NEON.

2011-04-06  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #10935
	PR target/44557

	* release-notes-csl.xml (Internal compiler error under Thumb mode):
	New note.

	gcc/
	* config/arm/arm.h (PREFERRED_RELOAD_CLASS): Add CORE_REGS to
	Thumb-1 return LO_REGS case.
	* config/arm/arm.md (reload_inhi): Change scratch constraint
	from 'r' to 'l'.

	gcc/testsuite/
	* gcc.target/arm/pr44557.c: New.

2011-04-05  Paul Brook  <paul@codesourcery.com>

	* config/arm/t-cs-eabi (MULTILIB_MATCHES): Add -mcpu=cortex-r5.
	* config/arm/t-cs-eabi-lite (MULTILIB_MATCHES): Ditto.
	* config/arm/t-cs-linux-lite (MULTILIB_MATCHES): Ditto.
	* config/arm/t-cs-uclinux-eabi (MULTILIB_MATCHES): Ditto.

2011-04-05  Paul Brook  <paul@cpodesourcery.com>

	gcc/
	* config/arm/arm-cores.def: Add cortex-r5.
	* config/arm/arm-tune.md: Regenerate.
	* config/arm/arm.c (FL_DIV): Rename...
	(FL_THUMB_DIV): ... to this.
	(FL_ARM_DIV): Define.
	(FL_FOR_ARCH7R, FL_FOR_ARCH7M): Use FL_THUMB_DIV.
	(arm_arch_hwdiv): Remove.
	(arm_arch_thumb_hwdiv, arm_arch_arm_hwdiv): New variables.
	(thumb2_size_rtx_costs): Use TARGET_IDIV.
	(arm_issue_rate): Add cortexr5.
	* config/arm/arm.h (TARGET_CPU_CPP_BUILTINS): Set
	__ARM_ARCH_EXT_IDIV__.
	(TARGET_IDIV): Define.
	(arm_arch_hwdiv): Remove.
	(arm_arch_arm_hwdiv, arm_arch_thumb_hwdiv): New prototypes.
	* config/arm/arm.md (tune_cortexr4): Add cortexr5.
	(divsi3, udivsi3): New patterns.
	* config/arm/thumb2.md (divsi3, udivsi3): Remove.
	* doc/invoke.texi: Document ARM -mcpu=cortex-r5

2011-04-05  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10782
	
	gcc/testsuite/
	* gcc.target/mips/loongson-simd.c: Disable micromips too.
	* gcc.target/mips/mips.exp: Add -m[no-]micromips support.

2011-04-04  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config/arm/arm-cores.def (cortex-m0, cortex-m1): Change arch to 6SM.
	* config/arm/arm-t-softfp (softfp_wrap_start): Include ARMv6S-M.
	* config/arm/elf.h: Ditto.
	* config/arm/libunwind.S: Ditto.
	* config/arm/lib1funcs.asm: Ditto.
	(__thumb1_only): Define and use.
	* config/arm/arm.c (FL_FOR_ARCH6SM): Define.
	(all_architectures): Add armv6s-m.

2011-04-01  Julian Brown  <julian@codesourcery.com>

	Issue #4220

	* release-notes-csl.xml (Unaligned access support): New note.

2011-04-01  Julian Brown  <julian@codesourcery.com>

	Issue #4220

	gcc/
	* config/arm/arm.c (arm_block_move_unaligned_straight)
	(arm_adjust_block_mem, arm_block_move_unaligned_loop)
	(arm_movmemqi_unaligned): New.
	(arm_gen_movmemqi): Support unaligned block copies.

2011-04-01  Julian Brown  <julian@codesourcery.com>

	Issue #4220

	gcc/
	* config/arm/arm.c (arm_override_options): Add unaligned_access
	support.
	* config/arm/arm.md (UNSPEC_UNALIGNED_LOAD)
	(UNSPEC_UNALIGNED_STORE): Add constants for unspecs.
	(insv, extzv): Add unaligned-access support.
	(extv): Change to expander. Likewise.
	(unaligned_loadsi, unaligned_loadhis, unaligned_loadhiu)
	(unaligned_storesi, unaligned_storehi): New.
	(*extv_reg): New (previous extv implementation).
	* config/arm/arm.opt (munaligned_access): Add option.
	* expmed.c (store_bit_field_1): Don't tweak bitfield numbering for
	memory locations if BITS_BIG_ENDIAN != BYTES_BIG_ENDIAN.
	(extract_bit_field_1): Likewise.

2011-04-01  Julian Brown  <julian@codesourcery.com>

	Issue #6223

	gcc/
	* config/arm/arm.c (arm_vector_alignment_reachable): Don't use
	peeling for alignment for NEON.

	gcc/testsuite/
	* lib/target-supports.exp
	(check_effective_target_vector_alignment_reachable): Not true for
	ARM NEON.

2011-03-31  Nathan Sidwell  <nathan@codesourcery.com>

	Revert 2011-03-28  Pat Wellander  <pwelland@codesourcery.com>

	Issue #10416

	gcc/
	* tree-vrp.c (extract_range_from_binary_expr): Handle case for unsigned
	overflow (underflow), using anti-range to indicate new range.

	gcc/testsuite/
	* g++.dg/other/enumrange.C: Remove.

	* release-notes-csl.xml (Incorrect Handling of case 0 in switch fixed):
        New note.

2011-03-29  Nathan Sidwell  <nathan@codesourcery.com>

	libgcc/
	* config.host (powerpc-*-elf): Add t-ppccomm & t-spe-fprules, if
	necessary.

2011-03-28  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips.c (mips_print_operand_punctuation) <!>: Fix
	formatting.

2011-03-28  Pat Wellander  <pwelland@codesourcery.com>

	Issue #10416

	gcc/
	* tree-vrp.c (extract_range_from_binary_expr): Handle case for unsigned
	overflow (underflow), using anti-range to indicate new range.

	* release-notes-csl.xml (Incorrect Handling of case 0 in switch fixed):
        New note.

2011-03-28  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips16.S (DELAYf): Alias to DELAYt for the MIPS IV
	ISA and up.

2011-03-28  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips.h (ISA_HAS_FP4): Don't restrict ISA_MIPS32R2
	to TARGET_FLOAT64.
	(ISA_HAS_NMADD4_NMSUB4): Remove the MODE argument; don't restrict
	ISA_MIPS32R2.
	(ISA_HAS_NMADD3_NMSUB3): Remove the MODE argument.
	* config/mips/mips.c (mips_rtx_costs): Update according to
	changes to ISA_HAS_NMADD4_NMSUB4 and ISA_HAS_NMADD3_NMSUB3.
	* config/mips/mips.md (nmadd4<mode>, nmadd3<mode>): Likewise.
	(nmadd4<mode>_fastmath, nmadd3<mode>_fastmath): Likewise.
	(nmsub4<mode>, nmsub3<mode>): Likewise.
	(nmsub4<mode>_fastmath, nmsub3<mode>_fastmath): Likewise.
	* doc/invoke.texi (MIPS Options): Update documentation of the
	floating-point multiply-accumulate instruction restrictions.

	* release-notes-csl.xml
	(MIPS32r2 floating-point multiply-accumulate restrictions lifted):
	New.

2011-03-28  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* function.c (bb_active_p): New function.
	(thread_prologue_and_epilogue_insns): Use it.  Recompute
	last_bb_active after calling prepare_shrink_wrap.

	gcc/
	* ifcvt.c (cond_exec_process_insns): Don't convert the function
	prologue.

	gcc/testsuite/
	* gcc.c-torture/compile/20110322-1.c: New test.

2011-03-28  Paul Brook  <paul@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
 
	Issue #3772
	gcc/
	* final.c (notice_source_line): Ignore zero length instructions.

2011-03-28  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10861

	gcc/
	* config/rs6000/e500mc.h (SETUP_FRAME_ADDRESSES): Remove, in line
	with merged fix for upstream PR target/45807.

2011-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #10166

	* release-notes-csl.xml: Add a release note.

	gcc/
	* config/mips/linux64.h (LINK_SPEC): Use compatible linker emulation
	for -mabi=64 -msym32.

	gcc/testsuite/
	* gcc.target/mips/mips-nonpic/main-msym32-mplt-1.c: New test.

2011-03-22  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #9669

	* release-notes-csl.xml (Incorrect C++ warning fixed): New note.

	Backport from FSF 4.5:

	gcc/testsuite/
	2011-03-01  Jason Merrill  <jason@redhat.com>

	* g++.dg/cpp0x/lambda/lambda-98.C: New.

	gcc/cp/
	2011-03-01  Jason Merrill  <jason@redhat.com>

	PR c++/46159
	* parser.c (cp_parser_primary_expression): Don't warn about a
	failed tentative parse.

2011-03-22  Joseph Myers  <joseph@codesourcery.com>

	* release-notes-csl.xml (Compiler optimization improvements): Only
	mention branch delay slots on relevant targets.

2011-03-22  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #10483

	* release-notes-csl.xml (Incorrect code for built-in comparison
	functions): New note.

	gcc/
	Backport from mainline:

	2011-03-22  Eric Botcazou  <ebotcazou@adacore.com>

        * combine.c (simplify_set): Try harder to find the best CC mode when
        simplifying a nested COMPARE on the RHS.

2011-03-22  Janis Johnson  <janisjo@codesourcery.com>

	* release-notes-csl.xml: Fix typo in arm-specific entry.

2011-03-21  Janis Johnson  <janisjo@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/pr44606.c: Include <stdio.h> instead of defining or
	declaring symbols explicitly, as in FSF mainline test.

	gcc/testsuite/
	* g++.dg/abi/packed1.C: Move dg-options after dg-do, and add arm*-*-*
	to the list of targets for dg-warning.
	* g++.dg/other/packed1.C: Remove arm-*-* from xfail list for execute.
	declaring symbols explicitly.
	* gcc.dg/tree-ssa/20030204-1.c: Add arm*-*-* to targets expected
	not to fail scan.
	* gcc.dg/vect/vect-16.c: Do not expect arm*-*-* to fail scan.

2011-03-19  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #10807
	gcc/
	* dwarf2out.c (dwarf2out_frame_debug): Fix merge error.

2011-03-18  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10762
	gcc/
	* cs-sgxxlite-linux.h (SUBTARGET_CC1_SPEC): Override.
	* cs-sgxx-linux.h (SUBTARGET_CC1_SPEC): Likewise.

2011-03-18  Joseph Myers  <joseph@codesourcery.com>

	Merge from GCC 4.5.2.
	* release-notes-csl.xml: Update.

2011-03-17  Janis Johnson  <janisjo@codesourcery.com>

	Backport from FSF mainline:
	2011-01-25  Jakub Jelinek  <jakub@redhat.com>

	PR tree-optimization/47427
	PR tree-optimization/47428
	* tree-ssa-copyrename.c (copy_rename_partition_coalesce): Don't
	coalesce if the new root var would be TREE_READONLY.

2011-03-14  Julian Brown  <julian@codesourcery.com>

	Issue #10420

	* release-notes-csl.xml (Compiler optimization improvements): Add
	Cortex-M bullet point.

2011-03-11  Andrew Stubbs  <ams@codesourcery.com>
	    Michael Hope  <michael.hope@linaro.org>
	    Matthias Klose  <doko@ubuntu.org>

	gcc/
	* function. (thread_prologue_and_epilogue_insns): Initialize
	prologue_seq.
	* opts.c (decode_options): Move flag_shrink_wrap to -O1.

2011-03-09  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #10649
	gcc/
	* dwarf2out.c (dwarf2out_begin_epilogue): Accept simplejumps
	as well as returnjumps.
	* cfganal.c (set_edge_can_fallthru_flag): Revert previous change
	that tried to keep epilogue blocks adjacent.

2011-03-02  Julian Brown  <julian@codesourcery.com>

	Issue #10420

	gcc/
	* config/arm/arm-cores.def (cortex-a5): Use Cortex-A5-specific
	tuning.
	* config/arm/arm-protos.h (tune_params): Add branch_cost field.
	* config/arm/arm.c (arm_default_branch_cost)
	(arm_cortex_a5_branch_cost, arm_cortex_m_branch_cost): New.
	(arm_slowmul_tune, arm_fastmul_tune, arm_xscale_tune, arm_9e_tune)
	(arm_v6t2_tune, arm_cortex_tune, arm_cortex_a9_tune)
	(arm_cortex_m_tune): Add branch_cost setting.
	(arm_cortex_a5_tune): New.
	* config/arm/arm.h (BRANCH_COST): Use branch_cost from current
	tuning.
	* dojump.c (tm_p.h): Include.

2011-03-02  Julian Brown  <julian@codesourcery.com>

	Issue #10420

	gcc/
	* config/arm/arm-cores.def (arm1156t2-s, arm1156t2f-s): Use v6t2
	tuning.
	(cortex-a5): Use Cortex-A5 tuning.
	(cortex-a8, cortex-r4, cortex-r4f): Use Cortex tuning.
	(cortex-m4, cortex-m3, cortex-m1, cortex-m0): Use Cortex-M tuning.
	* config/arm/arm-protos.h (tune_params): Add prefer_constant_pool
	field.
	* config/arm/arm.c (arm_slowmul_tune, arm_fastmul_tune)
	(arm_xscale_tune, arm_9e_tune, arm_cortex_a9_tune): Add
	prefer_constant_pool setting.
	(arm_v6t2_tune, arm_cortex_tune, arm_cortex_m_tune): New.
	* config/arm/arm.h (TARGET_USE_MOVT): Make dependent on
	prefer_constant_pool setting.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-ssa-loop-ivopts.c (niter_for_exit): Return COND_EXPR if
	!integer_zerop (desc->may_be_zero).
	(cand_valid_pointer_at_use_p, get_lt_bound, iv_elimination_compare_lt):
	New function.
	(may_eliminate_iv): Use iv_elimination_compare_lt.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-ssa-loop-ivopts.c (fold_build_plus): New function factored out of
	add_autoinc_candidates.
	(add_autoinc_candidates): Use fold_build_plus.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-ssa-loop-ivopts.c (struct cost_pair): Add comp field.
	(set_use_iv_cost): Add comp parameter.
	(set_use_iv_cost): Use comp parameter to init comp field.
	(determine_use_iv_cost_generic, determine_use_iv_cost_address)
	(determine_use_iv_cost_condition): Add comp argument to set_use_iv_cost
	call.
	(may_eliminate_iv): Add comp parameter and set.
	(determine_use_iv_cost_condition): Add comp argument to may_eliminate_iv
	call.
	(determine_use_iv_cost_condition): Reset comp if too expensive.
	(rewrite_use_compare): Use compare from comp field of cp.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-ssa-loop-ivopts.c (may_eliminate_iv): Fix boundary checks.
	* testsuite/gcc.dg/tree-ssa/ivopts-max.c: New test.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	Backport from mainline:

	2010-07-27  Xinliang David Li  <davidxl@google.com>
	gcc/
	* tree-ssa-loop-ivopts.c (niter_for_exit): New parameter.
	(niter_for_single_dom_exit): Passes additional parameter.
	(iv_period): Fix comments.
	(may_eliminate_iv): Handles multiple exit loops properly.
	(free_tree_niter_desc): New function.
	(free_loop_data): Frees up loop iteration descriptors.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (promoted_subreg): New global variable.
	(register_promoted_subreg, note_promoted_subreg): New function.
	(note_use): Use note_promoted_subreg.
	(reset_promoted_subreg): New function.
	(try_remove_or_replace_extension): Use reset_promoted_subreg.
	(remove_redundant_extensions): Alloc and free promoted_subreg.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (promoted_subreg_p, fixed_promoted_subreg_p): New function.
	(reg_use_p): Use fixed_promoted_subreg_p.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (implicit_use_p): Fix unused parameter warning.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (note_restricted_op_use): Remove dead code.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (paradoxical_subreg_p): Fix header comment whitespace.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (remove_redundant_extensions): Replace free by XDELETEVEC.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* passes.c (init_optimization_passes): Move pass_ee to after combine.
	* loop-iv.c (get_biv_step): Remove workaround loop analysis ICE.
	* testsuite/gcc.dg/extend-2-64.c testsuite/gcc.dg/extend-3.c: Adapt
	test.
	* testsuite/gcc.dg/extend-4.c: Adapt and disable test.
	* testsuite/gcc.target/mips/octeon-bbit-2.c: Make test more robust.

2011-02-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* ee.c (extension_p): Recognize extensions with TRUNCATE.

2011-02-23  Jie Zhang  <jie@codesourcery.com>

	Issue #10134

	Backport from mainline

	gcc/
	2011-02-23  Jie Zhang  <jie@codesourcery.com>

	PR rtl-optimization/47763
	* web.c (web_main): Ignore naked clobber when replacing register.

	gcc/testsuite/
	2011-02-23  Jie Zhang  <jie@codesourcery.com>

	PR rtl-optimization/47763
	* gcc.dg/pr47763.c: New test.

2011-02-17  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* tree-pass.h (pass_cprop_hardreg2): Declare.
	* passes.c (init_optimization_passes): Move first cprop pass before
	thread_prologue_and_epilogue_insns, add the second in the original
	place of the first.
	* regcprop.c: Include "dce.h".
	(gate_handle_cprop): Allow only if HAVE_simple_return.
	(gate_handle_cprop2): New function.
	(early_cprop_hardregs_forward): New function.
	(pass_cprop_hardreg2): New.
	* function.c (prepare_shrink_wrap): Also stop search when we see
	another set of the destination reg.
	* Makefile.in (regcprop.o): Update dependencies.

2011-02-16  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10439
	gcc/
	* config/arm/unwind-arm.c (enum __cxa_type_match_result): New.
	(cxa_type_match): Correct declaration.
	(__gnu_unwind_pr_common): Reconstruct
	additional indirection when __cxa_type_match returns
	succeeded_with_ptr_to_base.

	libstdc++/
	* libsupc++/eh_arm.c (__cxa_type_match): Construct address of
	thrown object here.  Return succeded_with_ptr_to_base for all
	pointer cases.

	* release-notes-csl.xml: Document.

2011-02-15  Julian Brown  <julian@codesourcery.com>

	Issue #10448

	gcc/
	* expr.c (expand_expr_real_1): Expand wide integer-zero constants
	to constant-zero RTX.

	Revert:
	2011-02-09  Julian Brown  <julian@codesourcery.com>

	Issue #10448

	gcc/
	* tree-sra.c (usable_access_p): New.
	(find_access_in_subtree, get_var_base_offset_size_access): Use
	above.

2011-02-15  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10413
	gcc/
	* config/rs6000/rs6000.h (EXTRA_SPECS): Add cc1_float.
	(host_detect_local_float): Declare.
	(EXTRA_SPEC_FUNCTIONS): Add local_float_detect.
	(HAVE_LOCAL_FLOAT_DETECT): Define as necessary.
	(CC1_FLOAT_SPEC): Define.
	* config/rs6000/driver-rs6000.c: #include asm/cputable.h.
	(platform, hard_float, auxv_read): New static vars.
	(elf_auxv): New.  Cache auxv values.
	(elf_platform): Use elf_auxv.
	(elf_float): New.
	(host_detect_local_float): New.
	* config/rs6000/sysv4.h (CC1_SPEC): Add cc1_float.

2011-02-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/mips.c (mips_align_insns): Re-enable label in delay slot.

2011-02-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* reorg.c (fill_slots_from_thread): Add update_block call for
	duplicate.
	* reorg.c (fill_slots_from_thread): Add update_label_uses calls around
	delete_related_insns call.
	* reorg.c (fill_slots_from_thread): Replace delete_related_insns (label)
	with remove_insn and setting of INSN_DELETED_P.
	* reorg.c (fill_slots_from_thread): Use duplicate rather than trial in
	delay slot.
	* reorg.c (fill_slots_from_thread): Remove ineffective copy of label.

2011-02-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* reorg.c (update_label_uses): Handle case that JUMP_LABEL (insn) is not
	a label.

2011-02-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* reorg.c (update_label_uses): New function.

2011-02-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* reorg.c (redundant_insn): Add missing incr_ticks_for_insn.

2011-02-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* resource.c (struct target_info): Add label field.
	* resource.c (find_basic_block): New parameter label.
	* resource.c (find_basic_block): Set label.
	* resource.c (get_block): New function.
	* resource.c (mark_target_live_regs): Use get_block.
	* resource.c (mark_target_live_regs, clear_hashed_info_for_insn): Pass
	extra argument to find_basic_block.
	* resource.c (mark_target_live_regs): Set label field.

2011-02-14  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #10417

	Backport from mainline
	
	* release-notes-csl.xml (GCC bug where accesses to volatile structure
	fields are optimized away): Add note.
	
	gcc/
	2010-07-31  Richard Guenther  <rguenther@suse.de>
 
	PR tree-optimization/45052
	* ipa-pure-const.c (check_stmt): Check volatileness.

2011-02-11  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10413
	gcc/
	* config/rs6000/apm-linux.h (DRIVER_SELF_SPECS): Remove.
	* config/rs6000/rs6000.c (rs6000_override_options,
	rs6000_file_start): Ignore "native" default cpu.
	* config/rs6000/driver-rs6000.c (elf_platform): Strip leading
	'ppc' from cpu name.

2011-02-10  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/testsuite/
	* gcc.target/mips/call-1.c: Accept JALRS too where JALR would do.
	* gcc.target/mips/call-2.c: Likewise.
	* gcc.target/mips/call-3.c: Likewise.
	* gcc.target/mips/lazy-binding-1.c: Likewise.

2011-02-10  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips.c (mips_print_operand_punctuation)
	<'!'>: Ensure the other argument to SET is a register.

2011-02-10  Jie Zhang  <jie@codesourcery.com>

	Revert
	2011-02-06  Jie Zhang  <jie@codesourcery.com>

	Issue #10134

	Backport from mainline

	gcc/
	2011-02-05  Jie Zhang  <jie@codesourcery.com>

	PR debug/42631
	* web.c (entry_register): Don't clobber the number of the
	first uninitialized reference in used[].

	gcc/testsuite/
	2011-02-05  Jie Zhang  <jie@codesourcery.com>

	PR debug/42631
	* gcc.dg/pr42631.c: Update test.
	* gcc.dg/pr42631-2.c: New test.

2011-02-09  Julian Brown  <julian@codesourcery.com>

	Issue #10448

	* release-notes-csl.xml (Internal compiler error with NEON
	intrinsics): Add note.

	gcc/
	* tree-sra.c (usable_access_p): New.
	(find_access_in_subtree, get_var_base_offset_size_access): Use
	above.

2011-02-06  Jie Zhang  <jie@codesourcery.com>

	Issue #10134

	Backport from mainline

	gcc/
	2011-02-05  Jie Zhang  <jie@codesourcery.com>

	PR debug/42631
	* web.c (entry_register): Don't clobber the number of the
	first uninitialized reference in used[].

	gcc/testsuite/
	2011-02-05  Jie Zhang  <jie@codesourcery.com>

	PR debug/42631
	* gcc.dg/pr42631.c: Update test.
	* gcc.dg/pr42631-2.c: New test.

2010-02-04  Tom de Vries  <tom@codesourcery.com>

	gcc/
	stmt.c (set_jump_prob): Fix assert condition.

2011-02-03  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* function.c (prepare_shrink_wrap): New function.
	(thread_prologue_and_epilogue_insns): Call it.

2011-02-03  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #10287

	* release-notes-csl.xml: Document it.

	Backport from mainline, gcc-4_5-branch:

	PR middle-end/45704

	2010-09-21  Richard Guenther  <rguenther@suse.de>
	gcc/
	* gimplify.c (gimplify_modify_expr_rhs): Preserve volatileness.

	gcc/testsuite/
	* gcc.dg/torture/pr45704.c: New testcase.

2011-02-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10377
	
	gcc/
	* config/sh/sh.c (expand_cbranchdi4): Preserve copied op2h for
	reuse.

	testsuite/
	* gcc.target/sh/crash-1.c: New.

	* release-notes-csl.xml: Document.

2011-02-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10459
	gcc/
	* config.gcc (powerpc-*): Allow native for with-cpu.

	* config/rs6000/apm-linux.h (DRIVER_SELF_SPECS): Set for native builds.

2011-02-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10472
	gcc/
	* config/arm/arm.c (arm_cannot_copy_insn_p): Check for tlscall.

	testsuite/
	* gcc.target/arm/tlscall.c: New.

	* release-notes-csl.xml: Document.

2011-01-31  Maciej W. Rozycki  <macro@codesourcery.com>

	* release-notes-csl.xml
	(GCC microMIPS code size optimization bug fix): Rename to...
	(GCC microMIPS code size improvement): ... this.  Rephrase.

2011-01-30  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/linux.h (SUBTARGET_CC1_SPEC): Remove -mno-jals.
	(SUBTARGET_OVERRIDE_OPTIONS): Remove code to enable
	-minterlink-mips16.
	* config/mips/mips.c (TARGET_INTERLINK_MIPS16): Remove explicit
	checks against 1.
	* config/mips/mips.opt (minterlink-mips16): Initialize to 0.

2011-01-30  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips.h (MIPS_CALL): Allow microMIPS JALS in direct
	calls if TARGET_JALS.  Always allow microMIPS JALRS in indirect
	calls.  Always use microMIPS JAL in non-explicit-relocs calls.

	* release-notes-csl.xml
	(GCC microMIPS code size optimization bug fix): New.

2011-01-27  Pat Wellander  <pwelland@codesourcery.com>

        Issue #9850
	gcc/
        * config/rs6000/rs6000.h (LOCAL_ALIGNMENT):
        Altivec local arrays >= 16 bytes are now
        aligned to at least 16 bytes.

2011-01-27  Julian Brown  <julian@codesourcery.com>

	Issue #10061

	* release-notes-csl.xml (Fixes for NEON in big-endian mode): Add
	note.

	gcc/
	* config/arm/neon.md (vec_shr_<mode>, vec_shl_<mode>): Disable in
	big-endian mode.
	(reduc_splus_<mode>, reduc_uplus_<mode>, reduc_smin_<mode>)
	(reduc_smax_<mode>, reduc_umin_<mode>, reduc_umax_<mode>)
	(neon_vec_unpack<US>_lo_<mode>, neon_vec_unpack<US>_hi_<mode>)
	(vec_unpack<US>_hi_<mode>, vec_unpack<US>_lo_<mode>)
	(neon_vec_<US>mult_lo_<mode>, vec_widen_<US>mult_lo_<mode>)
	(neon_vec_<US>mult_hi_<mode>, vec_widen_<US>mult_hi_<mode>)
	(vec_pack_trunc_<mode>, neon_vec_pack_trunc_<mode>): Disable for Q
	registers in big-endian mode.

	gcc/testsuite/
	* lib/target-supports.exp
	(check_effective_target_arm_little_endian): New.
	(check_effective_target_vect_pack_trunc): Use above.
	(check_effective_target_vect_unpack): Likewise.
	(check_effective_target_vect_element_align): Test
	check_effective_target_arm_vect_no_misalign for ARM.

2010-01-27  Tom de Vries  <tom@codesourcery.com>

	gcc/
	stmt.c (rtx_seq_cost): Use insn_rtx_cost instead of rtx_cost.

2011-01-27  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10339

	gcc/
	* config/sparc/sparc.c (sparc_struct_value_rtx): Rename ret_rtx to
	ret_reg to avoid collision with new macro.

2010-01-26  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* reorg.c (relax_delay_slots): Handle case that JUMP_LABEL (label) is
	not a label.

2010-01-26  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* stmt.c (struct  case_bit_test): Add rev_hi and rev_lo field.
	* stmt.c (emit_case_bit_test_jump): New function.
	* stmt.c (rtx_seq_cost): New function.
	* stmt.c (choose_case_bit_test_expand_method): New function.
	* stmt.c (set_bit): New function.
	* stmt.c (emit_case_bit_test): Adjust comment.
	* stmt.c (emit_case_bit_test): Set and update rev_hi and rev_lo fields.
	* stmt.c (emit_case_bit_test): Use set_bit.
	* stmt.c (emit_case_bit_test): Use choose_case_bit_test_expand_method.
	* stmt.c (emit_case_bit_test): Use emit_case_bit_test_jump.
	* testsuite/gcc.dg/switch-bittest.c: New test.

2010-01-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* stmt.c (emit_case_bit_tests): Change prototype.
	* stmt.c (struct case_bit_test): Add prob field.
	* stmt.c (get_label_prob): New function.
	* stmt.c (set_jump_prob): New function.
	* stmt.c (emit_case_bit_tests): Use get_label_prob.
	* stmt.c (emit_case_bit_tests): Set prob field.
	* stmt.c (emit_case_bit_tests): Use set_jump_prob.
	* stmt.c (expand_case): Add new args to emit_case_bit_tests invocation.
	* testsuite/gcc.dg/switch-prob.c: Add test.

2010-01-25  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/mips.md (define_peephole2): Add 2 new peepholes.
	* testsuite/gcc.target/mips/switch-peephole2.c: Add test.

2011-01-24  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10402

	gcc/
	* config/rs6000/t-apm-linux (MULTILIB_MATCHES): Add
	MULTILIB_MATCHES_FLOAT.

	* release-notes-csl.xml: Document.

2011-01-19  Catherine Moore  <clm@codesourcery.com>

	Issue #10367

	Backport from mainline:

	gcc/
	2010-11-04  Chao-ying Fu  <fu@mips.com>
	* configure.ac: Test assembler support for DSP Rev1 mult.
	* configure: Regenerate.
	* config.in: Regenerate.
	* config/mips/mips.h (ISA_HAS_DSP_MULT): New define.
	* config/mips/mips.c (CODE_FOR_mips_mult): New define.
	(CODE_FOR_mips_multu): New define.
	(mips_builtins): Move madd, maddu, msub, msubu, mult, multu from
	dspr2_32 to dsp_32.
	(mips_mulsidi3_gen_fn): Test (TARGET_FIX_R4000 && !ISA_HAS_DSP).
	Delete returns when ISA_HAS_DSPR2 because the old patterns are deleted.
	* config/mips/mips-dsp.md (mips_madd<u>, mips_msub<u>):
	New define_expand patterns.
	* config/mips/constraints.md (ka): Update the constraint to test
	ISA_HAS_DSP_MULT instead of ISA_HAS_DSPR2.
	* config/mips/mips-dspr2.md (mips_madd<u>, mips_msub<u>, mips_mult,
	mips_multu): Delete.
	* config/mips/mips.md (<u>mulsidi3_32bit): Add comments.
	Change target constraint to "ka".
	Use (!TARGET_FIX_R4000 || ISA_HAS_DSP), instead of
	(!TARGET_FIX_R4000 && !ISA_HAS_DSPR2).
	Emit the accumulator destination when ISA_HAS_DSP_MULT.
	(<u>msubsidi4): Add comments.  Test ISA_HAS_DSP.
	Emit the accumulator destination when ISA_HAS_DSP_MULT.
	(<u>maddsidi4): Likewise.
	* doc/extend.texi (MIPS DSP Built-in Functions): Move madd, maddu,
	msub, msubu, mult, multu built-in functions from DSP r2 to DSP r1.

2011-01-14  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* function.c (thread_prologue_and_epilogue_insns): Avoid uninitialized
	variable.

2010-12-13  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* tree-if-switch-conversion.c: New pass.
	* tree-pass.h (pass_if_to_switch): Declare.
	* common.opt (ftree-if-to-switch-conversion): New switch.
	* opts.c (decode_options): Set flag_tree_if_to_switch_conversion at -O2
	and higher.
	* passes.c (init_optimization_passes): Use new pass.
	* params.def (PARAM_IF_TO_SWITCH_THRESHOLD): New param.
	* doc/invoke.texi (-ftree-if-to-switch-conversion)
	(if-to-switch-threshold): New item.
	* doc/invoke.texi (Optimization Options, option -O2): Add
	-ftree-if-to-switch-conversion.
	* Makefile.in (OBJS-common): Add tree-if-switch-conversion.o.
	* Makefile.in (tree-if-switch-conversion.o): New rule.

2011-01-12  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* config/s390/s390.c (s390_emit_epilogue): Don't use gen_rtx_RETURN.
	* config/rx/rx.c (gen_rx_rtsd_vector): Likewise.
	* config/m68hc11/m68hc11.md (return): Likewise.
	* config/cris/cris.c (cris_expand_return): Likewise.
	* config/m68k/m68k.c (m68k_expand_epilogue): Likewise.
	* config/picochip/picochip.c (picochip_expand_epilogue): Likewise.
	* config/h8300/h8300.c (h8300_push_pop, h8300_expand_epilogue):
	Likewise.
	* config/v850/v850.c (expand_epilogue): Likewise.
	* config/bfin/bfin.c (bfin_expand_call): Likewise.

2011-01-12  Tom de Vries  <tom@codesourcery.com

	Issue #10308

	gcc/
	* config/mips/mips.c (mips_align_insns): Disable label in delay slot.

2011-01-12  Tom de Vries  <tom@codesourcery.com

	gcc/
	* reorg.c (fill_slots_from_thread): Fix handling of
	targetm.target_align.align_insns == 0.

2011-01-05  Andrew Stubbs  <ams@codesourcery.com>

	* release-notes-csl.xml (Compiler optimization improvements): Mention
	ARM multiply and accumulate improvements.

2011-01-05  Nathan Sidwell  <nathan@codesourcery.com>

	gcc/
	* config/rs6000/apm-linux.h (SYSROOT_SUFFIX_SPEC): Remove traces
	of little endian, rename soft float directory.
	* config/rs6000/t-apm-linux: Likewise.

2011-01-04  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/rs6000/rs6000.c (rs6000_make_savres_rtx): Change
	gen_rtx_RETURN to ret_rtx.
	(rs6000_emit_epilogue): Likewise.
	(rs6000_output_mi_thunk): Likewise.

2011-01-03  Bernd Schmidt  <bernds@codesourcery.com>

	* release-notes.xml (Compiler optimization improvements): Add a
	note about shrink wrapping.

	gcc/
	* doc/tm.texi (RETURN_ADDR_REGNUM): Document.
	* doc/md.texi (simple_return): Document pattern.
	(return): Add a sentence to clarify.
	* doc/rtl.texi (simple_return): Document.
	* doc/invoke.texi (Optimize Options): Document -fshrink-wrap.
	* common.opt (fshrink-wrap): New.
	* opts.c (decode_options): Set it for -O2 and above.
	* gengenrtl.c (special_rtx): PC, CC0, RETURN and SIMPLE_RETURN
	are special.
	* rtl.h (ANY_RETURN_P): New macro.
	(global_rtl_index): Add GR_RETURN and GR_SIMPLE_RETURN.
	(ret_rtx, simple_return_rtx): New macros.
	* genemit.c (gen_exp): RETURN and SIMPLE_RETURN have unique rtxs.
	(gen_expand, gen_split): Use ANY_RETURN_P.
	* rtl.c (copy_rtx): RETURN and SIMPLE_RETURN are shared.
	* emit-rtl.c (verify_rtx_sharing): Likewise.
	(skip_consecutive_labels): Return the argument if it is a return rtx.
	(classify_insn): Handle both kinds of return.
	(init_emit_regs): Create global rtl for ret_rtx and simple_return_rtx.
	* df-scan.c (df_uses_record): Handle SIMPLE_RETURN.
	* rtl.def (SIMPLE_RETURN): New.
	* rtlanal.c (tablejump_p): Check JUMP_LABEL for returns.
	* final.c (final_scan_insn): Recognize both kinds of return.
	* reorg.c (function_return_label, function_simple_return_label): New
	static variables.
	(end_of_function_label): Remove.
	(simplejump_or_return_p): New static function.
	(find_end_label): Add a new arg, KIND.  All callers changed.
	Depending on KIND, look for a label suitable for return or
	simple_return.
	(make_return_insns): Make corresponding changes.
	(get_jump_flags): Check JUMP_LABELs for returns.
	(follow_jumps): Likewise.
	(get_branch_condition): Check target for return patterns rather
	than NULL.
	(own_thread_p): Likewise for thread.
	(steal_delay_list_from_target): Check JUMP_LABELs for returns.
	Use simplejump_or_return_p.
	(fill_simple_delay_slots): Likewise.
	(optimize_skip): Likewise.
	(fill_slots_from_thread): Likewise.
	(relax_delay_slots): Likewise.
	(dbr_schedule): Adjust handling of end_of_function_label for the
	two new variables.
	* ifcvt.c (find_if_case_1): Take care when redirecting jumps to the
	exit block.
	(dead_or_predicable): Change NEW_DEST arg to DEST_EDGE.  All callers
	changed.  Ensure that the right label is passed to redirect_jump.
	* jump.c (condjump_p, condjump_in_parallel_p, any_condjump_p,
	returnjump_p): Handle SIMPLE_RETURNs.
	(delete_related_insns): Check JUMP_LABEL for returns.
	(redirect_target): New static function.
	(redirect_exp_1): Use it.  Handle any kind of return rtx as a label
	rather than interpreting NULL as a return.
	(redirect_jump_1): Assert that nlabel is not NULL.
	(redirect_jump): Likewise.
	(redirect_jump_2): Handle any kind of return rtx as a label rather
	than interpreting NULL as a return.
	* dwarf2out.c (compute_barrier_args_size_1): Check JUMP_LABEL for
	returns.
	* function.c (emit_return_into_block): Remove useless declaration.
	(record_hard_reg_sets, frame_required_for_rtx, gen_return_pattern,
	requires_stack_frame_p): New static functions.
	(emit_return_into_block): New arg SIMPLE_P.  All callers changed.
	Generate either kind of return pattern and update the JUMP_LABEL.
	(thread_prologue_and_epilogue_insns): Implement a form of
	shrink-wrapping.  Ensure JUMP_LABELs for return insns are set.
	* print-rtl.c (print_rtx): Handle returns in JUMP_LABELs.
	* cfglayout.c (fixup_reorder_chain): Ensure JUMP_LABELs for returns
	remain correct.
	* resource.c (find_dead_or_set_registers): Check JUMP_LABELs for
	returns.
	(mark_target_live_regs): Don't pass a return rtx to next_active_insn.
	* basic-block.h (force_nonfallthru_and_redirect): Declare.
	* sched-vis.c (print_pattern): Add case for SIMPLE_RETURN.
	* cfgrtl.c (force_nonfallthru_and_redirect): No longer static.  New arg
	JUMP_LABEL.  All callers changed.  Use the label when generating
	return insns.

	* config/i386/i386.md (returns, return_str, return_cond): New
	code_iterator and corresponding code_attrs.
	(<return_str>return): Renamed from return and adapted.
	(<return_str>return_internal): Likewise for return_internal.
	(<return_str>return_internal_long): Likewise for return_internal_long.
	(<return_str>return_pop_internal): Likewise for return_pop_internal.
	(<return_str>return_indirect_internal): Likewise for
	return_indirect_internal.
	* config/i386/i386.c (ix86_expand_epilogue): Expand a simple_return as
	the last insn.
	(ix86_pad_returns): Handle both kinds of return rtx.
	* config/arm/arm.c (use_simple_return_p): new function.
	(is_jump_table): Handle returns in JUMP_LABELs.
	(output_return_instruction): New arg SIMPLE.  All callers changed.
	Use it to determine which kind of return to generate.
	(arm_final_prescan_insn): Handle both kinds of return.
	* config/arm/arm.md (returns, return_str, return_simple_p,
	return_cond): New code_iterator and corresponding code_attrs.
	(<return_str>return): Renamed from return and adapted.
	(arm_<return_str>return): Renamed from arm_return and adapted.
	(cond_<return_str>return): Renamed from cond_return and adapted.
	(cond_<return_str>return_inverted): Renamed from cond_return_inverted
	and adapted.
	(epilogue): Use ret_rtx instead of gen_rtx_RETURN.
	* config/arm/thumb2.md (thumb2_<return_str>return): Renamed from
	thumb2_return and adapted.
	* config/arm/arm.h (RETURN_ADDR_REGNUM): Define.
	* config/arm/arm-protos.h (use_simple_return_p): Declare.
	(output_return_instruction): Adjust declaration.
	* config/mips/mips.c (mips_expand_epilogue): Generate a simple_return
	as final insn.
	* config/mips/mips.md (simple_return): New expander.
	(*simple_return, simple_return_internal): New patterns.
	* config/sh/sh.c (barrier_align): Handle return in a JUMP_LABEL.
	(split_branches): Don't pass a null label to redirect_jump.

	From mainline:
	* vec.h (FOR_EACH_VEC_ELT, FOR_EACH_VEC_ELT_REVERSE): New macros.
	* haifa-sched.c (find_fallthru_edge_from): Rename from
	find_fallthru_edge.  All callers changed.
	* sched-int.h (find_fallthru_edge_from): Rename declaration as well.
	* basic-block.h (find_fallthru_edge): New inline function.

2010-12-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* reorg.c (fill_eager_delay_slots): Recompute own_target,
	fallthrough_insn and own_fallthrough when required.

2010-12-21  Chung-Lin Tang  <cltang@codesourcery.com>

	* release-notes.xml (Internal compiler error fixes): Update note.

	Issue #10201

	Backport from mainline:

	2010-12-16  Chung-Lin Tang  <cltang@codesourcery.com>

	PR target/46883
	gcc/
	* config/arm/arm.md
	(zero_extendhisi2 for register input splitter): Change
	"register_operand" to "s_register_operand".
	(zero_extendqisi2 for register input splitter): Same.

	gcc/testsuite/
	* gcc.target/arm/pr46883.c: New testcase.

2010-12-18  Andrew Stubbs  <ams@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-12-17  Andrew Stubbs  <ams@codesourcery.com>

	* config/arm/arm.md (maddhisi4, *maddhidi4): Use the canonical
	operand order for plus.
	Drop redundant % from constraints.

2010-12-17  Bernd Schmidt  <bernds@codesourcery.com>

	* release-notes.xml (Internal compiler error fix): New note.

	Issue #10208

	gcc/
	* config/arm/arm.c (arm_select_cc_mode): Before calling
	arm_select_dominance_cc_mode for AND or IOR operations, ensure
	that op is NE or EQ.

	gcc/testsuite/
	* gcc.c-torture/compile/20101217-1.c: New test.

2010-12-14  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Incorrect optimization fix): New note.

	Backport from mainline:

	2010-12-14  Jakub Jelinek  <jakub@redhat.com>

	PR tree-optimization/46909

	gcc/
	* tree-ssa-ccp.c (and_var_with_comparison_1): Save partial
	result even in the is_and case, if both partial results
	are the same, return it.
	(or_var_with_comparison_1): Use is_or predicate instead of
	innercode == TRUTH_OR_EXPR test.  Save partial result
	even in the is_or case, if both partial results are the
	same, return it.  In the !is_or case when both partial
	results are the same, return the partial result instead
	of boolean_true_node.

	gcc/testsuite/
	* gcc.c-torture/execute/pr46909-1.c: New test.
	* gcc.c-torture/execute/pr46909-2.c: New test.
	* gcc.dg/pr46909.c: New test.

2010-12-14  Julian Brown  <julian@codesourcery.com>

	Fix r309166:

	gcc/
	* hooks.h (hook_int_void_0): Add prototype.

2010-12-13  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* hooks.c (hook_int_void_0): New function.
	* target.h (struct gcc_target): New substruct target_align with field
	align_insns.
	* final.c (shorten_branches, final_scan_insn): Handle label in delay
	slot.
	* reorg.c (emit_delay_sequence, delete_from_delay_slot)
	(try_merge_delay_insns, fill_simple_delay_slots, fill_eager_delay_slots)
	* reorg.c (delay_list_has_label): New function.
	* reorg.c (fill_slots_from_thread): Detect when label in delay slot is
	safe and insert it.
	* reorg.c (relax_delay_slots): Remove unused labels in delay slots.
	* emit-rtl.c (verify_rtl_sharing): Handle label in delay slot.
	* cfglayout.c (reemit_insn_block_notes): Handle label in delay slot.
	* target-def.h (TARGET_ALIGN_INSNS, TARGET_ALIGN_HOOKS): Add define.
	* target-def.h (TARGET_INITIALIZER): Use TARGET_ALIGN_HOOKS.
	* config/mips/mips.md (define_peephole2): Add peephole to convert
	zero_extend into and.
	* config/mips/mips.c (mips_align_insns): New function.
	* config/mips/mips.c (TARGET_ALIGN_INSNS): Redefine as mips_align_insns.
	* doc/tm.texi (TARGET_ALIGN_INSNS): Add deftypefn.

2010-12-10  Tom de Vries <tom@codesourcery.com>

	gcc/
	*  gcc/testsuite/gcc.target/powerpc/builtin-isel.c: Add missing -times
	to scan-assembler.

2010-12-02  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #10089

	gcc/
	* expr.c (store_field): Avoid a direct store if the mode is larger
	than the size of the bit field.
	* stor-layout.c (layout_decl): If flag_strict_volatile_bitfields,
	treat non-volatile bit fields like volatile ones.
	* toplev.c (process_options): Disallow combination of
	-fstrict-volatile-bitfields and ABI versions less than 2.
	* config/arm/arm.c (arm_option_override): Don't enable
	flag_strict_volatile_bitfields if the ABI version is less than 2.
	* config/h8300/h8300.c (h8300_option_override): Likewise.
	* config/rx/rx.c (rx_option_override): Likewise.
	* config/m32c/m32c.c (m32c_option_override): Likewise.
	* config/sh/sh.c (sh_option_override): Likewise.

	gcc/testsuite/
	* gcc.target/arm/volatile-bitfields-4.c: New test.
	* c-c++-common/abi-bf.c: New test.

2010-12-01  Nathan Sidwell  <nathan@codesourcery.com>

	gcc/
	* config.gcc (powerpc-apm-linux): New sub-target.
	* config/rs6000/apm-linux.h: New.
	* config/rs6000/t-apm-linux: New.

2010-11-26  Tom de Vries  <tom@codesourcery.com>

	* release-notes-csl.xml: Add sign/zero extension removal release note.

	gcc/
	* gcc/ee.c: New file.
	* gcc/tree-pass.h (pass_ee): Declare.
	* gcc/opts.c (decode_options): Set flag_ee at -O2.
	* gcc/timevar.def (TV_EE): New timevar.
	* gcc/common.opt (fextension-elimination): New option.
	* gcc/Makefile.in (ee.o): New rule.
	* gcc/passes.c (pass_ee): Add it.
	* gcc/testsuite/gcc.dg/extend-4.c: New test.
	* gcc/testsuite/gcc.dg/extend-1.c: New test.
	* gcc/testsuite/gcc.dg/extend-2.c: New test.
	* gcc/testsuite/gcc.dg/extend-2-64.c: New test.
	* gcc/testsuite/gcc.dg/extend-3.c: New test.

2010-11-24  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* loop-iv.c (get_biv_step): Workaround loop analysis ICE.

2010-10-20  Tom de Vries  <tom@codesourcery.com>

	* release-notes-csl.xml: Add sync built-ins improvements release note.

	gcc/
	* config/mips/constraints.md (YE): New constraint.
	* config/mips/mips-ftypes.def (MIPS_SI_FTYPE_VPOINTER_SI)
	(MIPS_DI_FTYPE_VPOINTER_DI, MIPS_SI_FTYPE_VPOINTER_SI_SI)
	(MIPS_DI_FTYPE_VPOINTER_DI_DI):	New function type.
	* config/mips/mips.md (UNSPEC_COMPARE_AND_SWAP_ACQ)
	(UNSPEC_COMPARE_AND_SWAP_REL, UNSPEC_SWAP_ACQ, UNSPEC_SWAP_REL): New
        UNSPEC constant.
        * config/mips/mips.md (sync_cmp, sync_acquire_barrier)
        (sync_atomic_insn): New attribute.
        * config/mips/mips.md (sync_insn1): Add new value 'neg' to attribute.
	* config/mips/sync.md (sync_add<mode>, sync_sub<mode>)
	(sync_old_add<mode>, sync_old_sub<mode>, sync_new_add<mode>)
	(sync_new_sub<mode>, sync_lock_test_and_set<mode>):
	Change define_insn into define_expand.
	* config/mips/sync.md (sync_add_ll_sc<mode>, sync_add_ldadd<mode>)
	(sync_sub_ll_sc<mode>, sync_sub_ldadd<mode>, sync_old_add_ll_sc<mode>)
	(sync_old_add_ldadd<mode>, sync_old_sub_ll_sc<mode>)
	(sync_old_sub_ldadd<mode>, sync_new_add_ll_sc, gen_sync_new_sub_ll_sc)
	(mips_swap_ll_sc<mode>, mips_swap<mode>)
        (mips_val_compare_and_swap<d>_acq, mips_val_compare_and_swap<d>_rel)
        (mips_bool_compare_and_swap<d>_acq, mips_bool_compare_and_swap<d>_rel)
        (mips_swap<d>_acq, (mips_swap<d>_rel): New define_insn.
	* config/mips/mips-protos.h (mips_output_atomic): New prototype.
	* config/mips/mips.c (MIPS_BUILTIN_ATOMIC): New	builtin type.
	* config/mips/mips.c (mips_print_operand): New format identifier 'b'.
        * config/mips/mips.c (mips_sync_insn1_template): Handle neg.
        * config/mips/mips.c (mips_process_sync_loop): Handle sync_cmp, don't
        emit sync for xlp.
        * config/mips/mips.c (mips_sync_loop_insns): Handle atomic insns.
	* config/mips/mips.c (mips_builtin_avail_swap)
	(mips_builtin_avail_swapd, mips_builtin_avail_ll_sc)
	(mips_builtin_avail_lld_scd): New function.
	* config/mips/mips.c (ATOMIC_BUILTIN): New define.
	* config/mips/mips.c (__builtin_mips_swap_acq)
	(__builtin_mips_swap_rel, __builtin_mips_swapd_acq)
	(__builtin_mips_swapd_rel, __builtin_mips_val_compare_and_swap_acq)
	(__builtin_mips_val_compare_and_swap_rel)
	(__builtin_mips_val_compare_and_swapd_acq)
	(__builtin_mips_val_compare_and_swapd_rel)
	(__builtin_mips_bool_compare_and_swap_acq)
	(__builtin_mips_bool_compare_and_swap_rel)
	(__builtin_mips_bool_compare_and_swapd_acq)
	(__builtin_mips_bool_compare_and_swapd_rel): Declare builtin.
	* config/mips/mips.c (mips_build_vpointer_type): New function.
	* config/mips/mips.c (MIPS_ATYPE_VPOINTER): New define.
	* config/mips/mips.c (mips_expand_builtin_atomic): New function.
	* config/mips/mips.c (mips_expand_builtin): Handle
	MIPS_BUILTIN_ATOMIC using mips_expand_builtin_atomic.
	* config/mips/mips.c (mips_process_atomic, mips_output_atomic): New
	function.
	* config/mips/mips.h (TARGET_XLR, TARGET_XLP, GENERATE_SWAP)
        (GENERATE_LDADD): New define.
	* testsuite/gcc.target/mips/sync.c: New file.

2010-11-25  Andrew Stubbs  <ams@codesourcery.com>

	Backport from mainline:

	2010-10-28  Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* config/arm/arm.c (const_ok_for_arm): Support 0xXY00XY00 pattern
	constants in thumb2.

2010-11-25  Tom de Vries  <tom@codesourcery.com>

	* release-notes-csl.xml: Add delay slot filling release note.

2010-11-24  Maxim Kuvyrkov  <maxim@codesourcery.com>

	* release-notes-csl.xml: Add compiler optimizations release note.

	gcc/
	* combine.c (subst, combine_simlify_rtx): Add new argument, use it
	to track processing of conditionals.  Update all callers.
	(try_combine, simplify_if_then_else): Update.

2010-11-24  Tom de Vries  <tom@codesourcery.com>

	gcc/
        * reorg.c (has_opposite_duplicate): New function.
	* reorg.c (steal_delay_list_from_target, fill_slots_from_thread): Use
        new function.
	* reorg.c (steal_delay_list_from_target): Allow stealing from delay slot
        of return jump.
	* reorg.c (steal_delay_list_from_target): Add other_thread and
        own_opposite_thread function parameters.
        * reorg.c (fill_slots_from_thread): Additional function arguments for
        steal_delay_list_from_target.
        * reorg.c (fill_slots_from_thread): Add own_opposite_thread function
        parameter.
        * reorg.c (fill_simple_delay_slots, fill_eager_delay_slots): Additional
        function argument for fill_slots_from_thread.

2010-11-23  Thomas Schwinge  <thomas@codesourcery.com>

	Backport from mainline:

	2010-11-15  Jakub Jelinek  <jakub@redhat.com>

	PR tree-optimization/46491
	Backport from mainline

	2010-05-14  Jan Hubicka  <jh@suse.cz>
	* ipa-pure-const.c (check_stmt): Do not use memory_identifier_string.

	* gcc.target/i386/pr46491.c: New test.

2010-11-15  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/micromips.md (define_peephole2 for lwp)
	(define_insn "*lwp", define_peephole2 for swp, define_insn "*swp")
	(define_peephole2 for movep, define_insn "*movepsisi")
	(define_insn "*movepsisf", define_insn "*movepsfsi"): Guard usage of
	REGNO with REG_P.

2010-11-15  Jie Zhang  <jie.zhang@codesourcery.com>

	Issue #9759

	Merge from mainline:

	libstdc++-v3/
	2010-11-15  Jie Zhang  <jie.zhang@codesourcery.com>

	* testsuite/ext/profile/mh.cc: Add xfail for uclibc.

2010-11-03  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #10002

	gcc/
	* config/arm/arm.c (arm_legitimate_index_p): Split
	VALID_NEON_QREG_MODE and VALID_NEON_DREG_MODE cases.  Permit
	slightly larger constants in the latter case.
	(thumb2_legitimate_index_p): Likewise.

2010-11-03  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
	    Julian Brown  <julian@codesourcery.com>
	Merge from MIPS:
	gcc/
	* config/mips/mips-protos.h (dspalu_bypass_p): Add prototype.
	* config/mips/mips.c (dspalu_bypass_table): New.
	(dspalu_bypass_p): New.
	* 24k.md (r24k_dsp_alu, r24k_dsp_mac, r24k_dsp_mac_sat)
	(r24k_dsp_acc_ext, r24k_dsp_acc_mod): New insn reservations.
	(r24k_int_mult, r24k_int_mthilo, r24k_dsp_mac, r24k_dsp_mac_sat)
	(r24k_dsp_acc_ext, r24k_dsp_acc_mod, r24k_dsp_alu): New bypasses.
	* config/mips/mips.md (dspmac, dspmacsat, accext, accmod, dspalu)
	(dspalusat): Add insn types.
	* config/mips/mips-dsp.md (add<DSPV:mode>3)
	(mips_add<DSP:dspfmt1>_s_<DSP:dspfmt2>)
	(sub<DSPV:mode>3, mips_sub<DSP:dspfmt1>_s_<DSP:dspfmt2>, mips_addsc)
	(mips_addwc, mips_modsub, mips_raddu_w_qb, mips_absq_s_<DSPQ:dspfmt2>)
	(mips_precrq_qb_ph, mips_precrq_ph_w, mips_precrq_rs_ph_w)
	(mips_precrqu_s_qb_ph, mips_preceq_w_phl, mips_preceq_w_phr)
	(mips_precequ_ph_qbl, mips_precequ_ph_qbr, mips_precequ_ph_qbla)
	(mips_precequ_ph_qbra, mips_preceu_ph_qbl, mips_preceu_ph_qbr)
	(mips_preceu_ph_qbla, mips_preceu_ph_qbra, mips_shll_<DSPV:dspfmt2>)
	(mips_shll_s_<DSPQ:dspfmt2>, mips_shll_s_<DSPQ:dspfmt2>, mips_shrl_qb)
	(mips_shra_ph, mips_shra_r_<DSPQ:dspfmt2>, mips_bitrev, mips_insv)
	(mips_repl_qb, mips_repl_ph, mips_cmp<DSPV:dspfmt1_1>_eq_<DSPV:dspfmt2>)
	(mips_cmp<DSPV:dspfmt1_1>_lt_<DSPV:dspfmt2>)
	(mips_cmp<DSPV:dspfmt1_1>_le_<DSPV:dspfmt2>, mips_cmpgu_eq_qb)
	(mips_cmpgu_lt_qb, mips_cmpgu_le_qb, mips_pick_<DSPV:dspfmt2>)
	(mips_packrl_ph, mips_wrdsp, mips_rddsp): Change type to dspalu.
	(mips_dpau_h_qbl, mips_dpau_h_qbr, mips_dpsu_h_qbl, mips_dpsu_h_qbr)
	(mips_dpaq_s_w_ph, mips_dpsq_s_w_ph, mips_mulsaq_s_w_ph)
	(mips_maq_s_w_phl, mips_maq_s_w_phr, mips_maq_sa_w_phr: Set type to
	dspmac.
	(mips_dpaq_sa_l_w, mips_dpsq_sa_l_w, mips_maq_sa_w_phl): Set type to
	dspmacsat.
	(mips_extr_w, mips_extr_r_w, mips_extr_rs_w, mips_extp, mips_extpdp):
	Set type to accext.
	(mips_shilo, mips_mthlip): Set type to accmod.
	* config/mips/mips-dspr2.md (mips_absq_s_qb, mips_addu_s_ph)
	(mips_adduh_r_qb): Set type to dspalusat.
	(mips_addu_ph, mips_adduh_qb, mips_append, mips_balign)
	(mips_cmpgdu_eq_qb, mips_cmpgdu_lt_qb, mips_cmpgdu_le_qb)
	(mips_precr_qb_ph, mips_precr_sra_ph_w, mips_precr_sra_r_ph_w)
	(mips_prepend, mips_shra_qb, mips_shra_r_qb, mips_shrl_ph)
	(mips_subu_ph, mips_subuh_qb, mips_subuh_r_qb, mips_addqh_ph)
	(mips_addqh_r_ph, mips_addqh_w, mips_addqh_r_w, mips_subqh_ph)
	(mips_subqh_r_ph, mips_subqh_w, mips_subqh_r_w): Set type to dspalu.
	(mips_dpa_w_ph, mips_dps_w_ph, mips_mulsa_w_ph, mips_dpax_w_ph)
	(mips_dpsx_w_ph, mips_dpaqx_s_w_ph, mips_dpsqx_s_w_ph): Set type to
	dspmac.
	(mips_subu_s_ph): Set type to dspalusat.
	(mips_dpaqx_sa_w_ph, mips_dpsqx_sa_w_ph): Set type to dspmacsat.

	2008-02-15  Julian Brown  <julian@codesourcery.com>
	Merge from MIPS:
	2007-11-06  David Ung  <davidu@mips.com>
	gcc/
	* config/mips/mips.h (AC1HI_REGNUM, AC1LO_REGNUM, AC2HI_REGNUM)
	(AC2LO_REGNUM, AC3HI_REGNUM, AC3LO_REGNUM): Define constants.

	Merge from Sourcery G++ 4.2:
	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
	    Julian Brown  <julian@codesourcery.com>
	* 74k.md: (r74k_dsp_alu, r74k_dsp_alu_sat, r74k_dsp_mac, r74k_dsp_mac_sat)
	(r74k_dsp_acc_ext, r74k_dsp_acc_mod): New insn reservations.
	(r74k_dsp_mac, r74k_dsp_mac_sat, r74k_int_mult, r74k_int_mul3)
	(r74k_dsp_mac, r74k_dsp_mac_sat): New bypasses.

2010-11-03  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	Merge from Sourcery G++ 4.3:

	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>
		    Julian Brown  <julian@codesourcery.com>
	
	* 74k.md: (r74k_dsp_alu, r74k_dsp_alu_sat, r74k_dsp_mac, r74k_dsp_mac_sat)
	(r74k_dsp_acc_ext, r74k_dsp_acc_mod): New insn reservations.
	(r74k_dsp_mac, r74k_dsp_mac_sat, r74k_int_mult, r74k_int_mul3)
	(r74k_dsp_mac, r74k_dsp_mac_sat): New bypasses.

2010-11-01  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/neon.md (vec_pack_trunc_<mode>)
	(neon_vec_pack_trunc_<mode>): Disable in big-endian mode.

2010-11-01  Jie Zhang  <jie@codesourcery.com>

	Issue #9759

	libstdc++-v3/
	* config/abi/pre/gnu.ver: Move __emutls_v._ZSt11__once_call
	and __emutls_v._ZSt15__once_callable to GLIBCXX_3.4.15.

2010-11-01  Jie Zhang  <jie@codesourcery.com>

	Issue #9759

	Backport from mainline:

	libstdc++-v3/
	2010-11-01  Jie Zhang  <jie@codesourcery.com>

	* config/abi/pre/gnu.ver: Export __emutls_v._ZSt11__once_call
	and __emutls_v._ZSt15__once_callable.

2010-11-01  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (New -fstrict-volatile-bitfields): Add
	missing word.

2010-10-27  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9386

	* release-notes-csl.xml: New note.

	gcc/
	* reload1.c (choose_reload_regs): Don't look for equivalences for
	output reloads of constant loads.

	gcc/testsuite/
	* gcc.dg/pr44606.c: New test.

2010-10-27  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #8708

	* release-notes-csl.xml: New note.

	gcc/
	* config/rs6000/rs6000-protos.h (altivec_resolve_overloaded_builtin):
	Delete.
	(rs6000_resolve_overloaded_builtin): Declare.
	* config/rs6000/rs6000-c.c (altivec_resolve_overloaded_builtin): Make
	static.
	(isel_arguments_valid): New function.
	(rs6000_resolve_isel_builtin): New function.
	(rs6000_resolve_overloaded_builtin): New function.
	* config/rs6000/rs6000-builtin.def: Declare isel builtins.
	* config/rs6000/rs6000.h (struct isel_builtin_desc): Declare.
	(builtin_iselw, builtin_iseld): Likewise.
	* config/rs6000/rs6000.c (rs6000_init_builtins): Initialize isel
	builtins.
	(rs6000_expand_builtins): Try to expand isel builtins.
	(ISEL_Pmode): Define.
	(ISEL_BASE, ISEL_P_RESULT, ISEL_S_RESULT, ISEL_U_RESULT): Define.
	(ISEL_EXPAND_ARG, ISEL_PTR_ARG, ISEL_SIGNED_ARG, ISEL_UNSIGNED_ARG):
	Define.
	(ISEL_EQ, ISEL_LT, ISEL_GT, ISEL_LTU, ISEL_GTU): Define.
	(builtin_iselw, builtin_iseld): Define.
	(isel_cmp_mode, isel_sel_mode, isel_argtype): New functions.
	(isel_strdesc): New function.
	(rs6000_init_isel_builtins): New function.
	(rs6000_expand_isel_builtin): New function.
	* doc/extend.texi (PowerPC AltiVec/VSX Builtin-in Functions): Document
	__builtin_isel functions.

	gcc/testsuite/
	* gcc.target/powerpc/builtin-isel.h: New file.
	* gcc.target/powerpc/builtin-isel.c: New test.
	* gcc.target/powerpc/builtin-isel-errors.c: New test.
	* gcc.target/powerpc/builtin-isel64.c: New test.
	* gcc.target/powerpc/builtin-isel64-errors.c: New test.

2010-10-26  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-10-26  Jie Zhang  <jie@codesourcery.com>

	* doc/invoke.texi: Improve documentation of
	-fstrict-volatile-bitfields.

2010-10-26  Jie Zhang  <jie@codesourcery.com>
	    Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #9606

	gcc/
	* haifa-sched.c (ISSUE_POINTS): Remove.
	(max_issue): Don't issue more than issue_rate instructions.

2010-10-26  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-10-23  Jie Zhang  <jie@codesourcery.com>
	PR rtl-optimization/37360
	* config/mips/mips.c (cached_can_issue_more): New local variable.
	(mips_sched_reorder_1): New.
	(mips_sched_reorder): Use mips_sched_reorder_1.
	(mips_sched_reorder2): New.
	(mips_variable_issue): Set cached_can_issue_more.
	(TARGET_SCHED_REORDER2): Define to mips_sched_reorder2
	instead of mips_sched_reorder.

	Revert
	2008-09-09  Andrey Belevantsev  <abel@ispras.ru>
	PR rtl-optimization/37360
	* haifa-sched.c (max_issue): Do not assert that we never issue more
	insns than issue_rate.  Add comment.

	gcc/testsuite/
	2010-10-23  Jie Zhang  <jie@codesourcery.com>
	PR rtl-optimization/37360
	* gcc.dg/pr37360.c: New test.

2010-10-26  Jie Zhang  <jie@codesourcery.com>

	Issue #1259

	* release-notes-csl.xml: Document.

	Backport from mainline:

	gcc/
	2010-10-26  Jie Zhang  <jie@codesourcery.com>

	* stor-layout.c (layout_decl): Use the field's type to
	determine the mode and keep DECL_BIT_FIELD for a volatile
	bit-field.
	* config/arm/arm.c (arm_override_options): Default to
	-fstrict-volatile-bitfields.

	gcc/testsuite/
	2010-10-26  Jie Zhang  <jie@codesourcery.com>

	* gcc.target/arm/volatile-bitfields-1.c: New test.
	* gcc.target/arm/volatile-bitfields-2.c: New test.
	* gcc.target/arm/volatile-bitfields-3.c: New test.

2010-10-25  Jie Zhang  <jie@codesourcery.com>

	Issue #1259

	Backport from mainline:

	gcc/
	2010-10-22  Jie Zhang  <jie@codesourcery.com>

	* expr.c (emit_group_load_1): Update calls to extract_bit_field.
	(copy_blkmode_from_reg): Likewise.
	(read_complex_part): Likewise.
	(expand_expr_real_1): Calculate packedp and pass it to
	extract_bit_field.
	* expr.h (extract_bit_field): Update declaration.
	* calls.c (store_unaligned_arguments_into_pseudos): Update call
	to extract_bit_field.
	* expmed.c (extract_fixed_bit_field): Update calls to
	extract_fixed_bit_field.
	(store_split_bit_field): Likewise.
	(extract_bit_field_1): Add new argument packedp.
	(extract_bit_field): Add new argument packedp.
	(extract_fixed_bit_field): Add new argument packedp and let
	packed attribute override volatile.
	* stmt.c (expand_return): Update call to extract_bit_field.

	2010-10-15  Jie Zhang  <jie@codesourcery.com>

	* doc/invoke.texi: Add -fstrict-volatile-bitfields to
	Option Summary and Index.

	2010-07-13  DJ Delorie  <dj@redhat.com>

	* config/h8300/h8300.c (h8300_init_once): Default to
	-fstrict_volatile_bitfields.

	* config/sh/sh.c (sh_override_options): Default to
	-fstrict_volatile_bitfields.

	* config/rx/rx.c (rx_option_override): New.

	* config/m32c/m32c.c (m32c_override_options): Default to
	-fstrict_volatile_bitfields.

	2010-06-16  DJ Delorie  <dj@redhat.com>

	* common.opt (-fstrict-volatile-bitfields): new.
	* doc/invoke.texi: Document it.
	* fold-const.c (optimize_bit_field_compare): For volatile
	bitfields, use the field's type to determine the mode, not the
	field's size.
	* expr.c (expand_assignment): Likewise.
	(get_inner_reference): Likewise.
	(expand_expr_real_1): Likewise.
	* expmed.c (store_fixed_bit_field): Likewise.
	(extract_bit_field_1): Likewise.
	(extract_fixed_bit_field): Likewise.

	gcc/testsuite/
	2010-08-19  Uros Bizjak  <ubizjak@gmail.com>

	PR testsuite/45324
	* gcc.target/i386/volatile-bitfields-1.c: Also scan movb.

	2010-06-16  DJ Delorie  <dj@redhat.com>

	* gcc.target/i386/volatile-bitfields-1.c: New.
	* gcc.target/i386/volatile-bitfields-2.c: New.

2010-10-25  Jie Zhang  <jie@codesourcery.com>

	Issue #9812

	* release-notes-csl.xml: Document.

	Backport from mainline:

	gcc/
	2010-10-25  Jie Zhang  <jie@codesourcery.com>
	* combine.c (try_combine): If insns need to be kept around,
	check that they can be copied in the merged instruction.

	gcc/testsuite/
	2010-10-25  Jie Zhang  <jie@codesourcery.com>
	* g++.dg/opt/combine.c: New test.

2010-10-23  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/
	2010-10-14  Joseph Myers  <joseph@codesourcery.com>

	PR c/45969
	* c-typeck.c (build_binary_op): Don't try to compute a semantic
	type with excess precision for boolean operations.

	gcc/testsuite/
	2010-10-14  Joseph Myers  <joseph@codesourcery.com>

	PR c/45969
	* gcc.c-torture/compile/pr45969-1.c: New test.

2010-10-23  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	2010-10-23  Joseph Myers  <joseph@codesourcery.com>

	* gcc.dg/march-generic.c: Skip for -march in multilib options.
	* gcc.target/i386/isa-9.c: Skip for -march other than
	-march=amdfam10 in multilib options.
	* gcc.target/i386/pr42589.c: Skip for -march other than
	-march=i486 in multilib options.
	* gcc.target/i386/sse-19.c: Add -march=x86-64 option and skip for
	other -march in multilib options.

2010-10-22  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gcc/testsuite/
	2010-04-22  Bernd Schmidt  <bernds@codesourcery.com>

	* gcc.target/i386/wmul-1.c: Add dg-require-effective-target ilp32.
	* gcc.target/i386/wmul-2.c: Likewise.

2010-10-22  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:

	2010-10-18  Marcus Shawcroft  <marcus.shawcroft@arm.com>

	gcc/testsuite/
	* gcc.target/arm/synchronize.c: Permit dmb or mcr in assembler scan.

2010-10-20  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Internal compiler error fixes): Merge
	three ARM-specific notes into one.

2010-10-20  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9781

	* release-notes-csl.xml (Code generation improvement): Update note.

	Backport from mainline:

	gcc/
	2010-10-20  Nathan Froyd  <froydnj@codesourcery.com>

	* ifcvt.c (noce_emit_cmove): If both of the values are SUBREGs, try
	emitting the conditional move in the inner mode of the SUBREG.

2010-10-20  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config.gcc (powerpc*-*-*): Add e5500 as a valid 64-bit cpu name.

2010-10-20  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml (NEON narrowing-move instructions):
	Add note.

	Backport from mainline:

	2010-08-31  Tejas Belagod  <tejas.belagod@arm.com>

	gcc/
	* config/arm/neon.md (vec_pack_trunc_<mode>): Instruction
	pattern for vmovn. Expansion in case of non 
	-mvectorize-with-neon-quad.
	(neon_vec_pack_trunc_<mode>): Instruction pattern for vmovn for
	non- -mvectorize-with-neon-quad case.
	(move_lo_quad_<mode>): New expansion to vmov into low part.
	(move_hi_quad_<mode>): New expansion to vmov into high part.
	(move_lo_quad_v4si): Refactor to move_lo_quad_<mode> expansion.
	(move_lo_quad_v4sf): Likewise.
	(move_lo_quad_v8hi): Likewise.
	(neon_move_lo_quad_<mode>): Instruction pattern for vmov into
	low part.
	(neon_move_hi_quad_<mode>): Instruction pattern for vmov into
	high part.
	* config/arm/iterators.md (ANY128): New mode iterator.
	(V_narrow_pack): New mode attribute.
	(V_HALF): Add attribute.
	(V_DOUBLE): Add attribute.
	(V_mode_nunits): Add attribute.

	2010-08-31  Tejas Belagod  <tejas.belagod@arm.com>

	gcc/testsuite/
	* lib/target-supports.exp
	(check_effective_target_vect_pack_trunc): Set vect_pack_trunc
	supported flag to true for neon.

	The neon_vec_pack_trunc_<mode> part of:

	2010-09-29  Tejas Belagod  <tejas.belagod@arm.com>

	gcc/
	* config/arm/neon.md (neon_unpack<US>_<mode>): Add 'w' to
	constraint, add register specifier in instruction template.
	(neon_vec_pack_trunc_<mode>): Likewise.
	(neon_vec_<US>mult_<mode>): Add register specifier to
	instruction template.

	2010-10-11  Tejas Belagod  <tejas.belagod@arm.com>

	gcc/
	* config/arm/neon.md (neon_move_hi_quad_<mode>): Fix the order
	of operands to vec_concat.

	2010-10-22  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/neon.md (neon_move_lo_quad_<mode>): Use matching
	constraint instead of match_dup.
	(neon_move_hi_quad_<mode>): Likewise. Fix condition for omitting
	redundant vmov instruction.
	(move_hi_quad_<mode>): Add extra argument to
	gen_neon_move_hi_quad_<mode> call.
	(move_lo_quad_<mode>): Similar, for gen_neon_move_lo_quad_<mode>
	call.
	(vec_pack_trunc_<mode>): Fix assembly template, add length

2010-10-19  Yao Qi  <yao@codesourcery.com>

	Issue #9602

	* release-notes-csl.xml: Document the bug fix.
	Backport from mainline:

	2010-10-14  Yao Qi  <yao@codesourcery.com>

	gcc/
	PR target/45447
	* config/arm/arm.c (arm_build_builtin_va_list): Assign
	va_list_name to TYPE_STUB_DECL (va_list_type).

	gcc/testsuite/
	PR target/45447
	* gcc.target/arm/pr45447.c: New test.

2010-10-19  Jie Zhang  <jie@codesourcery.com>

	Issue #9596

	Backport from mainline:

	gcc/

	2010-07-22  Richard Henderson  <rth@redhat.com>

	PR target/45027
	* config/i386/i386.c (setup_incoming_varargs_64): Force the use
	of V4SFmode for the SSE saves; increase stack alignment if needed.
	(ix86_gimplify_va_arg): Don't increase stack alignment here.

	2010-07-21  Richard Henderson  <rth@redhat.com>

	* config/i386/i386.c (setup_incoming_varargs_64): Emit a simple
	comparison for avoiding xmm register saves.  Emit the xmm register
	saves explicitly.
	* config/i386/i386.md (UNSPEC_SSE_PROLOGUE_SAVE): Remove.
	(UNSPEC_SSE_PROLOGUE_SAVE_LOW): Remove.
	(sse_prologue_save, sse_prologue_save_insn1, sse_prologue_save_insn):
	Remove patterns and the associated splitters.

	2010-05-04  H.J. Lu  <hongjiu.lu@intel.com>

	PR target/43799
	* config/i386/i386.md (sse_prologue_save): Add clobber CC
	register.
	(*sse_prologue_save_insn1): Likewise.
	(SSE prologue save splitter): Likewise.

	2010-04-18  Jan Hubicka  <jh@suse.cz>

	* i386.md (UNSPEC_SSE_PROLOGUE_SAVE_LOW): New.
	(sse_prologue_save_insn expander): Use new pattern.
	(sse_prologue_save_insn1): New pattern and splitter.
	(sse_prologue_save_insn): Update to deal also with 64bit aligned
	blocks.
	* i386.c (setup_incoming_varargs_64): Do not compute jump destination here.
	(ix86_gimplify_va_arg): Update alignment needed.
	(ix86_local_alignment): Do not align all local arrays
	to 128bit.

	gcc/testsuite/
	2010-05-04  H.J. Lu  <hongjiu.lu@intel.com>

	PR target/43799
	* gcc.target/i386/pr43799.c: New.

2010-10-18  Yao Qi  <yao@codesourcery.com>

	Issue #9602

	* release-notes-csl.xml: Document the bug fix.
	Backport from mainline:

	2010-10-14  Yao Qi  <yao@codesourcery.com>

	gcc/
	PR target/45447
	* config/arm/arm.c (arm_build_builtin_va_list): Assign
	va_list_name to TYPE_STUB_DECL (va_list_type).

	gcc/testsuite/
	PR target/45447
	* gcc.target/arm/pr45447.c: New test.

2010-10-18  Kazu Hirata  <kazu@codesourcery.com>

	Issue #9724
	* release-notes-csl.xml: Fix a typo.

2010-10-18  Kazu Hirata  <kazu@codesourcery.com>

	Issue #9720
	Backport from mainline:
	gcc/
	2010-10-07  Tejas Belagod  <tejas.belagod@arm.com>
	* config/arm/neon.md (neon_unpack<US>_<mode>): Add 'w' to
	constraint, add register specifier in instruction template.
	(neon_vec_pack_trunc_<mode>): Likewise.
	(neon_vec_<US>mult_<mode>): Add register specifier to
	instruction template.

	* release-notes-csl.xml: Document the bug fix above.

2010-10-18  Paul Brook  <paul@codesourcery.com>

	* tree-vect-stmts.c (supportable_widening_operation): Check if wide
	vector type exists.

2010-10-14  Julian Brown  <julian@codesourcery.com>

	Backport from mainline:
 
	2010-08-18  Marcus Shawcroft  <marcus.shawcroft@arm.com>

	gcc/
	* config/arm/arm-protos.h (arm_expand_sync): New.
	(arm_output_memory_barrier, arm_output_sync_insn): New.
	(arm_sync_loop_insns): New.
	* config/arm/arm.c (FL_ARCH7): New.
	(FL_FOR_ARCH7): Include FL_ARCH7.
	(arm_arch7): New.
	(arm_print_operand): Support %C markup.
	(arm_legitimize_sync_memory): New.
	(arm_emit, arm_insn_count, arm_count, arm_output_asm_insn): New.
	(arm_process_output_memory_barrier, arm_output_memory_barrier): New.
	(arm_ldrex_suffix, arm_output_ldrex, arm_output_strex): New.
	(arm_output_op2, arm_output_op3, arm_output_sync_loop): New.
	(arm_get_sync_operand, FETCH_SYNC_OPERAND): New.
	(arm_process_output_sync_insn, arm_output_sync_insn): New.
	(arm_sync_loop_insns,arm_call_generator, arm_expand_sync): New.
	* config/arm/arm.h (struct arm_sync_generator): New.
	(TARGET_HAVE_DMB, TARGET_HAVE_DMB_MCR): New.
	(TARGET_HAVE_MEMORY_BARRIER): New.
	(TARGET_HAVE_LDREX, TARGET_HAVE_LDREXBHD): New.
	* config/arm/arm.md: Include sync.md.
	(UNSPEC_MEMORY_BARRIER): New.
	(VUNSPEC_SYNC_COMPARE_AND_SWAP, VUNSPEC_SYNC_LOCK): New.
	(VUNSPEC_SYNC_OP):New.
	(VUNSPEC_SYNC_NEW_OP, VUNSPEC_SYNC_OLD_OP): New.
	(sync_result, sync_memory, sync_required_value): New attributes.
	(sync_new_value, sync_t1, sync_t2): Likewise.
	(sync_release_barrier, sync_op): Likewise.
	(length): Add logic to length attribute defintion to call
	arm_sync_loop_insns when appropriate.
	* config/arm/sync.md: New file.

	2010-09-02  Marcus Shawcroft  <marcus.shawcroft@arm.com>

	gcc/
	* config/arm/predicates.md (arm_sync_memory_operand): New.
	* config/arm/sync.md (arm_sync_compare_and_swapsi): Change predicate
	to arm_sync_memory_operand and constraint to Q.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_lock_test_and_setsi): Likewise.
	(arm_sync_lock_test_and_set<mode>): Likewise.
	(arm_sync_new_<sync_optab>si): Likewise.
	(arm_sync_new_nandsi): Likewise.
	(arm_sync_new_<sync_optab><mode>): Likewise.
	(arm_sync_new_nand<mode>): Likewise.
	(arm_sync_old_<sync_optab>si): Likewise.
	(arm_sync_old_nandsi): Likewise.
	(arm_sync_old_<sync_optab><mode>): Likewise.
	(arm_sync_old_nand<mode>): Likewise.

	2010-09-13  Marcus Shawcroft  <marcus.shawcroft@arm.com>

	gcc/
	* config/arm/arm.md: (define_attr "conds"): Update comment.
	* config/arm/sync.md (arm_sync_compare_and_swapsi): Change
	conds attribute to clob.
	(arm_sync_compare_and_swapsi): Likewise.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_lock_test_and_setsi): Likewise.
	(arm_sync_lock_test_and_set<mode>): Likewise.
	(arm_sync_new_<sync_optab>si): Likewise.
	(arm_sync_new_nandsi): Likewise.
	(arm_sync_new_<sync_optab><mode>): Likewise.
	(arm_sync_new_nand<mode>): Likewise.
	(arm_sync_old_<sync_optab>si): Likewise.
	(arm_sync_old_nandsi): Likewise.
	(arm_sync_old_<sync_optab><mode>): Likewise.
	(arm_sync_old_nand<mode>): Likewise.

	2010-09-13  Marcus Shawcroft  <marcus.shawcroft@arm.com>

	gcc/testsuite/
	* gcc.target/arm/sync-1.c: New.

2010-10-15  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #9810
	Issue #9811

	* release-notes-csl.xml: Document.

	Backport from mainline:

	2010-10-15  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* ifcvt.c (find_active_insn_before): New function.
	(find_active_insn_after): New function.
	(cond_exec_process_if_block): Use new functions to replace
	prev_active_insn() and next_active_insn().

	gcc/testsuite/
	* gcc.dg/20101010-1.c: New testcase.

2010-10-15  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/testsuite/
	2010-10-15  Jie Zhang  <jie@codesourcery.com>

	* lib/lto.exp (lto-link-and-maybe-run): Use the default linker
	script when relocatable linking.

2010-10-14  Catherine Moore  <clm@codesourcery.com>

	Issue #9808

	gcc/
	* doc/invoke.texi (MIPS options): Document -m14kc.

2010-10-14  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* config/mips/micromips.md (*lwp, *swp): Fix 'control reaches end of
	non-void function' warnings.

2010-10-13  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #8615

	* release-notes-csl.xml: Document.

	Backport from mainline:

	2010-10-12  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config/arm/arm.h (ARM_EXPAND_ALIGNMENT): Rename from
	DATA_ALIGNMENT and add COND parameter. Update comments above.
	(DATA_ALIGNMENT): Use ARM_EXPAND_ALIGNMENT, with !optimize_size.
	(LOCAL_ALIGNMENT): Use ARM_EXPAND_ALIGNMENT, with
	!flag_conserve_stack.

2010-10-13  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9780

	* release-notes-csl.xml: New note.

	Backport from mainline:

	gcc/
	2010-10-12  Nathan Froyd  <froydnj@codesourcery.com>

	* config/rs6000/predicates.md (scc_rev_comparison_operator): New.
	* config/rs6000/rs6000.md (*isel_reversed_signed_<mode>): New.
	(*isel_reversed_unsigned_<mode>): New.
	* config/rs6000/rs6000.c (output_isel): Accept GE/GEU/LE/LEU/NE
	as valid comparisons and adjust operands and output appropriately.
	(rs6000_rtx_costs) <CONST_INT>: Accept NE as a cost-0 outer_code.

2010-10-13  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8915
	gcc/
	* doc/invoke.texi (ARM Options): Document -mtls-dialect option.
	* config.gcc (arm*-*-linux*): Hardwire TLS_DIALECT_DEFAULT to gnu.
	* config/arm/arm.c (TLS_DIALECT_DEFAULT): New.
	(target_tls_dialect): New.
	(enum tls_reloc): Add TLS_DESCSEQ.
	(arm_override_options): Process target_tls_dialect_switch value.
	(arm_call_tls_get_addr): Clean up.
	(arm_tls_descseq_addr): New.
	(legitimize_tls_address): Add tlsdesc support.
	(arm_emit_tls_decoration): Likewise.
	* config/arm/arm.h (TARGET_ARM_TLS, TARGET_GNU_TLS): New.
	(enum arm_tls_type): New.
	(target_tls_dialect): New.
	* config/arm/arm.opt (mtls-dialect): New switch.
	* config/arm/arm.md (tlscall): New.

	* release-note-csl.xml: Document it.

2010-10-12  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #9400
	* release-notes-csl.xml (GCC bug fix for push multiple instruction
	generation): copy-edit.
	(GCC version 4.5):  We really shipped previews with version 4.5.1.

2010-10-10  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2010-04-20  James E. Wilson  <wilson@codesourcery.com>

	gcc/
	PR rtl-optimization/43520
	* ira-lives.c (ira_implicitly_set_insn_hard_regs): Exclude classes with
	zero available registers.

2010-10-09  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-06-03  Paul Brook  <paul@codesourcery.com>
	* config/arm/arm.c (FL_TUNE): Define.
	(arm_default_cpu, arm_cpu_select): Remove.
	(all_cores): Populate core field.
	(arm_selected_arch, arm_selected_cpu, arm_selected_tune): New.
	(arm_find_cpu): New function.
	(arm_handle_option): Lookup cpu/architecture names.
	(arm_override_options): Cleanup mcpu/march/mtune handling.
	(arm_file_start): Ditto.

2010-10-08  Jie Zhang  <jie@codesourcery.com>

	* config/arm/arm.c (arm_override_options): Disable
	-fsched-interblock for Cortex-M4.

2010-10-08  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config/i386/i386elf.h (ENDFILE_SPEC): Add crtn.o.
	(STARTFILE_SPEC): Remove crt0.o. Add crti.o.
	* config/i386/t-i386elf: Build crti.o and crtn.o.

2010-10-06  Julian Brown  <julian@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/Warray-bounds-3.c: Add -fno-unroll-loops for ARM.
	* gcc.dg/vect/vect.exp: Likewise, for all vect tests.

2010-10-05  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Precision improvement with vectorization
	enabled): Rephrase note to avoid bad line break in PDF output.

2010-10-05  Joseph Myers  <joseph@codesourcery.com

	Issue #9699

	gcc/
	* common.opt (Wpoison-system-directories): Mark as Warning option.

2010-09-30  Jie Zhang  <jie@codesourcery.com>

	gcc/testsuite/
	* gcc.target/arm/neon-thumb2-move.c: Add
	dg-require-effective-target arm_thumb2_ok.

2010-10-01  Julian Brown  <julian@codesourcery.com>

	Revert:

	* release-notes-csl.xml (Compiler optimization improvements):
	Remove mention of improved synchronization primitives.

	Backport from FSF:

	gcc/
	2010-08-18  Marcus Shawcroft  <marcus.shawcroft@arm.com>
	* config/arm/arm-protos.h (arm_expand_sync): New.
	(arm_output_memory_barrier, arm_output_sync_insn): New.
	(arm_sync_loop_insns): New.
	* config/arm/arm.c (FL_ARCH7): New.
	(FL_FOR_ARCH7): Include FL_ARCH7.
	(arm_arch7): New.
	(arm_print_operand): Support %C markup.
	(arm_legitimize_sync_memory): New.
	(arm_emit, arm_insn_count, arm_count, arm_output_asm_insn): New.
	(arm_process_output_memory_barrier, arm_output_memory_barrier): New.
	(arm_ldrex_suffix, arm_output_ldrex, arm_output_strex): New.
	(arm_output_op2, arm_output_op3, arm_output_sync_loop): New.
	(arm_get_sync_operand, FETCH_SYNC_OPERAND): New.
	(arm_process_output_sync_insn, arm_output_sync_insn): New.
	(arm_sync_loop_insns,arm_call_generator, arm_expand_sync): New.
	* config/arm/arm.h (struct arm_sync_generator): New.
	(TARGET_HAVE_DMB, TARGET_HAVE_DMB_MCR): New.
	(TARGET_HAVE_MEMORY_BARRIER): New.
	(TARGET_HAVE_LDREX, TARGET_HAVE_LDREXBHD): New.
	* config/arm/arm.md: Include sync.md.
	(UNSPEC_MEMORY_BARRIER): New.
	(VUNSPEC_SYNC_COMPARE_AND_SWAP, VUNSPEC_SYNC_LOCK): New.
	(VUNSPEC_SYNC_OP):New.
	(VUNSPEC_SYNC_NEW_OP, VUNSPEC_SYNC_OLD_OP): New.
	(sync_result, sync_memory, sync_required_value): New attributes.
	(sync_new_value, sync_t1, sync_t2): Likewise.
	(sync_release_barrier, sync_op): Likewise.
	(length): Add logic to length attribute defintion to call
	arm_sync_loop_insns when appropriate.
	* config/arm/sync.md: New file.

	gcc/
	2010-09-02  Marcus Shawcroft  <marcus.shawcroft@arm.com>
	* config/arm/predicates.md (arm_sync_memory_operand): New.
	* config/arm/sync.md (arm_sync_compare_and_swapsi): Change predicate
	to arm_sync_memory_operand and constraint to Q.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_lock_test_and_setsi): Likewise.
	(arm_sync_lock_test_and_set<mode>): Likewise.
	(arm_sync_new_<sync_optab>si): Likewise.
	(arm_sync_new_nandsi): Likewise.
	(arm_sync_new_<sync_optab><mode>): Likewise.
	(arm_sync_new_nand<mode>): Likewise.
	(arm_sync_old_<sync_optab>si): Likewise.
	(arm_sync_old_nandsi): Likewise.
	(arm_sync_old_<sync_optab><mode>): Likewise.
	(arm_sync_old_nand<mode>): Likewise.

2010-09-30  Jie Zhang  <jie@codesourcery.com>

	gcc/testsuite/

	* c-c++-common/uninit-17.c: Adjust warning message.

	Backport from mainline:

	2010-07-30  Xinliang David Li  <davidxl@google.com>
	PR tree-optimization/45121
	* c-c++-common/uninit-17.c: Add -fno-ivops option.

2010-09-28  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/testsuite/
	2010-09-28  Jie Zhang  <jie@codesourcery.com>
	* gcc.dg/Wcxx-compat-12.c: Add -fno-short-enums.

2010-09-24  Joseph Myers  <joseph@codesourcery.com>

	gcc/testsuite/

	Merge from FSF 4.5 branch:

	2010-08-04  Uros Bizjak  <ubizjak@gmail.com>

	* gcc.dg/march.c: Skip if -march defined.
	* gcc.dg/mtune.c: Skip if -mtune defined.

	* g++.old-deja/g++.jason/thunk3.C: Skip for targets with
	generic thunk support.

	Backport from mainline:
	2010-05-25  Richard Guenther  <rguenther@suse.de>

	* gcc.dg/tree-ssa/sra-10.c: Do not dump esra details.

	Backport from mainline:
	2010-04-22  Uros Bizjak  <ubizjak@gmail.com>

	* gcc.dg/graphite/interchange-0.c: Fix dg-final directive.

2010-09-22  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2010-09-22  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* postreload.c (move2add_note_store): Add reg_symbol_ref[] checks
	to update conditions. Fix reg_mode[] check.

2010-09-21  Maciej W. Rozycki  <macro@codesourcery.com>

	gcc/
	* config/mips/mips.c (mips_print_operand_punctuation): Fix
	conditions used to check for the reorder mode.

2010-09-21  Andrew Stubbs  <ams@codesourcery.com>

	* release-notes-csl.xml: Mention A9 improvements.

2010-09-21  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/testsuite/
	* gcc/testsuite/gcc.dg/lto/20090210_1.c: Move tls_runtime requirement...
	* gcc/testsuite/gcc.dg/lto/20090210_0.c: ... here.

2010-09-20  Jie Zhang  <jie@codesourcery.com>

	Fix a mis-merge from Sourcery G++ 4.4:

	2009-10-02  Paul Brook  <paul@codesourcery.com>
	Issue #4896
	gcc/
	* config/arm/t-cs-linux-lite: Change v5t multilib to v5te.

2010-09-20  Andrew Stubbs  <ams@codesourcery.com>

	Backport from FSF:

	gcc/
	2010-09-01  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>

	* config/arm/neon-schedgen.ml (core): New type.
	(allCores): List of supported cores.
	(availability_table): Add supported cores.
	(collate_bypasses): Accept core as a parameter.
	(worst_case_latencies_and_bypasses): Accept core as a
	 parameter.
	(emit_insn_reservations): Accept core as a parameter.
	Use tuneStr and coreStr to get tune attribute and prefix
	for functional units.
	(emit_bypasses): Accept core name and use it.
	(calculate_per_core_availability_table): New.
	(filter_core): New.
	(calculate_core_availability_table): New.
	(main): Use calculate_core_availablity_table.
	* config/arm/cortex-a8-neon.md: Update copyright year.
	Regenerated from ml file and merged in.
	(neon_mrrc, neon_mrc): Rename to cortex_a8_neon_mrrc and
	cortex_a8_neon_mrc.

	2010-09-10  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>

	* config/arm/neon-schedgen.ml (allCores): Add support for
	Cortex-A9.
	* config/arm/cortex-a9-neon.md: New and partially generated.
	* config/arm/cortex-a9.md (cortex_a9_dp): Adjust for Neon.

2010-09-20  Jie Zhang  <jie@codesourcery.com>

	Issue #9019

	* release-notes-csl.xml: Document.

	Backport from mainline:

	gcc/
	2010-09-20  Jie Zhang  <jie@codesourcery.com>
	* config/arm/arm.c (arm_address_offset_is_imm): New.
	(arm_early_store_addr_dep): New.
	(arm_early_load_addr_dep): New.
	* config/arm/arm-protos.h (arm_early_store_addr_dep): Declare.
	(arm_early_load_addr_dep): Declare.
	(arm_address_offset_is_imm): Declare.
	* config/arm/cortex-m4.md: New file.
	* config/arm/cortex-m4-fpu.md: New file.
	* config/arm/arm.md: Include cortex-m4.md and cortex-m4-fpu.md.
	(attr generic_sched): Exclude cortexm4.
	(attr generic_vfp): Exclude cortexm4.

2010-09-20  Jie Zhang  <jie@codesourcery.com>

	Issue #5256

	libstdc++-v3/

	Merge from WRS Linux 4.4:

	2010-05-18  Joseph Myers  <joseph@codesourcery.com>
	Issue #5256
	Issue #5834
	* config/locale/gnu/c_locale.cc,
	config/locale/gnu/monetary_members.cc,
	config/locale/gnu/numeric_members.cc,
	config/locale/gnu/time_members.cc, src/codecvt.cc, src/ctype.cc,
	src/locale-inst.cc, src/wlocale-inst.cc: Add aliases for generic
	locale symbol names.

2010-09-20  Jie Zhang  <jie@codesourcery.com>

	Issue #5256

	* release-notes-csl.xml: Document.

	libstdc++-v3/

	Backport from mainline:

	2010-05-21  Joseph Myers  <joseph@codesourcery.com>
	* acinclude.m4 (GLIBCXX_ENABLE_CLOCALE): Use GNU locale model for
	glibc 2.3 and later, but not uClibc, without an execution test.
	* configure: Regenerate.
	* doc/xml/manual/configure.xml, doc/xml/manual/prerequisites.xml,
	doc/xml/faq.xml: Update.

2010-09-18  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9534
	Issue #9535

	Backport from mainline:

	gcc/
	2010-04-07  Dodji Seketeli  <dodji@redhat.com>

	PR debug/43628
	* dwarf2out.c (modified_type_die): Ignore artificial typedefs.

	gcc/testsuite/
	2010-04-07  Dodji Seketeli  <dodji@redhat.com>

	PR debug/43628
	* g++.dg/debug/dwarf2/typedef2.C: New test.

2010-09-17  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2010-07-15  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* postreload.c (last_label_ruid, first_index_reg, last_index_reg):
	New static variables.
	(reload_combine_recognize_pattern): New static function, broken out
	of reload_combine.
	(reload_combine): Use it.  Only initialize first_index_reg and
	last_index_reg once.

	2010-07-17  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/42235
	gcc/
	* postreload.c (reload_cse_move2add): Return bool, true if anything.
	changed.  All callers changed.
	(move2add_use_add2_insn): Likewise.
	(move2add_use_add3_insn): Likewise.
	(reload_cse_regs): If reload_cse_move2add changed anything, rerun
	reload_combine.
	(RELOAD_COMBINE_MAX_USES): Bump to 16.
	(last_jump_ruid): New static variable.
	(struct reg_use): New members CONTAINING_MEM and RUID.
	(reg_state): New members ALL_OFFSETS_MATCH and REAL_STORE_RUID.
	(reload_combine_split_one_ruid, reload_combine_split_ruids,
	reload_combine_purge_insn_uses, reload_combine_closest_single_use
	reload_combine_purge_reg_uses_after_ruid,
	reload_combine_recognize_const_pattern): New static functions.
	(reload_combine_recognize_pattern): Verify that ALL_OFFSETS_MATCH
	is true for our reg and that we have available index regs.
	(reload_combine_note_use): New args RUID and CONTAINING_MEM.  All
	callers changed.  Use them to initialize fields in struct reg_use.
	(reload_combine): Initialize last_jump_ruid.  Be careful when to
	take PREV_INSN of the scanned insn.  Update REAL_STORE_RUID fields.
	Call reload_combine_recognize_const_pattern.
	(reload_combine_note_store): Update REAL_STORE_RUID field.

	gcc/testsuite/
	* gcc.target/arm/pr42235.c: New test.

	2010-07-19  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* postreload.c (reload_combine_closest_single_use): Ignore the
	number of uses for DEBUG_INSNs.
	(fixup_debug_insns): New static function.
	(reload_combine_recognize_const_pattern): Use it.  Don't let the
	main loop be affected by DEBUG_INSNs.
	Really disallow moving adds past a jump insn.
	(reload_combine_recognize_pattern): Don't update use_ruid here.
	(reload_combine_note_use): Do it here.
	(reload_combine): Use control_flow_insn_p rather than JUMP_P.

	2010-07-20  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* postreload.c (fixup_debug_insns): Remove arg REGNO.  New args
	FROM and TO.  All callers changed.  Don't look for tracked uses,
	just scan the RTL for DEBUG_INSNs and substitute.
	(reload_combine_recognize_pattern): Call fixup_debug_insns.
	(reload_combine): Ignore DEBUG_INSNs.

	2010-07-22  Bernd Schmidt  <bernds@codesourcery.com>

	PR bootstrap/44970
	PR middle-end/45009
	gcc/
	* postreload.c: Include "target.h".
	(reload_combine_closest_single_use): Don't take DEBUG_INSNs
	into account.
	(fixup_debug_insns): Don't copy the rtx.
	(reload_combine_recognize_const_pattern): DEBUG_INSNs can't have uses.
	Don't copy when replacing.  Call fixup_debug_insns in the case where
	we merged one add with another.
	(reload_combine_recognize_pattern): Fail if there aren't any uses.
	Try harder to determine whether we're picking a valid index register.
	Don't set store_ruid for an insn we're going to scan in the
	next iteration.
	(reload_combine): Remove unused code.
	(reload_combine_note_use): When updating use information for
	an old insn, ignore a use that occurs after store_ruid.
	* Makefile.in (postreload.o): Update dependencies.

	2010-07-27  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* postreload.c (reload_combine_recognize_const_pattern): Move test
	for limiting the insn movement to the right scope.

	2010-07-27  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* postreload.c (try_replace_in_use): New static function.
	(reload_combine_recognize_const_pattern): Use it here.  Allow
	substituting into a final add insn, and substituting into a memory
	reference in an insn that sets the reg.

2010-09-16  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/testsuite/
	* gcc/testsuite/gcc.dg/lto/20090210_1.c: Require tls_runtime target.

2010-09-16  Andrew Stubbs  <ams@codesourcery.com>

	* release-notes-csl.xml: Document SH4AL multilib removal.

2010-09-16  Andrew Stubbs  <ams@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-08-18  Marcus Shawcroft  <marcus.shawcroft@arm.com>
	* config/arm/arm-protos.h (arm_expand_sync): New.
	(arm_output_memory_barrier, arm_output_sync_insn): New.
	(arm_sync_loop_insns): New.
	* config/arm/arm.c (FL_ARCH7): New.
	(FL_FOR_ARCH7): Include FL_ARCH7.
	(arm_arch7): New.
	(arm_print_operand): Support %C markup.
	(arm_legitimize_sync_memory): New.
	(arm_emit, arm_insn_count, arm_count, arm_output_asm_insn): New.
	(arm_process_output_memory_barrier, arm_output_memory_barrier): New.
	(arm_ldrex_suffix, arm_output_ldrex, arm_output_strex): New.
	(arm_output_op2, arm_output_op3, arm_output_sync_loop): New.
	(arm_get_sync_operand, FETCH_SYNC_OPERAND): New.
	(arm_process_output_sync_insn, arm_output_sync_insn): New.
	(arm_sync_loop_insns,arm_call_generator, arm_expand_sync): New.
	* config/arm/arm.h (struct arm_sync_generator): New.
	(TARGET_HAVE_DMB, TARGET_HAVE_DMB_MCR): New.
	(TARGET_HAVE_MEMORY_BARRIER): New.
	(TARGET_HAVE_LDREX, TARGET_HAVE_LDREXBHD): New.
	* config/arm/arm.md: Include sync.md.
	(UNSPEC_MEMORY_BARRIER): New.
	(VUNSPEC_SYNC_COMPARE_AND_SWAP, VUNSPEC_SYNC_LOCK): New.
	(VUNSPEC_SYNC_OP):New.
	(VUNSPEC_SYNC_NEW_OP, VUNSPEC_SYNC_OLD_OP): New.
	(sync_result, sync_memory, sync_required_value): New attributes.
	(sync_new_value, sync_t1, sync_t2): Likewise.
	(sync_release_barrier, sync_op): Likewise.
	(length): Add logic to length attribute defintion to call
	arm_sync_loop_insns when appropriate.
	* config/arm/sync.md: New file.

	gcc/
	2010-09-02  Marcus Shawcroft  <marcus.shawcroft@arm.com>
	* config/arm/predicates.md (arm_sync_memory_operand): New.
	* config/arm/sync.md (arm_sync_compare_and_swapsi): Change predicate
	to arm_sync_memory_operand and constraint to Q.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_compare_and_swap<mode>): Likewise.
	(arm_sync_lock_test_and_setsi): Likewise.
	(arm_sync_lock_test_and_set<mode>): Likewise.
	(arm_sync_new_<sync_optab>si): Likewise.
	(arm_sync_new_nandsi): Likewise.
	(arm_sync_new_<sync_optab><mode>): Likewise.
	(arm_sync_new_nand<mode>): Likewise.
	(arm_sync_old_<sync_optab>si): Likewise.
	(arm_sync_old_nandsi): Likewise.
	(arm_sync_old_<sync_optab><mode>): Likewise.
	(arm_sync_old_nand<mode>): Likewise.

2010-09-16  Andrew Stubbs  <ams@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-08-25  Tejas Belagod  <tejas.belagod@arm.com>
	* config/arm/iterators.md (VU, SE, V_widen_l): New.
	(V_unpack, US): New.
	* config/arm/neon.md (vec_unpack<US>_hi_<mode>): Expansion for
	vmovl.
	(vec_unpack<US>_lo_<mode>): Likewise.
	(neon_vec_unpack<US>_hi_<mode>): Instruction pattern for vmovl.
	(neon_vec_unpack<US>_lo_<mode>): Likewise.
	(vec_widen_<US>mult_lo_<mode>): Expansion for vmull.
	(vec_widen_<US>mult_hi_<mode>): Likewise.
	(neon_vec_<US>mult_lo_<mode>"): Instruction pattern for vmull.
	(neon_vec_<US>mult_hi_<mode>"): Likewise.
	(neon_unpack<US>_<mode>): Widening move intermediate step for
	vectorizing without -mvectorize-with-neon-quad.
	(neon_vec_<US>mult_<mode>): Widening multiply intermediate step
	for vectorizing without -mvectorize-with-neon-quad.
	* config/arm/predicates.md (vect_par_constant_high): Check for
	high-half lanes of a vector.
	(vect_par_constant_low): Check for low-half lanes of a vector.

	gcc/testsuite/
	2010-08-25  Tejas Belagod  <tejas.belagod@arm.com>
	* lib/target-supports.exp (check_effective_target_vect_unpack):
	Set vect_unpack supported flag to true for neon.

2010-09-15  Chung-Lin Tang  <cltang@codesourcery.com>

	Issue #9441

	Backport from mainline:

	2010-06-25  Bernd Schmidt  <bernds@codesourcery.com>

	With large parts from Jim Wilson:
	PR target/43902

	gcc/
	* tree-pretty-print.c (dump_generic_node, op_code_prio): Add
	WIDEN_MULT_PLUS_EXPR and WIDEN_MULT_MINUS_EXPR.
	* optabs.c (optab_for_tree_code): Likewise.
	(expand_widen_pattern_expr): Likewise.
	* tree-ssa-math-opts.c (convert_mult_to_widen): New function, broken
	out of execute_optimize_widening_mul.
	(convert_plusminus_to_widen): New function.
	(execute_optimize_widening_mul): Use the two new functions.
	* expr.c (expand_expr_real_2): Add support for GIMPLE_TERNARY_RHS.
	Remove code to generate widening multiply-accumulate.  Add support
	for WIDEN_MULT_PLUS_EXPR and WIDEN_MULT_MINUS_EXPR.
	* gimple-pretty-print.c (dump_ternary_rhs): New function.
	(dump_gimple_assign): Call it when appropriate.
	* tree.def (WIDEN_MULT_PLUS_EXPR, WIDEN_MULT_MINUS_EXPR): New codes.
	* cfgexpand.c (gimple_assign_rhs_to_tree): Likewise.
	(expand_gimple_stmt_1): Likewise.
	(expand_debug_expr): Support WIDEN_MULT_PLUS_EXPR and
	WIDEN_MULT_MINUS_EXPR.
	* tree-ssa-operands.c (get_expr_operands): Likewise.
	* tree-inline.c (estimate_operator_cost): Likewise.
	* gimple.c (extract_ops_from_tree_1): Renamed from
	extract_ops_from_tree.  Add new arg for a third operand; fill it.
	(gimple_build_assign_stat): Support operations with three operands.
	(gimple_build_assign_with_ops_stat): Likewise.
	(gimple_assign_set_rhs_from_tree): Likewise.
	(gimple_assign_set_rhs_with_ops_1): Renamed from
	gimple_assign_set_rhs_with_ops.  Add new arg for a third operand.
	(get_gimple_rhs_num_ops): Support GIMPLE_TERNARY_RHS.
	(get_gimple_rhs_num_ops): Handle WIDEN_MULT_PLUS_EXPR and
	WIDEN_MULT_MINUS_EXPR.
	* gimple.h (enum gimple_rhs_class): Add GIMPLE_TERNARY_RHS.
	(extract_ops_from_tree_1): Adjust declaration.
	(gimple_assign_set_rhs_with_ops_1): Likewise.
	(gimple_build_assign_with_ops): Pass NULL for last operand.
	(gimple_build_assign_with_ops3): New macro.
	(gimple_assign_rhs3, gimple_assign_rhs3_ptr, gimple_assign_set_rhs3,
	gimple_assign_set_rhs_with_ops, extract_ops_from_tree): New inline
	functions.
	* tree-cfg.c (verify_gimple_assign_ternary): New static function.
	(verify_gimple_assign): Call it.
	* doc/gimple.texi (Manipulating operands): Document GIMPLE_TERNARY_RHS.
	(Tuple specific accessors, subsection GIMPLE_ASSIGN): Document new
	functions for dealing with three-operand statements.
	* tree.c (commutative_ternary_tree_code): New function.
	* tree.h (commutative_ternary_tree_code): Declare it.
	* tree-vrp.c (gimple_assign_nonnegative_warnv_p): Return false for
	ternary statements.
	(gimple_assign_nonzero_warnv_p): Likewise.
	* tree-ssa-sccvn.c (stmt_has_constants): Handle GIMPLE_TERNARY_RHS.
	* tree-ssa-ccp.c (get_rhs_assign_op_for_ccp): New static function.
	(ccp_fold): Use it.  Handle GIMPLE_TERNARY_RHS.
	* tree-ssa-dom.c (enum expr_kind): Add EXPR_TERNARY.
	(struct hashtable_expr): New member ternary in the union.
	(initialize_hash_element): Handle GIMPLE_TERNARY_RHS.
	(hashable_expr_equal_p): Fix indentation.  Handle EXPR_TERNARY.
	(iterative_hash_hashable_expr): Likewise.
	(print_expr_hash_elt): Handle EXPR_TERNARY.
	* gimple-fold.c (fold_gimple_assign): Handle GIMPLE_TERNARY_RHS.
	* tree-ssa-threadedge.c (fold_assignment_stmt): Remove useless break
	statements.  Handle GIMPLE_TERNARY_RHS.

	From Jim Wilson:
	gcc/testsuite/
	* gcc.target/mips/madd-9.c: New test.

	2010-06-29  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/43902
	gcc/
	* config/arm/arm.md (maddsidi4, umaddsidi4): New expanders.
	(maddhisi4): Renamed from mulhisi3addsi.  Operands renumbered.
	(maddhidi4): Likewise.

	gcc/testsuite/
	* gcc.target/arm/wmul-1.c: Test for smlabb instead of smulbb.
	* gcc.target/arm/wmul-3.c: New test.
	* gcc.target/arm/wmul-4.c: New test.

	2010-07-22  Richard Sandiford  <rdsandiford@googlemail.com>

	gcc/
	* tree-ssa-math-opts.c (is_widening_mult_rhs_p): New function.
	(is_widening_mult_p): Likewise.
	(convert_to_widen): Use them.
	(convert_plusminus_to_widen): Likewise.  Handle fixed-point types as
	well as integer ones.

	2010-07-31  Richard Sandiford  <rdsandiford@googlemail.com>

	gcc/
	* tree-ssa-math-opts.c (convert_plusminus_to_widen): Fix type
	used in the call to optab_for_tree_code.  Fix the second
	is_widening_mult_p call.  Check that both unwidened operands
	have the same sign.

2010-09-15  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-09-15  Jie Zhang  <jie@codesourcery.com>
	* config/arm/vfp.md (cmpsf_trap_vfp): Change type from
	fcmpd to fcmps.

2010-09-14  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* config/m68k/m68k.c (m68k_sched_variable_issue): Handle
	-fsched-pressure.

2010-09-13  Tom de Vries  <tom@codesourcery.com>

	* release-notes-csl.xml: Merge string copy improvement release note onto
	"Compiler optimization improvements" release note.

2010-09-13  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2010-09-12  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* config/arm/arm.md (arm_ashldi3_1bit, arm_ashrdi3_1bit,
	arm_lshrdi3_1bit): Put earlyclobber on the right alternative.

2010-09-11  Jie Zhang  <jie@codesourcery.com>

	gcc/
	* config/arm/t-cs-eabi: Remove duplicates.
	* config/arm/t-cs-eabi-lite: Likewise.
	* config/arm/t-cs-linux: Likewise.
	* config/arm/t-cs-uclinux-eabi: Likewise.
	* config/arm/t-cs-linux-lite: Likewise.

2010-09-10  Mark Mitchell  <mark@codesourcery.com>

        Issue #9394
	libstdc++-v3/
	* acinclude.m4 (GLIBCXX_WITH_CSLIBC): Define _GLIBCXX_CSLIBC in
	config.h.
	* configure: Regenerated.
	* config.h.in: Likewise.
	* libstdc++-v3/libsupc++/Makefile.am (sources): Add
	recursive_init_error.cc.
	* libsupc++/libsupc++/Makefile.in: Regenerated.
	* libsupc++/guard.cc
	(recursive_init_error::~recursive_init_error): Do not define.
	(throw_recursive_init_exception): Do not throw an excption when
	building for CSLIBC.
	* libsupc++/recursive_init_error.cc: New.

2010-09-10  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #6966

	Backport from FSF:

	gcc/
	2010-06-22  Alan Modra  <amodra@gmail.com>

	PR target/44364
	* config/rs6000/e500.h (HARD_REGNO_CALLER_SAVE_MODE): Define.
	* caller-save.c (insert_restore, insert_save): Use non-validate
	form of adjust_address.

2010-09-10  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9120

	* release-notes-csl.xml (Compiler optimization improvements): New
	bullet.

	gcc/
	* gimple.c (is_gimple_min_invariant): Check for constant INDIRECT_REFs.

2010-09-09  Catherine Moore  <clm@codesourery.com>

	gcc/
	* config/mips/xlr.md (ir_xlr_alu_clz): New insn_reservation.
	(ir_xlr_alu): Remove clz.

2010-09-09  Mark Mitchell  <mark@codesourcery.com>

	Issue #7581
	libstdc++-v3/
	* acinclude.m4 (GLIBCXX_WITH_CSLIBC): Define it.
	* configure.ac (GLIBCXX_WITH_CSLIBC): Use it.
	* configure: Regenerated.
	* libsupcc+/Makefile.am (sources): Do not add pure.cc if building
	for CSLIBC.
	* libsupc++/Makefile.in: Regenerated.

2010-09-08  Julian Brown  <julian@codesourcery.com>

	libstdc++-v3/
	* python/Makefile.am (install-data-local): Only define rule if
	GLIBCXX_HOSTED.
	* python/Makefile.in: Regenerate.

2010-09-08  Tom de Vries  <tom@codesourcery.com>

	gcc/
	* gcc/emit-rtl.c (set_mem_attributes_minus_bitpos): Set MEM_READONLY_P
	for static const strings.
	* gcc/testsuite/gcc.dg/memcpy-3.c: New test.

2010-09-07  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml: Fix typo.

2010-09-06  Mark Mitchell  <mark@codesourcery.com>

	* release-notes-csl.xml: Limit TARGET to arm*-* for previous note.

	Issue #9022
	* release-notes-csl.xml: Document.

	Backport from mainline:
	2010-09-05  Mark Mitchell  <mark@codesourcery.com>
	* doc/invoke.texi: Document -Wdouble-promotion.
	* c-typeck.c (convert_arguments): Check for implicit conversions
	from float to double.
	(do_warn_double_promotion): New function.
	(build_conditional_expr): Use it.
	(build_binary_op): Likewise.
	* c.opt (Wdouble-promotion): New.
	2010-09-05  Mark Mitchell  <mark@codesourcery.com>
	* gcc.dg/Wdouble-promotion.c: New.
	2010-09-06  Mark Mitchell  <mark@codesourcery.com>
	gcc/
	* c-common.h (do_warn_double_promotion): Declare.
	* c-common.c (do_warn_double_promotion): Define.
	* c-typeck.c (do_warn_double_promotion): Remove.
	* doc/invoke.texi (-Wdouble-promotion): Note available for C++ and
	Objective-C++ too.
	gcc/cp/
	* typeck.c (cp_build_binary_op): Call do_warn_double_promotion.
	* call.c (build_conditional_expr): Likewise.
	(convert_arg_to_ellipsis): Likewise.
	gcc/testsuite/
	* g++.dg/warn/Wdouble-promotion.C: New.

2010-09-03  Kazu Hirata  <kazu@codesourcery.com>

	Issue #8579
	libiberty/
	* pex-win32.c (pex_win32_exec_child): Move calls to _close() to
	the end of the function.

2010-09-01  Tom de Vries  <tom@codesourcery.com>

	Issue #9098
	gcc/
	* config/mips/netlogic.h: Set -funwind-tables by default.
	* config/mips/t-netlogic: Set -fno-unwind-tables for CRTSTUFF.

2010-09-01  Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* config/sh/sh.h (SH_ASM_SPEC): Add spaces between options.

2010-08-31  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/mips.h (BASE_DRIVER_SELF_SPECS): Remove extraneous line.

2010-08-31  Chung-Lin Tang  <cltang@codesourcery.com>

	Backport from mainline:

	2010-04-14  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/21803
	gcc/
	* ifcvt.c (cond_exec_process_if_block): Look for identical sequences
	at the start and end of the then/else blocks, and omit them from the
	conversion.
	* cfgcleanup.c (flow_find_cross_jump): No longer static.  Remove MODE
	argument; all callers changed.  Pass zero to old_insns_match_p instead.
	(flow_find_head_matching_sequence): New function.
	(old_insns_match_p): Check REG_EH_REGION notes for calls.
	* basic-block.h (flow_find_cross_jump,
	flow_find_head_matching_sequence): Declare functions.

	gcc/testsuite/
	* gcc.target/arm/pr42496.c: New test.

	2010-04-22  Bernd Schmidt  <bernds@codesourcery.com>

	PR middle-end/29274
	gcc/
	* tree-pass.h (pass_optimize_widening_mul): Declare.
	* tree-ssa-math-opts.c (execute_optimize_widening_mul,
	gate_optimize_widening_mul): New static functions.
	(pass_optimize_widening_mul): New.
	* expr.c (expand_expr_real_2) <case WIDEN_MULT_EXPR>: New case.
	<case MULT_EXPR>: Remove support for widening multiplies.
	* tree.def (WIDEN_MULT_EXPR): Tweak comment.
	* cfgexpand.c (expand_debug_expr) <case WIDEN_MULT_EXPR>: Use
	simplify_gen_unary rather than directly building extensions.
	* tree-cfg.c (verify_gimple_assign_binary): Add tests for
	WIDEN_MULT_EXPR.
	* expmed.c (expand_widening_mult): New function.
	* passes.c (init_optimization_passes): Add pass_optimize_widening_mul.
	* optabs.h (expand_widening_mult): Declare.

	gcc/testsuite/
	* gcc.target/i386/wmul-1.c: New test.
	* gcc.target/i386/wmul-2.c: New test.
	* gcc.target/bfin/wmul-1.c: New test.
	* gcc.target/bfin/wmul-2.c: New test.	
	* gcc.target/arm/wmul-1.c: New test.
	* gcc.target/arm/wmul-2.c: New test.

	2010-04-24  Bernd Schmidt  <bernds@codesourcery.com>

	PR tree-optimization/41442
	gcc/
	* fold-const.c (merge_truthop_with_opposite_arm): New function.
	(fold_binary_loc): Call it.

	gcc/testsuite/
	* gcc.target/i386/pr41442.c: New test.

	2010-04-29  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/42895
	gcc/
	* doc/tm.texi (ADJUST_REG_ALLOC_ORDER): Renamed from
	ORDER_REGS_FOR_LOCAL_ALLOC.  All instances of this macro changed.
	(HONOR_REG_ALLOC_ORDER): Describe new macro.
	* ira.c (setup_alloc_regs): Use ADJUST_REG_ALLOC_ORDER if defined.
	* ira-color.c (assign_hard_reg): Take prologue/epilogue costs into
	account only if HONOR_REG_ALLOC_ORDER is not defined.
	* config/arm/arm.h (HONOR_REG_ALLOC_ORDER): Define.
	* system.h (ORDER_REGS_FOR_LOCAL_ALLOC): Poison.

	2010-05-04  Mikael Pettersson  <mikpe@it.uu.se>

	PR bootstrap/43964
	gcc/
	* ira-color.c (assign_hard_reg): Declare rclass and add_cost
	only if HONOR_REG_ALLOC_ORDER is not defined.

	2010-06-04  Bernd Schmidt  <bernds@codesourcery.com>

	PR rtl-optimization/39871
	PR rtl-optimization/40615
	PR rtl-optimization/42500
	PR rtl-optimization/42502
	gcc/
	* ira.c (init_reg_equiv_memory_loc: New function.
	(ira): Call it twice.
	* reload.h (calculate_elim_costs_all_insns): Declare.
	* ira-costs.c: Include "reload.h".
	(regno_equiv_gains): New static variable.
	(init_costs): Allocate it.
	(finish_costs): Free it.
	(ira_costs): Call calculate_elim_costs_all_insns.
	(find_costs_and_classes): Take estimated elimination costs
	into account.
	(ira_adjust_equiv_reg_cost): New function.
	* ira.h (ira_adjust_equiv_reg_cost): Declare it.
	* reload1.c (init_eliminable_invariants, free_reg_equiv,
	elimination_costs_in_insn, note_reg_elim_costly): New static functions.
	(elim_bb): New static variable.
	(reload): Move code out of here into init_eliminable_invariants and
	free_reg_equiv.  Call them.
	(calculate_elim_costs_all_insns): New function.
	(eliminate_regs_1): Declare.  Add extra arg FOR_COSTS;
	all callers changed.  If FOR_COSTS is true, don't call alter_reg,
	but call note_reg_elim_costly if we turned a valid memory address
	into an invalid one.
	* Makefile.in (ira-costs.o): Depend on reload.h.

	gcc/testsuite/
	* gcc.target/arm/eliminate.c: New test.

	2010-06-09  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* config/arm/arm.c (thumb2_reorg): New function.
	(arm_reorg): Call it.
	* config/arm/thumb2.md (define_peephole2 for flag clobbering
	arithmetic operations): Delete.

	2010-06-12  Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* config/arm/arm.c (thumb2_reorg): Fix errors in previous change.

	2010-06-17  Bernd Schmidt  <bernds@codesourcery.com>

	PR rtl-optimization/39871
	gcc/
	* reload1.c (init_eliminable_invariants): For flag_pic, disable
	equivalences only for constants that aren't LEGITIMATE_PIC_OPERAND_P.
	(function_invariant_p): Rule out a plus of frame or arg pointer with
	a SYMBOL_REF.
	* ira.c (find_reg_equiv_invariant_const): Likewise.

	2010-06-18  Eric Botcazou  <ebotcazou@adacore.com>

	PR rtl-optimization/40900
	gcc/
	* expr.c (expand_expr_real_1) <SSA_NAME>: Fix long line.  Save the
	original expression for later reuse.
	<expand_decl_rtl>: Use promote_function_mode to compute the signedness
	of the promoted RTL for a SSA_NAME on the LHS of a call statement.

	2010-06-18  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/testsuite/
	* gcc.target/arm/pr40900.c: New test.

	2010-06-30  Bernd Schmidt  <bernds@codesourcery.com>

	PR tree-optimization/39799
	gcc/
	* tree-inline.c (remap_ssa_name): Initialize variable only if
	SSA_NAME_OCCURS_IN_ABNORMAL_PHI.
	* tree-ssa.c (warn_uninit): Avoid emitting an unnecessary message.

	gcc/testsuite/
	* c-c++-common/uninit-17.c: New test.

	2010-07-25  Eric Botcazou  <ebotcazou@adacore.com>

	PR target/44484
	gcc/
	* config/sparc/predicates.md (memory_reg_operand): Delete.
	* config/sparc/sync.md (sync_compare_and_swap): Minor tweaks.
	(*sync_compare_and_swap): Encode the address form in the pattern.
	(*sync_compare_and_swapdi_v8plus): Likewise.

2010-08-31  Andrew Stubbs  <ams@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-04-13  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* regmove.c (fixup_match_2): Swap incorrect uses of src and dst.

2010-08-31  Catherine Moore  <clm@codesourcery.com>

	Issue #9142
	Backport from mainline:

	2010-08-31  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/mips.h (BASE_DRIVER_SELF_SPECS):
	Infer -mdspr2 for the the 74K.

2010-08-29  Chung-Lin Tang  <cltang@codesourcery.com>

	* release-notes-csl.xml: Document.

	Backport from mainline:

	2010-04-16  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/41514
	gcc/
	* config/arm/arm.md (cbranchsi4_insn): Renamed from "*cbranchsi4_insn".
	If the previous insn is a cbranchsi4_insn with the same arguments,
	omit the compare instruction.

	gcc/testsuite/
	* gcc.target/arm/thumb-comparisons.c: New test.

	gcc/
	* config/arm/arm.md (addsi3_cbranch): If destination is a high
	register, inputs must be low registers and we need a low register
	scratch.  Handle alternative 2 like alternative 3.

	PR target/40603
	gcc/
	* config/arm/arm.md (cbranchqi4): New pattern.
	* config/arm/predicates.md (const0_operand,
	cbranchqi4_comparison_operator): New predicates.

	gcc/testsuite/
	* gcc.target/arm/thumb-cbranchqi.c: New test.

	2010-04-27  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/40657
	gcc/
	* config/arm/arm.c (thumb1_extra_regs_pushed): New function.
	(thumb1_expand_prologue, thumb1_output_function_prologue): Call it
	here to determine which regs to push and how much stack to reserve.

	gcc/testsuite/
	* gcc.target/arm/thumb-stackframe.c: New test.

	2010-07-02  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/42835
	gcc/
	* config/arm/arm-modes.def (CC_NOTB): New mode.
	* config/arm/arm.c (get_arm_condition_code): Handle it.
	* config/arm/thumb2.md (thumb2_compare_scc): Delete pattern.
	* config/arm/arm.md (subsi3_compare0_c): New pattern.
	(compare_scc): Now a define_and_split.  Add a number of extra
	splitters before it.

	gcc/testsuite/
	* gcc.target/arm/pr42835.c: New test.

	PR target/42172
	gcc/
	* config/arm/arm.c (thumb1_rtx_costs): Improve support for SIGN_EXTEND
	and ZERO_EXTEND.
	(arm_rtx_costs_1): Likewise.
	(arm_size_rtx_costs): Use arm_rtx_costs_1 for these codes.
	* config/arm/arm.md (is_arch6): New attribute.
	(zero_extendhisi2, zero_extendqisi2, extendhisi2,
	extendqisi2): Tighten the code somewhat, avoiding invalid
	RTL to occur in the expander patterns.
	(thumb1_zero_extendhisi2): Merge with thumb1_zero_extendhisi2_v6.
	(thumb1_zero_extendhisi2_v6): Delete.
	(thumb1_extendhisi2): Merge with thumb1_extendhisi2_v6.
	(thumb1_extendhisi2_v6): Delete.
	(thumb1_extendqisi2): Merge with thumb1_extendhisi2_v6.
	(thumb1_extendqisi2_v6): Delete.
	(zero_extendhisi2 for register input splitter): New.
	(zero_extendqisi2 for register input splitter): New.
	(thumb1_extendhisi2 for register input splitter): New.
	(extendhisi2 for register input splitter): New.
	(extendqisi2 for register input splitter): New.
	(TARGET_THUMB1 extendqisi2 for memory input splitter): New.
	(arm_zero_extendhisi2): Allow nonimmediate_operand for operand 1,
	and add support for a register alternative requiring a split.
	(thumb1_zero_extendqisi2): Likewise.
	(arm_zero_extendqisi2): Likewise.
	(arm_extendhisi2): Likewise.
	(arm_extendqisi2): Likewise.

	gcc/testsuite/
	* gcc.target/arm/pr42172-1.c: New test.

	2010-07-05  Bernd Schmidt  <bernds@codesourcery.com>

	* config/arm/arm.c (get_arm_condition_code): Remove CC_NOTBmode case.
	* arm-modes.def (CC_NOTB): Don't define.
	* config/arm/arm.md (arm_adddi3): Generate canonical RTL.
	(adddi_sesidi_di, adddi_zesidi_di): Likewise.
	(LTUGEU): New code_iterator.
	(cnb, optab): New corresponding code_attrs.
	(addsi3_carryin_<optab>): Renamed from addsi3_carryin.  Change pattern
	to canonical form.  Operands 1 and 2 are commutative.  Parametrize
	using LTUGEU.
	(addsi3_carryin_shift_<optab>): Likewise.
	(addsi3_carryin_alt2_<optab>): Renamed from addsi3_carryin_alt2.
	Operands 1 and 2 are commutative.  Parametrize using LTUGEU.
	(addsi3_carryin_alt1, addsi3_carryin_alt3): Remove.
	(subsi3_compare): Renamed from subsi3_compare0_c.  Change CC_NOTB to
	CC.
	(arm_subsi3_insn): Allow constants for operand 0.
	(compare_scc peephole for eq case): New.
	(compare_scc splitters): Change CC_NOTB to CC.

	2010-07-09  Bernd Schmidt  <bernds@codesourcery.com>

	PR target/40657
	gcc/
	* config/arm/arm.c (thumb1_extra_regs_pushed): New arg FOR_PROLOGUE.
	All callers changed.
	Handle the case when we're called for the epilogue.
	(thumb_unexpanded_epilogue): Use it.
	(thumb1_expand_epilogue): Likewise.

	gcc/testsuite/
	* gcc.target/arm/pr40657-1.c: New test.
	* gcc.target/arm/pr40657-2.c: New test.
	* gcc.c-torture/execute/pr40657.c: New test.

	gcc/
	* config/arm/arm.md (addsi3_cbranch): Switch alternatives 0 and 1.

	* config/arm/arm.md (Thumb-1 ldrsb peephole): New.

	* config/arm/arm.md (cbranchqi4): Fix array size.
	(addsi3_cbranch): Also andle alternative 2 like alternative 3 when
	calculating length.

2010-08-27  Andrew Stubbs  <ams@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-10-21  Joseph Myers  <joseph@codesourcery.com>

	Issue #6815

	gcc/
	* config/sh/uclinux.h (SUBTARGET_OVERRIDE_OPTIONS): Define.

2010-08-27  Andrew Stubbs  <ams@codesourcery.com>

	Backport of patch posted here:
	http://gcc.gnu.org/ml/gcc-patches/2010-08/msg01464.html

	2010-08-19  Daniel Jacobowitz  <dan@codesourcery.com>
	    Joseph Myers  <joseph@codesourcery.com>
	    Mark Shinwell  <shinwell@codesourcery.com>
	    Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* config.gcc: Handle sh-*-uclinux* | sh[12]-*-uclinux*.
	Handle --enable-fdpic.
	* config/sh/constraints.md: Add Ccl constraint.
	* config/sh/lib1funcs.asm (set_fpscr): Handle FDPIC.
	* config/sh/predicates.md (pseudo_register_operand): New.
	* config/sh/sh-protos.h (sh_load_function_descriptor,
	sh_legitimate_constant_p, sh_our_fdpic_reg): Declare.
	(function_symbol): Update prototype.
	* config/sh/sh.c (sh_assemble_integer, sh_cannot_force_const_mem_p,
	sh_delegitimize_address, sh_reloc_rw_mask,
	sh_legitimate_constant_p, sh_cannot_force_const_mem_p,
	sh_load_function_descriptor, sh_our_fdpic_reg, sh_reloc_rw_mask): New.
	(TARGET_ASM_INTEGER, TARGET_DELEGITIMIZE_ADDRESS,
	TARGET_CANNOT_FORCE_CONST_MEM, TARGET_ASM_RELOC_RW_MASK): Define.
	(sh_override_options, expand_block_move, prepare_move_operands,
	sh_cannot_copy_insn_p, expand_ashiftrt, sh_expand_prologue,
	nonpic_symbol_mentioned_p, legitimize_pic_address,
	sh_trampoline_init, sh_output_mi_thunk, function_symbol):
	Support FDPIC.
	* config/sh/sh.h (TARGET_CPU_CPP_BUILTINS): Add __SH_FDPIC__
	and __FDPIC__.
	(CONDITIONAL_REGISTER_USAGE, TRAMPOLINE_SIZE,
	OUTPUT_ADDR_CONST_EXTRA, ASM_PREFERRED_EH_DATA_FORMAT,
	ASM_MAYBE_OUTPUT_ENCODED_ADDR_RTX): Support FDPIC.
	(DRIVER_SELF_SPECS): Insert SUBTARGET_DRIVER_SELF_SPECS.
	(SUBTARGET_DRIVER_SELF_SPECS, PIC_OFFSET_TABLE_REG_CALL_CLOBBERED,
	OUR_FDPIC_REG, SH_OFFSETS_MUST_BE_WITHIN_SECTIONS_P,
	CRT_GET_RFIB_DATA): Define.
	(LEGITIMATE_CONSTANT_P): Use sh_legitimate_constant_p.
	* config/sh/sh.md (R12_REG, UNSPEC_GOTFUNCDESC,
	UNSPEC_GOTOFFFUNCDESC, sym2GOTFUNCDESC, symGOTFUNCDESC2reg,
	sym2GOTOFFFUNCDESC, symGOTOFFFUNCDESC2reg): Define.
	(udivsi3_i1, udivsi3_i4, udivsi3_i4_single, udivsi3,
	divsi_inv_call_combine, divsi3_i4_media, divsi3_i4,
	divsi3_i4_single, divsi3, mulsi3, ashrsi3_n, ic_invalidate_line,
	initialize_trampoline, calli, call_valuei, call, call_pop,
	call_value, sibcalli, sibcall_pcrel, sibcall, sibcall_valuei,
	sibcall_valuei_pcrel, sibcall_value_pcrel, sibcall_value,
	call_value_pop, GOTaddr2picreg, symGOT_load, symGOTOFF2reg,
	shcompact_return_tramp, block_move_real, block_lump_real,
	block_move_real_i4, block_lump_real_i4): Support FDPIC, and
	update calls to functions with new parameters.
	(calli_fdpic, call_valuei_fdpic, sibcalli_fdpic,
	sibcalli_pcrel_fdpic, sibcall_pcrel_fdpic, sibcall_valuei_fdpic,
	sibcall_valuei_pcrel_fdpic, sibcall_value_pcrel_fdpic,
	use_initial_val, sym2GOTFUNCDESC, symGOTFUNCDESC2reg,
	sym2GOTOFFFUNCDESC, symGOTOFFFUNCDESC2reg): New.
	* config/sh/sh.opt (-mfdpic): New option.
	* config/sh/t-uclinux: New file.
	* config/sh/uclinux.h: New file.
	* doc/install.texi (Options specification): Add --enable-fdpic.
	* doc/invoke.texi (SH Options): Add -mfdpic.
	* longlong.h (udiv_qrnnd): Add FDPIC compatible version.

	gcc/testsuite/
	* gcc.target/sh/sh-relax.c: Add xfail for sh*-*-uclinux.

	libgcc/
	* libgcc/config.host: Handle sh-*-uclinux* and
	sh[2346lbe]*-*-uclinux*.

2010-08-27  Andrew Stubbs  <ams@codesourcery.com>

	Backport from mainline:

	2010-08-20  Joseph Myers  <joseph@codesourcery.com>
	gcc/
	* doc/tm.texi.in (PIC_OFFSET_TABLE_REG_CALL_CLOBBERED): Document to
	be zero or nonzero.
	* doc/tm.texi: Regenerate.
	* defaults.h (PIC_OFFSET_TABLE_REG_CALL_CLOBBERED): Define.
	* df-scan.c (df_get_exit_block_use_set), reginfo.c
	(init_reg_sets_1), rtlanal.c (rtx_unstable_p, rtx_varies_p):
	Handle new PIC_OFFSET_TABLE_REG_CALL_CLOBBERED semantics.
	* config/ia64/ia64.h (PIC_OFFSET_TABLE_REG_CALL_CLOBBERED): Define
	to 1.

2010-08-27  Andrew Stubbs  <ams@codesourcery.com>

	Backport of patch posted here:
	http://gcc.gnu.org/ml/gcc-patches/2010-08/msg01462.html

	2010-08-19  Bernd Schmidt  <bernds@codesourcery.com>
	gcc/
	* Makefile.in: (mode-switching.o): Depend on integrate.h.
	* doc/md.texi (Standard Pattern Names For Generation):
	Document use_initial_val.
	* integrate.c (initial_value_pair): Add new member "initialized".
	(get_hard_reg_initial_val): Set initialized.
	(emit_initial_value_sets): Emit result of gen_use_initial_val.
	* mode-switching.c: Include integrate.h.
	(rest_of_handle_mode_switching): Call emit_initial_value_sets.

2010-08-27  Andrew Stubbs  <ams@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-07-09  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* config.gcc (sh*-*-*): Remove cs-sgxxlite-linux.opt.
	* config/sh/cs-sgxxlite-linux.h (SUBTARGET_OVERRIDE_OPTIONS): Use
	linux_uclibc instead of build_for_uclibc.
	* config/sh/cs-sgxxlite-linux.opt: Delete file.

	2009-06-16  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* config.gcc (sh*-*-*): Add sh/cs-sgxxlite-linux.opt when
	--enable-extra-sgxxlite-multilibs.
	* config/sh/cs-sgxxlite-linux.h: Define SUBTARGET_OVERRIDE_OPTIONS.
	* config/sh/cs-sgxxlite-linux.opt: New file.

2010-08-27  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config/arm/thumb2.md (thumb_andsi_not_shiftsi_si,
	thumb2_notsi_shiftsi, thumb2_notsi_shiftsi_compare0,
	thumb2_not_shiftsi_compare0_scratch, thumb2_cmpsi_shiftsi,
	thumb2_cmpsi_shiftsi_swp, thumb2_cmpsi_neg_shiftsi,
	thumb2_arith_shiftsi, thumb2_arith_shiftsi_compare0,
	thumb2_arith_shiftsi_compare0_scratch, thumb2_sub_shiftsi,
	thumb2_sub_shiftsi_compare0, thumb2_sub_shiftsi_compare0_scratch):
	Use const_shift_count predicate for "M" constraints.
	* config/arm/predicates.md (const_shift_operand): Remove.
	(const_shift_count): New.

	gcc/testsuite/
	* gcc.dg/long-long-shift-1.c: New test.

2010-08-26  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.3/4.4:
	Issue #1510
	2007-04-27  Paul Brook  <paul@codesourcery.com>
	gcc/
	* cse.c (cse_process_notes): Make sure PLUS are canonical.

2010-08-26  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.3/4.4:
	2007-03-30  Paul Brook  <paul@codesourcery.com>
	gcc/
	* calls.c (store_one_arg): Check alignment of mode used for save.

2010-08-26  Maciej Rozycki  <macro@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-02-17  Andrew Jenner  <andrew@codesourcery.com>
	            Maciej Rozycki  <macro@codesourcery.com>

	gcc/
	* unwind.inc (_Unwind_RaiseException): Use return value of
	uw_init_context.
	* unwind-dw2.c (uw_init_context): Make macro an expression instead of
	a statement.
	(uw_init_context_1): Add return value.
	* unwind-sjlj.c (uw_init_context): Add return value.

2010-08-25  Andrew Stubbs  <ams@codesourcery.com>

	Backport from FSF:

	2010-08-25  Julian Brown  <julian@codesourcery.com>

	* config/arm/arm.c (arm_issue_rate): Return 2 for Cortex-A5.
	* config/arm/arm.md (generic_sched): No for Cortex-A5.
	(generic_vfp): Likewise.
	(cortex-a5.md): Include.
	* config/arm/cortex-a5.md: New.

2010-08-25  Jie Zhang  <jie@codesourcery.com>

	Issue #9156

	* release-notes-csl.xml: Document.

	gcc/
	* tree-ssa-loop-promote.c (insert_along_edge): Use
	gimple_stmt_iterator to add statement to basic block.

	gcc/testsuite/
	* gcc.dg/promote-short-13.c: New test.

2010-08-24  Andrew Stubbs  <ams@codesourcery.com>

	Backport from FSF:

	2010-08-07  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>

	* config/arm/cortex-a9.md: Rewrite VFP Pipeline description.
	* config/arm/arm.c (arm_xscale_tune): Initialize sched_adjust_cost.
	 (arm_fastmul_tune,arm_slowmul_tune, arm_9e_tune): Likewise.
	 (arm_adjust_cost): Split into xscale_sched_adjust_cost and a
	 generic part.
	 (cortex_a9_sched_adjust_cost): New function.
	 (xscale_sched_adjust_cost): New function.
	* config/arm/arm-protos.h (struct tune_params): New field
	sched_adjust_cost.
	* config/arm/arm-cores.def: Adjust costs for cortex-a9.

	2010-04-17  Richard Earnshaw  <rearnsha@arm.com>

	* arm-protos.h (tune_params): New structure.
	* arm.c (current_tune): New variable.
	(arm_constant_limit): Delete.
	(struct processors): Add pointer to the tune parameters.
	(arm_slowmul_tune): New tuning option.
	(arm_fastmul_tune, arm_xscale_tune, arm_9e_tune): Likewise.
	(all_cores): Adjust to pick up the tuning model.
	(arm_constant_limit): New function.
	(arm_override_options): Select the appropriate tuning model.  Delete
	initialization of arm_const_limit.
	(arm_split_constant): Use the new constant-limit model.
	(arm_rtx_costs): Pick up the current tuning model.
	* arm.md (is_strongarm, is_xscale): Delete.
	* arm-generic.md (load_ldsched_x, load_ldsched): Test explicitly
	for Xscale variant architectures.
	(mult_ldsched_strongarm, mult_ldsched): Similarly for StrongARM.

2010-08-24  Andrew Stubbs  <ams@codesourcery.com>

	Backport from FSF:

	2010-08-07  Marcus Shawcroft  <marcus.shawcroft@arm.com>

	gcc/
	* config/arm/linux-atomic.c (SUBWORD_VAL_CAS): Instantiate with
	'unsigned short' and 'unsigned char' instead of 'short' and 'char'.
	(SUBWORD_BOOL_CAS): Likewise.
	(SUBWORD_SYNC_OP): Likewise.
	(SUBWORD_TEST_AND_SET): Likewise.
	(FETCH_AND_OP_WORD): Parenthesise INF_OP
	(SUBWORD_SYNC_OP): Likewise.
	(OP_AND_FETCH_WORD): Likewise.

	gcc/testsuite/
	* lib/target-supports.exp: (check_effective_target_sync_int_long):
	Add arm*-*-linux-gnueabi.
	(check_effective_target_sync_char_short): Likewise.

2010-08-24  Joseph Myers  <joseph@codesourcery.com>

	Issue #9270

	Revert:

	2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	2008-05-01  Carlos O'Donell  <carlos@codesourcery.com>

	* Makefile.tpl (install): Call install-html and install-pdf.
	* Makefile.in: Regenerate.
	
	gcc/
	* Makefile.in (install): Depend on install-html and install-pdf.

2010-08-24  Andrew Stubbs  <ams@codesourcery.com>

	* release-notes-csl.xml: Document.

	Backport from mainline:
	2010-07-31  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>

	gcc/cp/
	PR c++/45112
	* decl.c (duplicate_decls): Merge DECL_USER_ALIGN and DECL_PACKED.

	gcc/testsuite/
	PR c++/45112
	* testsuite/g++.dg/pr45112.C: New test.

2010-08-23  Kazu Hirata  <kazu@codesourcery.com>

	Issue #9265
	* release-notes-csl.xml: Document the bug fix above.

	Backport from mainline:

	gcc/
	2010-08-06  Eric Botcazou  <ebotcazou@adacore.com>
	PR target/44942
	* config/sparc/sparc.c (function_arg_advance): Always take into account
	the padding, if any.

2010-08-23  Nathan Sidwell  <nathan@codesourcery.com>

	Merged from Sourcery g++ 4.4:

	2010-05-18  Paul Brook  <paul@codesourcery.com>

	Issue #8426 - Fix libsupc++ symbol visibility
	gcc/
	* config/arm/eabi-memset.c (__aeabi_memset): Remove bogus return value.

	libstdc++-v3/
	* libsupc++/eh_arm.cc (__cxa_type_match): Use correct namespace.
	(__cxa_begin_cleanup): Ditto.
	* libsupc++/unwind-cxx.h (__cxa_call_unexpected, __cxa_call_terminate,
	__cxa_type_match, __cxa_begin_cleanup): Use correct types on ARM EABI.
	* libsupc++/cxxabi.h: Add prototypes for __aeabi routines.
	* libsupc++/eh_personality.cc (PERSONALITY_FUNCTION): Export with
	default visibility.
	* libsupc++/eh_call.cc (__cxa_call_terminate, __cxa_call_unexpected):
	Use correct namespace and types.

	* release-notes-csl.xml: New note.

2010-08-20  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Compiler optimization improvements):
	New note to cover Google patch backports and similar hacks.

2010-08-20  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-08-20  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml: Change -mcpu to -march in the
	last release note.

2010-08-20  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-08-20  Catherine Moore  <clm@codesourcery.com>

	Issue #9258

	gcc/
	* config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Add 34kn.
	* config/mips/mips.c (mips_cpu_info): Likewise.
	* config/mips/mips.h (MIPS_ARCH_FLOAT_SPEC): Likewise.
	(BASE_DRIVER_SELF_SPECS): Do not imply -mdsp for the 34kn.

	* release-notes-csl.xml: New note.

2010-08-20  Nathan Sidwell  <nathan@codesourcery.com>

	Merged from Sourcery g++ 4.4:

	2010-06-04  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8426 - build dlls.

	* libtool.m4 (symbian*): Add support for building shared libs.

	gcc/
	* configure: Rebuilt.
	* config.gcc (arm*-*-symbianelf*): Add shared-lib make file
	fragments.
	* config/t-slibgcc-symbian: New.

	libstdc++-v3/
	* configure: Rebuilt.

2010-08-20  Jie Zhang  <jie@codesourcery.com>

	Merged from Sourcery G++ 4.4:

	gcc/
	2009-05-29  Julian Brown  <julian@codesourcery.com>
	Merged from Sourcery G++ 4.3:
	* config/arm/arm.md (movsi): Don't split symbol refs here.
	(define_split): New.

2010-08-19  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/rs6000.c
	(rs6000_override_options) [processor_target_table]: Fix thinko.

2010-08-19  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* tree-ssa-remove-local-statics.c (maybe_discover_new_declaration):
	Fix thinko.

2010-08-17 Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/netlogic.h (SUBTARGET_CC1_SPEC): New.

2010-08-18  Nathan Froyd  <froydnj@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-08-13  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9064

	gcc/
	* tree-ssa-remove-local-statics.c (maybe_discover_new_declaration):
	Check for the static being defined in the same function as the one
	we're optimizing.

	gcc/testsuite/
	* gcc.dg/remove-local-statics-18.c: New test.

2010-08-18  Nathan Froyd  <froydnj@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-06-14  Nathan Froyd  <froydnj@codesourcery.com>

	NOT ASSIGNED TO THE FSF
	COPYRIGHT FREESCALE

	gcc/
	* config/rs6000/rs6000.mc (floatdidf2): Use for PROCESSOR_PPCE500MC64.
	(fix_truncdfdi2): Likewise.

	2010-06-14  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/rs6000.c
	(rs6000_override_options) [processor_target_table]: Add e5500 entry.

	2010-06-14  Nathan Froyd  <froydnj@codesourcery.com>

	NOT ASSIGNED TO THE FSF
	COPYRIGHT FREESCALE

	gcc/
	* config/rs6000/rs6000.c (expand_block_clear): Permit non-word-aligned
	stores for PROCESSOR_PPCE500MC64.
	(expand_block_move): Likewise.

2010-08-18  Julian Brown  <julian@codesourcery.com>

	Issue #9222

	gcc/
	* config/arm/neon.md (UNSPEC_VCLE, UNSPEC_VCLT): New constants for
	unspecs.
	(vcond<mode>, vcondu<mode>): New expanders.
	(neon_vceq<mode>, neon_vcge<mode>, neon_vcgt<mode>): Support
	comparisons with zero.
	(neon_vcle<mode>, neon_vclt<mode>): New patterns.
	* config/arm/constraints.md (Dz): New constraint.

2010-08-18  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/testsuite/
	2010-08-18  Jie Zhang  <jie@codesourcery.com>
	* gcc.dg/builtin-apply2.c (STACK_ARGUMENTS_SIZE): Define to
	20 if __ARM_PCS is defined otherwise 64.
	(bar): Use STACK_ARGUMENTS_SIZE for the third argument
	instead of hard coded 64.

2010-08-18  Chung-Lin Tang  <cltang@codesourcery.com>

	* release-notes-csl.xml: Document.

	Backport from mainline:

	2010-07-28  Chung-Lin Tang  <cltang@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_pcs_default): Remove static.
	* config/arm/arm.h (TARGET_CPU_CPP_BUILTINS): Define __ARM_PCS or
	__ARM_PCS_VFP to indicate soft/hard-float calling convention.
	(arm_pcs_default): Declare.

2010-08-18  Yao Qi  <yao@codesourcery.com>

	Merged from linaro gcc 4.5:

	2010-08-06  Yao Qi  <yao@codesourcery.com>

	LP: #612011
	gcc/ 
	* config/arm/arm.c (output_move_double): Fix typo generating 
	instructions ('ldr'->'str').
	
	gcc/testsuite/
	* gcc.target/arm/pr45094.c: New test.

2010-08-17 Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/mips.c (mips_cpu_info): Set tune_flags for
	the XLR processor to PTF_AVOID_BRANCH_LIKELY.

2010-08-13  Andrew Jenner  <andrew@codesourcery.com>

	Merge from Sourcery G++ 4.4 / MontaVista Sourcery G++ 4.4:

        2009-02-04  Andrew Jenner  <andrew@codesourcery.com>

        gcc/
        * config.gcc: Handle arm-montavista-linux-gnueabi,
        mips-montavista-linux-gnu, mips64octeon*-montavista-elf* and
        powerpc-montavista-linux-gnu.
        * config/rs6000/t-montavista-linux: New file.
        * config/rs6000/montavista-linux.h: New file.
        * config/arm/t-montavista-linux: New file.
        * config/arm/montavista-linux.h: New file.
        * config/mips/t-montavista-linux: New file.
        * config/mips/t-montavista-elf: New file.
        * config/mips/montavista-linux.h: New file.

        libgcc/
        * config.host: Handle mips64octeon-montavista-elf*.

        2009-03-30  Andrew Jenner  <andrew@codesourcery.com>

        gcc/
        * config.gcc: Accept montavista*-, not just montavista-.
        * config/mips/t-montavista-linux: Add Octeon multilibs.

        2009-11-23  Andrew Jenner  <andrew@codesourcery.com>

        gcc/
        * config.gcc: Add rs6000/e500.h to powerpc-montavista*-linux-gnu
        tm_file.
        * config/mips/montavista-linux.h: Use DRIVER_SELF_SPECS instead of
        SUBTARGET_SELF_SPECS.

	2010-06-22  Andrew Jenner  <andrew@codesourcery.com>

	gcc/
	* config/arm/t-montavista-linux (MULTILIB_OPTIONS): Add thard-float.
	(MULTILIB_DIRNAMES): Likewise.
	* config/arm/montavista-linux.h (CC1_SPEC): Likewise.
	(SYSROOT_SUFFIX_SPEC): Likewise.

	2010-07-16  Andrew Jenner  <andrew@codesourcery.com>

	gcc/
	* config/mips/t-montavista-linux (MULTILIB_OPTIONS, MULTILIB_DIRNAMES,
	MULTILIB_EXCEPTIONS, MULTILIB_OSDIRNAMES): Add Octeon II multilibs.

	2010-07-16  Andrew Jenner  <andrew@codesourcery.com>

	gcc/
        * config/mips/t-montavista-elf (MULTILIB_OPTIONS, MULTILIB_DIRNAMES):
	Add Octeon II multilibs.

2010-08-13  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #9186 - Contents test failure for Python scripts.

	libstdc++-v3/
	* python/Makefile.am (pythondir): Use $(tooldir)/share.
	* python/Makefile.in: Regenerate.

2010-08-13  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-08-13  Jie Zhang  <jie@codesourcery.com>
	* config/arm/arm.md (cstoredf4): Only valid when
	!TARGET_VFP_SINGLE.

2010-08-12  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/testsuite/
	2010-08-12  Jie Zhang  <jie@codesourcery.com>
	* gcc.dg/graphite/interchange-9.c (M): Define to be 111.
	(N): Likewise.
	(main): Adjust accordingly.

2010-08-05  Andrew Stubbs  <ams@codesourcery.com>

	* gcc.dg/vect/vect-shift-2.c: Revert all previous changes.
	* gcc.dg/vect/vect-shift-4.c: New file.

2010-08-05  Julian Brown  <julian@codesourcery.com>

	Backport from mainline (candidate patch):

	gcc/
	* expr.c (expand_assignment): Add assertion to prevent emitting null
	rtx for movmisalign pattern.
	(expand_expr_real_1): Likewise.
	* config/arm/arm.c (arm_builtin_support_vector_misalignment): New.
	(TARGET_VECTORIZE_SUPPORT_VECTOR_MISALIGNMENT): New. Use above.
	(arm_vector_alignment_reachable): New.
	(TARGET_VECTORIZE_VECTOR_ALIGNMENT_REACHABLE): New. Use above.
	(neon_vector_mem_operand): Disallow PRE_DEC for misaligned loads.
	(arm_print_operand): Include alignment qualifier in %A.
	* config/arm/neon.md (UNSPEC_MISALIGNED_ACCESS): New constant.
	(movmisalign<mode>): New expander.
	(movmisalign<mode>_neon_store, movmisalign<mode>_neon_load): New
	insn patterns.

	gcc/testsuite/
	* gcc.dg/vect/vect-42.c: Use vect_element_align instead of
	vect_hw_misalign.
	* gcc.dg/vect/vect-60.c: Likewise.
	* gcc.dg/vect/vect-56.c: Likewise.
	* gcc.dg/vect/vect-93.c: Likewise.
	* gcc.dg/vect/no-scevccp-outer-8.c: Likewise.
	* gcc.dg/vect/vect-95.c: Likewise.
	* gcc.dg/vect/vect-96.c: Likewise.
	* gcc.dg/vect/vect-outer-5.c: Use quad-word vectors when available.
	* gcc.dg/vect/slp-25.c: Likewise.
	* gcc.dg/vect/slp-3.c: Likewise.
	* gcc.dg/vect/vect-multitypes-1.c: Likewise.
	* gcc.dg/vect/no-vfa-pr29145.c: Likewise.
	* gcc.dg/vect/vect-multitypes-4.c: Likewise. Use vect_element_align.
	* gcc.dg/vect/vect-109.c: Likewise.
	* gcc.dg/vect/vect-peel-1.c: Likewise.
	* gcc.dg/vect/vect-peel-2.c: Likewise.
	* lib/target-supports.exp
	(check_effective_target_arm_vect_no_misalign): New.
	(check_effective_target_vect_no_align): Use above.
	(check_effective_target_vect_element_align): New.
	(add_options_for_quad_vectors): New.

2010-08-05  Andrew Stubbs  <ams@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/vect/vect-shift-2.c: Fix misapplied patch.

2010-08-05  Jie Zhang  <jie@codesourcery.com>

	Issue #7257

	Backport from mainline:

	gcc/
	2010-08-05  Jie Zhang  <jie@codesourcery.com>
	PR tree-optimization/45144
	* tree-sra.c (type_consists_of_records_p): Return false
	if the record contains bit-field.

	gcc/testsuite/
	2010-08-05  Jie Zhang  <jie@codesourcery.com>
	PR tree-optimization/45144
	* gcc.dg/tree-ssa/pr45144.c: New test.

2010-08-04  Mark Mitchell  <mark@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-12-18  Maciej W. Rozycki  <macro@codesourcery.com>
	libiberty/
	* pex-common.c (pex_read_err): Set stderr_pipe to -1 if a
	corresponding stream has been opened.
	(pex_free): Close pipe file descriptors corresponding to child's
	stdout and stderr before waiting.

2010-08-04  Mark Mitchell  <mark@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2007-03-05  Mark Mitchell  <mark@codesourcery.com>
	* configure.in (*-*-vxworks*): Remove target-libstdc++-v3 from
	noconfigdirs.
	* configure: Regenerated.
	
2010-08-04  Mark Mitchell  <mark@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2007-03-12  Richard Sandiford  <richard@codesourcery.com>
	gcc/
	* config/vx-common.h (TARGET_FLEXLM): Define.
	
2010-08-04  Mark Mitchell  <mark@codesourcery.com>

	Backport from mainline:

	gcc/testsuite/
	2010-08-04  Daniel Gutson  <dgutson@codesourcery.com>
	* g++.dg/warn/miss-format-1.C: Update line number.
	
2010-08-04  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #8974

	gcc/
	* tree-ssa-remove-local-statics.c (maybe_discover_new_declaration):
	Update comment.  Use VAR everywhere.
	(store_cb, load_cb): New functions.
	(find_static_nonvolatile_declarations): Use walk_stmt_load_store_ops
	instead of FOR_EACH_SSA_TREE_OPERAND.
	(unstaticize_variable): Don't check SINGLE_SSA_TREE_OPERAND.
	(gate_rls): Remove #if code.

2010-08-04  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/neon-testgen.ml (regexps): Allow any characters
	in comments after assembly instructions.

	gcc/testsuite/
	* gcc.target/arm/neon/vfp-shift-a2t2.c: Allow any characters in
	comments after assembly instructions.
	* gcc.target/arm/neon/v*.c: Regenerate.

2010-08-03  Julian Brown  <julian@codesourcery.com>

	* Merge from FSF GCC 4.5.1.

2010-08-02  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-05-24  Paul Brook  <paul@codesourcery.com>

	Issue #8426 - Avoid libsupc++ static writable data
	libstdc++-v3/
	* libsupc++/unwind-cxx.h (__get_terminate_handler,
	__get_terminate_handler): New.
	* libsupc++/eh_throw.cc: Use them.
	* libsupc++/eh_ptr.cc: Ditto.
	* libsupc++/eh_terminate.cc: Ditto.
	* libsupc++/eh_term_handler.cc: Avoid static initializer on SymbianOS.
	* libsupc++/eh_unex_handler.cc: Avoid static initializer on SymbianOS.

2010-08-02  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-02-16  Paul Brook  <paul@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-symbianelf*): Add t-bpabi to t-symbian.
	* config/arm/symbian.h (RENAME_LIBRARY): Remove.
	* config/arm/lib1funcs.asm: Remove __symbian__ conditionals.
	* config/arm/libunwind.S: Ditto.
	* config/arm/t-symbian (LIB1ASMFUNCS): Remove.
	(UNWIND_H, LIB2ADDEH, LIB2ADDEHDEP): Remove.
	(LIB2FUNCS_STATIC_EXTRA): Remove.
	(LIB2FUNCS_EXTRA): Add eabi-memcpy.c and eabi-memset.c.
	* config/arm/eabi-memcpy.c: New file.
	* config/arm/eabi-memset.c: New file.

2010-08-02  Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-07-14  Paul Brook  <paul@codesourcery.com>

	Issue #5829

	config/
	* stdint.m4: Avoid pulling in headers when checking basic type sizes.

	libstdc++-v3/
	* configure: Regenerate.

2010-07-29  Kazu Hirata  <kazu@codesourcery.com>

	Backport from mainline:

	libgcc/
	2010-06-12  Kazu Hirata  <kazu@codesourcery.com>
	* config.host (mips64*-*-linux*, mips*-*-linux*): Add mips/t-crtfm
	to tmake_file.  Add crtfastmath.o to extra_parts.
	* config/mips/t-crtfm: New.

	gcc/
	2010-06-12  Kazu Hirata  <kazu@codesourcery.com>
	* config.gcc (mips64*-*-linux*, mipsisa64*-*-linux*,
	mips*-*-linux*): Add crtfastmath.o to extra_parts.
	* config/mips/crtfastmath.c: New.
	* config/mips/linux.h (ENDFILE_SPEC): New.

2010-07-29  Thomas Schwinge  <thomas@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-05-22  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #8729

	* release-notes-csl.xml: New note.

2010-07-29  Jie Zhang  <jie@codesourcery.com>

	Issue #9079

	Backport from mainline:

	gcc/
	2010-07-23  Jie Zhang  <jie@codesourcery.com>
	* tree-sra.c (ipa_sra_preliminary_function_checks): Dump
	proper words when !tree_versionable_function_p.

	2010-06-16  Martin Jambor  <mjambor@suse.cz>
	PR tree-optimization/43905
	* tree-sra.c (ipa_sra_preliminary_function_checks): Check whether the
	function is versionable.
	* Makefile.in (tree-sra.o): Add TREE_INLINE_H to dependencies.

	2010-07-27  Jie Zhang  <jie@codesourcery.com>
	PR target/44290
	Revert
	2010-07-23  Jie Zhang  <jie@codesourcery.com>
	* tree-sra.c (ipa_sra_preliminary_function_checks): Return
	false if ! tree_versionable_function_p.

2010-07-28  Kazu Hirata  <kazu@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-06-22  Kazu Hirata  <kazu@codesourcery.com>

	Merge from Sourcery G++ 4.3:

	Issue #5105
	gcc/testsuite/
	* gcc.target/m68k/pr36134.c: Use dg-skip-if to skip the testcase
	if there is a conflict with -mcpu=.  Use -mcpu=5208.

2010-07-28  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Backport code hoisting improvements from mainline:

	2010-07-28  Jakub Jelinek  <jakub@redhat.com>
	PR debug/45105
	* gcc.dg/pr45105.c: New test.

	2010-07-28  Jakub Jelinek  <jakub@redhat.com>
	PR debug/45105
	* gcse.c (hoist_code): Use FOR_BB_INSNS macro.

	2010-07-28  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/45107
	* gcc.dg/pr45107.c: New test.

	2010-07-28  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/45107
	* gcse.c (hash_scan_set): Use max_distance for gcse-las.

	2010-07-28  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/45101
	* gcc.dg/pr45101.c: New test.

	2010-07-28  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/45101
	* gcse.c (hash_scan_set): Fix argument ordering of insert_expr_in_table
	for gcse-las.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/40956
	PR target/42495
	PR middle-end/42574
	* gcc.target/arm/pr40956.c, gcc.target/arm/pr42495.c,
	* gcc.target/arm/pr42574.c: Add tests.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* config/arm/arm.c (params.h): Include.
	(arm_override_options): Tune gcse-unrestricted-cost.
	* config/arm/t-arm (arm.o): Define dependencies.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR target/42495
	PR middle-end/42574
	* basic-block.h (get_dominated_to_depth): Declare.
	* dominance.c (get_dominated_to_depth): New function, use
	get_all_dominated_blocks as a base.
	(get_all_dominated_blocks): Use get_dominated_to_depth.
	* gcse.c (occr_t, VEC (occr_t, heap)): Define.
	(hoist_exprs): Remove.
	(alloc_code_hoist_mem, free_code_hoist_mem): Update.
	(compute_code_hoist_vbeinout): Add debug print outs.
	(hoist_code): Partially rewrite, simplify.  Use get_dominated_to_depth.
	* params.def (PARAM_MAX_HOIST_DEPTH): New parameter to avoid
	quadratic behavior.
	* params.h (MAX_HOIST_DEPTH): New macro.
	* doc/invoke.texi (max-hoist-depth): Document.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/40956
	* config/arm/arm.c (thumb1_size_rtx_costs): Fix cost of simple
	constants.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
  	PR target/42495
  	PR middle-end/42574
	* config/arm/arm.c (legitimize_pic_address): Use
	gen_calculate_pic_address pattern to emit calculation of PIC address.
	(will_be_in_index_register): New function.
	(arm_legitimate_address_outer_p, thumb2_legitimate_address_p,)
	(thumb1_legitimate_address_p): Use it provided !strict_p.
	* config/arm/arm.md (calculate_pic_address): New expand and split.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR target/42495
	PR middle-end/42574
	* config/arm/arm.c (thumb1_size_rtx_costs): Add cost for "J" constants.
	* config/arm/arm.md (define_split "J", define_split "K"): Make
	IRA/reload friendly.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* gcse.c (insert_insn_end_basic_block): Update signature, remove
	unused checks.
	(pre_edge_insert, hoist_code): Update.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR target/42495
	PR middle-end/42574
	* gcse.c (hoist_expr_reaches_here_p): Remove excessive check.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* gcse.c (hoist_code): Generate new pseudo for every new set insn.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	PR rtl-optimization/40956
	PR target/42495
	PR middle-end/42574
	* gcse.c (compute_code_hoist_vbeinout): Consider more expressions
	for hoisting.
	(hoist_code): Count occurences in current block too.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* gcse.c (struct expr:max_distance): New field.
	(doing_code_hoisting_p): New static variable.
	(want_to_gcse_p): Change signature.  Allow constrained hoisting of
	simple expressions, don't change behavior for PRE.  Set max_distance.
	(insert_expr_in_table): Set new max_distance field.
	(hash_scan_set): Update.
	(hoist_expr_reaches_here_p): Stop search after max_distance
	instructions.
	(find_occr_in_bb): New static function.  Use it in ...
	(hoist_code): Calculate sizes of basic block before any changes are
	done.  Pass max_distance to hoist_expr_reaches_here_p.
	(one_code_hoisting_pass): Set doing_code_hoisting_p.
	* params.def (PARAM_GCSE_COST_DISTANCE_RATIO,)
	(PARAM_GCSE_UNRESTRICTED_COST): New parameters.
	* params.h (GCSE_COST_DISTANCE_RATIO, GCSE_UNRESTRICTED_COST): New
	macros.
	* doc/invoke.texi (gcse-cost-distance-ratio, gcse-unrestricted-cost):
	Document.

	2010-07-27  Jeff Law  <law@redhat.com>
	    Maxim Kuvyrkov  <maxim@codesourcery.com>
	* gcse.c (compute_transpout, transpout): Remove, move logic
	to prune_expressions.
	(compute_pre_data): Move pruning of trapping expressions ...
	(prune_expressions): ... here.  New static function.
	(compute_code_hoist_data): Use it.
	(alloc_code_hoist_mem, free_code_hoist_mem, hoist_code): Update.

	2010-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* dbgcnt.def (hoist_insn): New debug counter.
	* gcse.c (hoist_code): Use it.

2010-07-28  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	gcc/
	* config/arm/thumb2.md (*thumb2_movdf_soft_insn): Fix alternatives
	for pool ranges.

2010-07-28  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gcc/
	2010-07-22  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>
 	PR target/43698
	* config/arm/arm.md: Split arm_rev into *arm_rev and *thumb1_rev.
	Set *arm_rev to be predicable.

	gcc/testsuite/
	2010-07-22  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>
	PR target/43698
	* gcc.target/arm/pr43698.c: New test.

2010-07-27  Mark Mitchell  <mark@codesourcery.com>
            Joseph Myers  <joseph@codesourcery.com>
            Mark Shinwell  <shinwell@codesourcery.com>
            Vladimir Prus  <vladimir@codesourcery.com>
            Paul Brook  <paul@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	gcc/
	* config.gcc (arm-wrs-linux-gnueabi, i586-wrs-linux-gnu,
	mips-wrs-linux-gnu, powerpc-wrs-linux-gnu):
	Handle new targets.
	* config/arm/t-wrs-linux, config/arm/wrs-linux.h,
	config/i386/t-wrs-linux, config/i386/wrs-linux.h,
	config/i386/wrs-linux.opt, config/mips/t-wrs-linux,
	config/mips/wrs-linux.h, config/rs6000/t-wrs-linux,
	config/rs6000/wrs-linux.h: New.
	* config/mips/t-octeon-elf (MULTILIB_OPTIONS, MULTILIB_DIRNAMES,
	MULTILIB_EXCEPTIONS): Add Octeon II multilibs.

2010-07-27  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:	

	2010-07-27  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/linux.h (SUBTARGET_OVERRIDE_OPTIONS):
	Change setting of TARGET_INTERLINK_MIPS16.
	* config/mips/mips.opt (TARGET_INTERLINK_MIPS16):
	Initialize to -1.
	* config/mips/mips.c (mips_function_ok_for_sibcall):
	TARGET_INTERLINK_MIPS16 now checks for one.
	* release-notes-csl.xml: Document.

2010-07-27  Joseph Myers  <joseph@codesourcery.com>

	Merge from SG++ 4.4:

	2009-07-20  Joseph Myers  <joseph@codesourcery.com>

	Issue #5565

	fixincludes/
	* fixincl.tpl (sed_cmd_z): Hardcode to "sed".
	* fixincl.x: Regenerate.

2010-07-27  Joseph Myers  <joseph@codesourcery.com>

	Merge from SG++ 4.4:

	2009-07-01  Joseph Myers  <joseph@codesourcery.com>

	Issue #4168

	gcc/
	* gcc.c (using_libgcc, executing_linker): New.
	(execute): Check that libgcc.a exists in the multilib directory
	when linking.
	(process_command): Set using_libgcc to 0 for -nodefaultlibs,
	-nostdlib and -B options.
	(main): Set executing_linker when processing spec that may run the
	linker.

2010-07-26  Catherine Moore  <clm@codesourcery.com>

	2010-07-26  Catherine Moore  <clm@codesourcery.com>
	Issue #9082
	gcc/
	* config/mips/mips.c (mips_override_options):  Clear the
	micromips and mips16 bits from target_flags after checking
	them.
	* release-notes-csl.xml: Document.

2010-07-26  Kazu Hirata  <kazu@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/pr44404.c: Fix a merge error.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-06-29  Jie Zhang  <jie@codesourcery.com>

	Issue #8970

	gcc/
	* config/arm/arm.c (arm_attr_length_move_neon): New.
	* config/arm/arm-protos.h (arm_attr_length_move_neon): Declare.
	* config/arm/neon.md (define_mode_attr V_slen): Remove.
	(neon_mov<mode> for VSTRUCT): Use arm_attr_length_move_neon
	to compute length attribute.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-06-14  Paul Brook  <paul@codesourcery.com>

	Issue #8879
	gcc/
	* config/arm/arm.c (use_vfp_abi): Add sorry() for Thumb-1
	hard-float ABI.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-06-14  Jie Zhang  <jie@codesourcery.com>

	gcc/
	* config/arm/cortex-a8.md (cortex_a8_load_store_2): Reserve
	cortex_a8_issue_ls.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	2010-06-12  Jie Zhang  <jie@codesourcery.com>

	gcc/
	* config/arm/vfp.md (arm_movsi_vfp): Set neon_type correctly
	for neon_ldr and neon_str instructions.
	* config/arm/cortex-a8.md (cortex_a8_alu): Don't use
	cortex_a8_default when neon_type is not none.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	2010-04-11  Julian Brown  <julian@codesourcery.com>

	Issue #7326

	gcc/
	* config/arm/arm.c (arm_issue_rate): Return 2 for Cortex-A5.
	* config/arm/arm.md (generic_sched): No for Cortex-A5.
	(generic_vfp): Likewise.
	(cortex-a5.md): Include.
	* config/arm/cortex-a5.md: New.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-04-12  Andrew Stubbs  <ams@codesourcery.com>

	Issue #7178

	gcc/
	* config/arm/arm.c (arm_init_libfuncs): Change __gnu_f2h_ieee to
	__aeabi_f2h, __gnu_f2h_alternative to __aeabi_f2h_alt, __gnu_h2f_ieee
	to __aeabi_h2f, and __gnu_h2f_alternative to __aeabi_h2f_alt.
	* config/arm/fp16.c (__gnu_f2h_internal): Change return type to
	unsigned int. Change 'sign' variable likewise.
	(__gnu_h2f_internal): Set to static inline.
	Change return type to unsigned int. Change 'sign' variable likewise.
	(ALIAS): New define.
	(__gnu_f2h_ieee): Change unsigned short to unsigned int.
	(__gnu_h2f_ieee): Likewise.
	(__gnu_f2h_alternative): Likewise.
	(__gnu_h2f_alternative): Likewise.
	(__aeabi_f2h, __aeabi_h2f): New aliases.
	(__aeabi_f2h_alt, __aeabi_h2f_alt): Likewise.
	* config/arm/sfp-machine.h (__extendhfsf2): Set to __aeabi_h2f.
	(__truncsfhf2): Set to __aeabi_f2h.

	gcc/testsuite/
	* g++.dg/ext/arm-fp16/arm-fp16-ops-5.C: Check for __aeabi_h2f
	and __aeabi_f2h.
	* g++.dg/ext/arm-fp16/arm-fp16-ops-6.C: Likewise.
	* gcc.dg/torture/arm-fp16-ops-5.c: Likewise.
	* gcc.dg/torture/arm-fp16-ops-6.c: Likewise.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Richard Earnshaw  <rearnsha@arm.com>

	gcc/
	* doc/tm.texi (OVERLAPPING_REGISTER_NAMES): Document new macro.
	* output.h (decode_reg_name_and_count): Declare.
	* varasm.c (decode_reg_name_and_count): New function.
	(decode_reg_name): Reimplement using decode_reg_name_and_count.
	* reginfo.c (fix_register): Use decode_reg_name_and_count and 
	iterate over all regs used.
	* stmt.c (expand_asm_operands): Likewise.
	* config/arm/aout.h (OVERLAPPING_REGISTER_NAMES): Define.
	(ADDITIONAL_REGISTER_NAMES): Remove aliases that overlap
	multiple machine registers.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-04-08  Bernd Schmidt  <bernds@codesourcery.com>

	Issue #6952

	gcc/
	* ira-costs.c (record_reg_classes): Ignore alternatives that are 
	not enabled. 
	* config/arm/vfp.md (arm_movdi_vfp): Enable only when not tuning
	for Cortex-A8.
	(arm_movdi_vfp_cortexa8): New pattern.
	* config/arm/neon.md (adddi3_neon, subdi3_neon, anddi3_neon,
	iordi3_neon, xordi3_neon): Add alternatives to discourage Neon
	instructions when tuning for Cortex-A8.  Set attribute "alt_tune".
	* config/arm/arm.md (define_attr "alt_tune", define_attr "enabled"):
	New.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-04-07  Thomas Schwinge  <thomas@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #6715

	PR debug/40521

	gcc/
	* dwarf2out.c (NEED_UNWIND_TABLES): Define.
	(dwarf2out_do_frame, dwarf2out_do_cfi_asm, dwarf2out_begin_prologue)
	(dwarf2out_frame_finish, dwarf2out_assembly_start): Use it.
	(dwarf2out_assembly_start): Correct logic for TARGET_UNWIND_INFO.
	* config/arm/arm.h (DWARF2_UNWIND_INFO): Remove definition.
	* config/arm/bpabi.h (DWARF2_UNWIND_INFO): Define to zero.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Jie Zhang  <jie@codesourcery.com>

	Issue #7122

	gcc/
	* config/arm/arm.c (arm_rtx_costs_1): Adjust cost for
	CONST_VECTOR.
	(arm_size_rtx_costs): Likewise.
	(thumb2_size_rtx_costs): Likewise.
	(neon_valid_immediate): Add a case for double 0.0.

	gcc/testsuite/
	* gcc.target/arm/neon-vdup-1.c: New test case.
	* gcc.target/arm/neon-vdup-2.c: New test case.
	* gcc.target/arm/neon-vdup-3.c: New test case.
	* gcc.target/arm/neon-vdup-4.c: New test case.
	* gcc.target/arm/neon-vdup-5.c: New test case.
	* gcc.target/arm/neon-vdup-6.c: New test case.
	* gcc.target/arm/neon-vdup-7.c: New test case.
	* gcc.target/arm/neon-vdup-8.c: New test case.
	* gcc.target/arm/neon-vdup-9.c: New test case.
	* gcc.target/arm/neon-vdup-10.c: New test case.
	* gcc.target/arm/neon-vdup-11.c: New test case.
	* gcc.target/arm/neon-vdup-12.c: New test case.
	* gcc.target/arm/neon-vdup-13.c: New test case.
	* gcc.target/arm/neon-vdup-14.c: New test case.
	* gcc.target/arm/neon-vdup-15.c: New test case.
	* gcc.target/arm/neon-vdup-16.c: New test case.
	* gcc.target/arm/neon-vdup-17.c: New test case.
	* gcc.target/arm/neon-vdup-18.c: New test case.
	* gcc.target/arm/neon-vdup-19.c: New test case.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Jie Zhang  <jie@codesourcery.com>

	Issue #7122

	gcc/
	* config/arm/vfp.md (movdf_vfp): Add load double 0.0 case.
	(thumb2_movdf_vfp): Likewise. Require that one of the operands be a
	register.
	* config/arm/constraints.md (D0): New constraint.
	
	gcc/testsuite/
	* gcc.target/arm/neon-load-df0.c: New test.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-02-23  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/arm.c (thumb2_size_rtx_costs): New.
	(arm_rtx_costs): Call above for Thumb-2.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-02-23  Julian Brown  <julian@codesourcery.com>

	gcc/
	* calls.c (precompute_register_parameters): Avoid generating a
	register move if optimizing for size.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-02-15  Julian Brown  <julian@codesourcery.com>

	Issue #7486

	gcc/
	* config/arm/arm.c (arm_libcall_uses_aapcs_base)
	(arm_init_cumulative_args): Use correct ABI for double-precision
	helper functions in hard-float mode if only single-precision
	arithmetic is supported in hardware.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	Julian Brown  <julian@codesourcery.com>
	Mark Mitchell  <mark@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_function_ok_for_sibcall): Only forbid
	sibling calls for Thumb-1.
	* config/arm/arm.h (USE_RETURN_INSN): Enable for Thumb-2.
	* config/arm/arm.md (*call_symbol, *call_value_symbol): Use for
	Thumb-2.
	(*call_insn, *call_value_insn): Don't use for Thumb-2.
	(sibcall, sibcall_value, *sibcall_insn, *sibcall_value_insn): Use
	for Thumb-2.
	(return): New expander.
	(*arm_return): New name for ARM return insn.
	* config/arm/thumb2.md (*thumb2_return): New insn pattern.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-02-04  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #7197 - backtrace() through throw()

	libstdc++-v3/
	* libsupc++/eh_personality.cc (PERSONALITY_FUNCTION): For
	ARM EABI, skip handlers for _US_VIRTUAL_UNWIND_FRAME
	| _US_FORCE_UNWIND.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	2010-02-03  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6472

	gcc/
	* config/arm/lib1funcs.asm (__ARM_ARCH__): __ARM_ARCH_7EM__
	added to the preprocessor condition.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	gcc/
	* config/arm/thumb2.md (*thumb2_addsi3_compare0): New.
	(*thumb2_addsi3_compare0_scratch): New.
	* config/arm/constraints.md (Pv): New.
	* config/arm/arm.md (*addsi3_compare0): Remove FIXME comment. Use
	for ARM mode only.
	(*addsi3_compare0_scratch): Likewise.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Nathan Sidwell  <nathan@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>

	* libtool.m4 (nucleus*): Add shared library logic, deplibs check
	method.
	* configure.ac: Handle arm*-*-nucleuseabi.
	* configure: Regenerate.

	gcc/
	* config.gcc: Handle arm*-*-nucleuseabi*.
	* config/arm/nucleus.h: New.
	* config/arm/t-cs-nucleuseabi: New.
	* config/arm/unwind-arm.h (_Unwind_decode_target2): Target2 on
	nucleus-shared is the same as linux.

	libgcc/
	* config.host: Handle arm*-*-nucleuseabi*.

	libstdc++-v3/
	* config/os/nucleus/arm-eabi-extra.ver: New.
	* configure.host (arm*-*-nucleauseabi): Add arm-eabi-extra.ver.
	* configure: Regenerated.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Daniel Jacobowitz  <dan@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>

	Issue #6131 - Enable additional optimizations by default in Lite
	Issue #6103 - Reduce default unrolling parameters at -O3
	Issue #7326 - ARM Cortex-A5 support and performance
 
        gcc/
	* config/arm/arm.c (arm_override_options): If flag_unroll_loops has
	the default value, adjust unrolling parameters. Don't default to
	unrolling loops for Cortex-A5.
	(arm_optimization_options): Set flag_unroll_loops to a default value.
	Enable flag_promote_loop_indices.

2010-07-26  Kazu Hirata  <kazu@codesourcery.com>

	Merged from Sourcery G++ 4.4:

	2009-05-27  Sandra Loosemore  <sandra@codesourcery.com>

	Merged from Sourcery G++ 4.3:

	2007-08-26  Mark Mitchell  <mark@codesourcery.com>

	fixincludes/
	* inclhack.def (solaris_mutex_init_2): Remove precise machine
	checks; look at <sys/types.h> to determine whether fix is
	required.
	(solaris_rwlock_init_1): Likewise.
	(solaris_once_init_2): Likewise.
	* tests/base/sys/types.h: Add output generated by
	solaris_mutex_init_2.
	* fixincl.x: Regenerated.

2010-07-26  Kazu Hirata  <kazu@codesourcery.com>

	Merged from Sourcery G++ 4.4:

	2009-05-27  Sandra Loosemore  <sandra@codesourcery.com>

	Merged from Sourcery G++ 4.3:

 	2007-08-26  Mark Mitchell  <mark@codesourcery.com>

	gcc/testsuite/
	* lib/prune.exp (prune_warnings): Extend the default
	implementation to prune linker warnings about libm on Solaris.
	libstdc++-v3/
	* testsuite/lib/prune.exp (prune_g++_output): Prune linker
	warnings about libm on Solaris.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-05-25  Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_tune_cortex_a5): New.
	(arm_override_options): Set above. Set max_insns_skipped to 1 for
	Cortex-A5.
	* config/arm/arm.h (arm_tune_cortex_a5): Add declaration.
	(BRANCH_COST): Set to zero for Cortex-A5 unless optimising for
	size.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-08-26  Julian Brown  <julian@codesourcery.com>

	gcc/config/arm/
	* uclinux-eabi.h (LINK_GCC_C_SEQUENCE_SPEC): Override definition
	for uclinux.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	2009-08-26  Kazu Hirata  <kazu@codesourcery.com>

	Issue #6089
	gcc/
	* config/arm/arm.c (arm_rtx_costs_1): Don't special case for
	Thumb-2 in the MINUS case.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	gcc/
	* gengtype-lex.l: Add HARD_REG_SET.
	* expr.c (expand_expr_real_1): Record writes to hard registers.
	* function.h (rtl_data): Add asm_clobbers.
	* ira.c (compute_regs_asm_clobbered): Use crtl->asm_clobbers.
	(ira_setup_eliminable_regset): Remove regs_asm_clobbered.
	Use crtl->asm_clobbers.

	gcc/testsuite/
	* gcc.target/arm/frame-pointer-1.c: New test.
	* gcc.target/i386/pr9771-1.c: Move code out of main to allow frame
	pointer elimination.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-06-23  Kazu Hirata  <kazu@codesourcery.com>

	Issue #4613
	gcc/
	* config/arm/arm.c (arm_rtx_costs_1): Teach that the cost of MLS
	is the same as its underlying multiplication.
	* config/arm/arm.md (two splitters): New.
	* config/arm/predicates.md (binary_operator): New.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2008-09-08  Daniel Jacobowitz  <dan@codesourcery.com>

	gcc/
	* config/arm/unwind-arm.c (__gnu_unwind_pr_common): Correct test
	for barrier handlers.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	gcc/
	* config/arm/arm.c (arm_override_options): Override alignments if
	tuning for Cortex-A8.
	(create_fix_barrier, arm_reorg): If aligning to jumps or loops,
	make labels have a size.
	* config/arm/arm.md (VUNSPEC_ALIGN16, VUNSPEC_ALIGN32): New constants.
	(align_16, align_32): New patterns.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	Mark Shinwell  <shinwell@codesourcery.com>

	gcc/
	* config/arm/vfp.md (*arm_movsi_vfp, *thumb2_movsi_vfp)
	(*arm_movdi_vfp, *thumb2_movdi_vfp, *movsf_vfp, *thumb2_movsf_vfp)
	(*movdf_vfp, *thumb2_movdf_vfp, *movsfcc_vfp, *thumb2_movsfcc_vfp)
	(*movdfcc_vfp, *thumb2_movdfcc_vfp): Add neon_type.
	* config/arm/arm.md (neon_type): Update comment.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Backport from FSF mainline:

	Mark Shinwell  <shinwell@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/thumb2.md (thumb2_movsi_insn): Split ldr and str
	alternatives according to use of high and low regs.
	* config/arm/vfp.md (thumb2_movsi_vfp): Likewise.
	* config/arm/arm.h (CONDITIONAL_REGISTER_USAGE): Use high regs when
	optimizing for size on Thumb-2.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	http://gcc.gnu.org/ml/gcc-patches/2006-03/msg00038.html

	* g++.dg/other/armv7m-1.C: New.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	http://gcc.gnu.org/ml/gcc-patches/2006-04/msg00811.html

	Kazu Hirata  <kazu@codesourcery.com>

	gcc/testsuite/
	* gcc.target/arm/vfp-ldmdbd.c, gcc.target/arm/vfp-ldmdbs.c,
	gcc.target/arm/vfp-ldmiad.c, gcc.target/arm/vfp-ldmias.c,
	gcc.target/arm/vfp-stmdbd.c, gcc.target/arm/vfp-stmdbs.c,
	gcc.target/arm/vfp-stmiad.c, gcc.target/arm/vfp-stmias.c: New.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Julian Brown  <julian@codesourcery.com>
	Mark Shinwell  <mark@codesourcery.com>

	gcc/
	* regrename.c (addresses.h): Move include of addresses.h after
	include of flags.h.
	* recog.c: Likewise.
	* regcprop.c: Likewise.
	* config/arm/arm.h (CLASS_LIKELY_SPILLED_P): Check against
	LO_REGS only for Thumb-1.
	(MODE_BASE_REG_CLASS): Restrict base registers to those which can
	be used in short instructions when optimising for size on Thumb-2.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Vladimir Prus  <vladimir@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_override_options): Warn if mlow-irq-latency is
	specified in Thumb mode.
	(load_multiple_sequence): Return 0 if low irq latency is requested.
	(store_multiple_sequence): Likewise.
	(arm_gen_load_multiple): Load registers one-by-one if low irq latency
	is requested.
	(arm_gen_store_multiple): Likewise.
	(vfp_output_fldmd): When low_irq_latency is non zero, pop each
	register separately.
	(vfp_emit_fstmd): When low_irq_latency is non zero, save each register
	separately.
	(arm_get_vfp_saved_size): Adjust saved register size calculation for
	the above changes.
	(print_pop_reg_by_ldr): New.
	(arm_output_epilogue): Use print_pop_reg_by_ldr when low irq latency
	is requested.
	(emit_multi_reg_push): Push registers separately if low irq latency
	is requested.
	* config/arm/arm.h (TARGET_CPU_CPP_BUILTINS): Set __low_irq_latency__.
	(low_irq_latency): Define.
	(USE_RETURN_INSN): Don't use return insn when low irq latency is
	requested.
	* config/arm/lib1funcs.asm (do_pop, do_push): Define as variadic
	macros. When __low_irq_latency__ is defined, push and pop registers
	individually.
	(div0): Use correct punctuation.
	* config/arm/ieee754-df.S: Adjust syntax of using do_push.
	* config/arm/ieee754-sf.S: Likewise.
	* config/arm/bpabi.S: Likewise.
	* config/arm/arm.opt (mlow-irq-latency): New option.
	* config/arm/predicates.md (load_multiple_operation): Return false is
	low irq latency is requested.
	(store_multiple_operation): Likewise.
	* config/arm/arm.md (movmemqi): Don't use it if low irq latency is
	requested.
	* doc/invoke.texi (-mlow-irq-latency): Add documentation.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2007-06-06  Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config/arm/arm.h (VALID_IWMMXT_REG_MODE): Allow SImode.
	(ARM_LEGITIMIZE_RELOAD_ADDRESS): Reduce range allowed for SImode
	offsets with iWMMXt.
	* config/arm/arm.c (arm_hard_regno_mode_ok): Update for change to
	VALID_IWMMXT_REG_MODE.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2007-07-05  Mark Shinwell  <shinwell@codesourcery.com>

	gcc/
	* config/arm/arm.h (BRANCH_COST): Set to 1 when optimizing for size
	on Thumb-2.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2007-09-19  Vladimir Prus  <vladimir@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_optimization_options): Disable
	-fmove-loop-invariants. Use very restrictive inlining heuristics.

	gcc/testsuite/
	* gcc.c-torture/execute/bcp-1.x: New.  Don't run bcp-1.c test on arm,
	with -Os.
	* gcc.c-torture/execute/990208-1.x: New.  Likewise.

2010-07-26  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Kazu Hirata  <kazu@codesourcery.com>

	gcc/
	* config.gcc (arm*-*-linux*): Handle enable_extra_asa_multilibs.
	* config/arm/t-asa: New.

2010-07-24  Sandra Loosemore  <sandra@codesourcery.com>

	Backport from mainline:

	2010-04-10  Wei Guozhi  <carrot@google.com>

	PR target/42601
	gcc/
	* config/arm/arm.c (arm_pic_static_addr): New function.
	(legitimize_pic_address): Call arm_pic_static_addr when it detects
	a static symbol.
	(arm_output_addr_const_extra): Output expression for new pattern.
	* config/arm/arm.md (UNSPEC_SYMBOL_OFFSET): New unspec symbol.

	2010-07-22  Sandra Loosemore  <sandra@codesourcery.com>

	PR tree-optimization/39839
	gcc/testsuite/
	* gcc.target/arm/pr39839.c: New test case.

2010-07-24  Jie Zhang  <jie@codesourcery.com>

	Issue #9079

	* release-notes-csl.xml: Document.

	Backport from mainline:

	gcc/
	2010-07-23  Jie Zhang  <jie@codesourcery.com>
	PR target/44290
	* attribs.c (decl_attributes): Insert "noinline" and "noclone"
	if "naked".
	* tree-sra.c (ipa_sra_preliminary_function_checks): Return
	false if ! tree_versionable_function_p.

	gcc/testsuite/
	2010-07-23  Jie Zhang  <jie@codesourcery.com>
	PR target/44290
	* gcc.dg/pr44290-1.c: New test.
	* gcc.dg/pr44290-2.c: New test.

2010-07-23  Nathan Froyd  <froydnj@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-03-09  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* tree-ssa-loop-promote.c: New file.
	* common.opt (fpromote-loop-indices): New option.
	* timevar.def (TV_TREE_LOOP_PROMOTE): New timevar.
	* Makefile.in (tree-ssa-loop-promote.o): New rule.
	(OBJS-comon): Include it.
	* tree-pass.h (pass_promote_short_indices): Declare.
	* passes.c (init_optimization_passes): Add it.
	* pointer-set.h (pointer_set_n_elements, pointer_set_clear,
	pointer_map_n_elements, pointer_map_clear): Declare.
	* pointer-set.c (pointer_set_n_elements, pointer_set_clear,
	pointer_map_n_elements, pointer_map_clear): Define.

	gcc/doc/
	* invoke.texi (-fpromote-loop-indices): New entry.

	gcc/testsuite/
	* gcc.dg/promote-short-1.c: New file.
	* gcc.dg/promote-short-2.c: New file.
	* gcc.dg/promote-short-3.c: New file.
	* gcc.dg/promote-short-4.c: New file.
	* gcc.dg/promote-short-5.c: New file.
	* gcc.dg/promote-short-6.c: New file.
	* gcc.dg/promote-short-7.c: New file.
	* gcc.dg/promote-short-8.c: New file.

	2009-03-31  Daniel Jacobowitz  <dan@codesourcery.com>
	gcc/
	* common.opt (fpromote-loop-indices): Add Optimization keyword.

	2009-04-08  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* tree-ssa-loop-promote.c (collection_promotion_candidates):
	Delay allocation and initialization of new promote_info until we
	know we have a candidate loop index.

	2009-04-09  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* tree-ssa-loop-promote.c (rebuild_with_promotion_1): Load a memory
	reference prior to promoting it.

	gcc/testsuite/
	* gcc.dg/promote-short-9.c: New test.

	2009-04-09  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/promote-short-3.c: XFAIL test for x86, m68k, sh, and mips.

	2009-04-13  Kazu Hirata  <kazu@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/promote-short-3.c: XFAIL on fido.

2010-07-23  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from mainline:

	2010-07-23  Nathan Froyd  <froydnj@codesourcery.com>
	libgcc/
	* config.host (powerpc*-eabispe*): Set tmake_file.
	(powerpc*-eabi*): Likewise.
	* config/rs6000/t-ppccomm (EXTRA_PARTS): Add crtbegin, crtend,
	crtbeginS, crtendS, crtbeginT.

2010-07-23  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* regcprop.c (replace_oldest_value_addr): Use regno_ok_for_index_p.

2010-07-22  Daniel Jacobowitz  <dan@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-10-11  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #6429 - GDB test failures on ColdFire

	gcc/
	* dwarf2out.c (dwarf2out_frame_debug): Check for queued saves
	again after processing insn.

2010-07-22  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from Sourcery G++ 4.4, not suitable for upstream:

	2009-05-12  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* common.opt (feglibc): New dummy option.
	* opts.c (common_handle_option): Handle it.
	* config.gcc: Handle 'eglibc' vendor.
	* config/t-eglibc: Define multilibs for testing EGLIBC features.
	* configure.ac (--with-eglibc-configs, EGLICB_CONFIGS): New option and
	variable.
	* configure: Regenerate.
	* Makefile.in (EGLIBC_CONFIGS): Handle

2010-07-22  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #8483
	Backport from mainline:

	gcc/
	2010-05-12  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* targhooks.c (default_stack_protect_guard): Avoid sharing RTL
	for __stack_chk_guard.
	2010-05-12  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* gcc.target/m68k/20100512-1.c: New.

2010-07-22  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-01-06  Maxim Kuvyrkov  <maxim@codesourcery.com>
	Issue #7450
	gcc/
	* config/m68k/uclinux.h (LIB_SPEC): Bring in sync with config/linux.h.

2010-07-22  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2007-02-16  Richard Sandiford  <richard@codesourcery.com>
 	gcc/
	* config/m68k/m68k.h (INDEX_REG_CLASS): Delete in favor of...
	(MODE_INDEX_REG_CLASS): ...this new macro.  Return NO_REGS unless
	MODE_OK_FOR_INDEX_P.
	(MODE_OK_FOR_INDEX_P): New macro.
	(REGNO_OK_FOR_INDEX_P): Delete in favor of...
	(REGNO_MODE_OK_FOR_INDEX_P): ...this new macro.  Return false
	unless MODE_OK_FOR_INDEX_P.
	(REG_OK_FOR_INDEX_P): Delete in favor of...
	(REG_MODE_OK_FOR_INDEX_P): ...this new macro.  Return false
	unless MODE_OK_FOR_INDEX_P.
	* m68k-protos.h (m68k_legitimate_index_reg_p): Add mode argument.
	* m68k.c (m68k_legitimate_index_reg_p, m68k_decompose_index):
	Add mode argument.  Use it.
	* config/m68k/m68k.md (tst<mode>_cf, cmp<mode>_cf, movsf_cf_hard)
	(movdf_cf_hard, extendsfdf2_cf, truncdfsf2_cf, ftrunc<mode>2_cf)
	(add<mode>3_cf, sub<mode>3_cf, fmul<mode>3_cf, div<mode>3_cf)
	(neg<mode>2_cf, sqrt<mode>2_cf, abs<mode>2_cf): Replace "Q<U>"
	constraints for FP addresses with "m" constraints.

	2007-02-16  Nathan Sidwell  <nathan@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/m68k-fp-1.c: New.

2010-07-22  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Backport from FSF GCC 4.5 branch to fix PR45015:

	2010-07-22  Jakub Jelinek  <jakub@redhat.com>
	PR debug/45015
	* var-tracking.c (adjust_mems): Ignore ASM_OPERANDS with non-zero
	ASM_OPERANDS_OUTPUT_IDX.
	(adjust_insn): For inline asm with multiple sets ensure first
	ASM_OPERANDS vectors are used by all following ASM_OPERANDS in
	the insn.

	2010-07-22  Jakub Jelinek  <jakub@redhat.com>
	PR debug/45015
	* gcc.target/m68k/pr45015.c: New test.

2010-07-22  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:	

	2009-05-15  Joseph Myers  <joseph@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	NOT ASSIGNED TO FSF
	COPYRIGHT CAVIUM
	gcc/
	* config/mips/octeon-elf-unwind.h, config/mips/octeon-elf.h,
	config/mips/octeon.h, config/mips/t-octeon-elf: New.
	* config.gcc: Handle mips64octeon*-wrs-elf*.
	(mips-wrs-linux-gnu): Use mips/octeon.h.
	* config/mips/mips-protos.h (octeon_output_shared_variable): New.
	* config/mips/mips.c (octeon_handle_cvmx_shared_attribute,
	octeon_select_section, octeon_unique_section,
	octeon_output_shared_variable): New.
	(mips_attribute_table): Add cvmx_shared.
	(mips_in_small_data_p): Check for cvmx_shared attribute.
	libgcc/
	* config.host: Handle mips64octeon*-wrs-elf*.

2010-07-21  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from Sourcery++ 4.4:

	2008-07-02  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/rs6000/eabi.h (NAME__MAIN, INVOKE__main): Remove.
	* config/rs6000/t-ppccomm (LIB2FUNS_STATIC_EXTRA): Remove eabi.S.
	(eabi.S): Remove rule.

	2008-10-13  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* doc/invoke.texi (PowerPC Options): -meabi option no longer places
	__eabi function in main.

2010-07-21  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from mainline:

	2010-06-28  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>
	gcc/
	* config/rs6000/rs6000.h (PROCESSOR_TITAN): Declare.

	2010-06-28  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>
	gcc/
	* config.gcc (powerpc*-*-*): Handle titan.
	* config/rs6000/rs6000.c (titan_cost): New costs.
	(rs6000_override_options): Add "titan" to processor_target_table.
	Add Titan to branch alignment logic.
	Correctly set rs6000_cost for titan.
	* config/rs6000/rs6000.md (cpu): Add titan.  Include "titan.md".
	* config/rs6000/titan.md: New file.
	* doc/invoke.texi (RS/6000 and PowerPC Options): Document -mcpu=titan.

2010-07-21  Catherine Moore  <clm@codesourcery.com>

	Backport from upstream:

	2010-06-26  Catherine Moore  <clm@codesourcery.com>

	* config/mips/mips.md (alu_type): New attribute.
	(type): Infer type from alu_type.
	(*add<mode>3, *add<mode>3_mips16, *addsi3_extended,
	*baddu_si_eb, *baddu_si_el, *baddu_di, sub<mode>3,
	*subsi3_extended, negsi2, negdi2, *low<mode>,
	*low<mode>_mips16, *ior<mode>3, *ior<mode>3_mips16,
	xor<mode>3, *nor<mode>3,
	*zero_extend<GPR:mode>_trunc<SHORT:mode>,
	*zero_extendhi_truncqi):  Set alu_type instead of type.

2010-07-21  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/mips.md (ior<mode>3): Move micromips_type
	logical_and from here...
	(*and<mode>): ...to here.

2010-07-21  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:	

	2009-06-11  Catherine Moore  <clm@codesourcery.com>
	Merge from SourceryG++ 4.3:
	Merge from MIPS:
	2007-11-29  Thiemo Seufer  <ths@mips.com>
	gcc/
	* config/mips/mips.c (override_options): Let -fpic imply
	-mabicalls, forward port from SDE	.

2010-07-21  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:	

	2009-06-15  Catherine Moore  <clm@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	2006-12-15  Richard Sandiford  <richard@codesourcery.com>
	Adapted from a patch by Cavium Networks.
	gcc/
	* config/mips/mips.opt (mocteon-useun): New option.
	* config/mips/mips.h: (ISA_HAS_UL_US): New macro.
	(ASM_SPEC): Pass down -mocteon-useun and -mno-octeon-useun.
	* config/mips/mips.c (mips_expand_ext_as_unaligned_load): Use
	mov_ulw and mov_uld if ISA_HAS_UL_US.
	(mips_expand_ins_as_unaligned_store): Likewise mov_usw and mov_usd.
	* config/mips/mips.md: (UNSPEC_UNALIGNED_LOAD,
	 UNSPEC_UNALIGNED_STORE): New constants.
	(mov_<load>l, mov_<load>r, mov_<store>l, mov_<store>r): Require
	ISA_HAS_UL_US.
	(mov_u<load>, mov_u<store>): New patterns.

	2009-06-16  Catherine Moore  <clm@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	2006-12-15  Richard Sandiford  <richard@codesourcery.com>
	gcc/testsuite/
	* gcc.target/mips/octeon-useun.c: New test.

	2009-07-02  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips.h (ISA_HAS_UL_US): Delete extraneous
	definition.  Fix typo.
	* config/mips/mips.c (mips_expand_ext_as_unaligned_load):
	Generate mov_uld or mov_ulw if ISA_HAS_UL_US.
	* config/mips/mips.md (UNSPEC_UNALIGNED_LOAD): Equate to 60.
	(UNSPEC_UNALIGNED_STORE): Equate to 61.

	2009-07-01  Catherine Moore  <clm@codesourcery.com>
 	gcc/testsuite/
	* gcc.target/mips/mips.exp (mips_option_groups): Add
	-mocteon-useun.
	* gcc.target/mips/octeon-useun.c: Change dg-mips-options to
	dg-options.

2010-07-20  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	2010-06-07  Kazu Hirata  <kazu@codesourcery.com>

	Issue #8535
	* release-notes-csl.xml: Document the bug fix below.

	Backport from mainline:
	gcc/
	2010-06-07  Kazu Hirata  <kazu@codesourcery.com>
	PR rtl-optimization/44404
	* auto-inc-dec.c (find_inc): Use reg_overlap_mentioned_p instead
	of count_occurrences to see if it's safe to modify mem_insn.insn.

	gcc/testsuite/
	2010-06-07  Kazu Hirata  <kazu@codesourcery.com>
	PR rtl-optimization/44404
	* gcc.dg/pr44404.c: New.

2010-07-20  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:	
	2009-06-16  Daniel Jacobowitz  <dan@codesourcery.com>
	
	Merge from Sourcery G++ 4.3:
	2008-12-03  Daniel Jacobowitz  <dan@codesourcery.com>

	gcc/testsuite/
	* gcc.dg/vect/vect-shift-2.c, gcc.dg/vect/vect-shift-3.c: New.
	* lib/target-supports.exp (check_effective_target_vect_shift_char): New
	function.

2010-07-20  Catherine Moore  <clm@codesoucery.com>
	
	Merge from Sourcery G++ 4.4:

	2010-01-08  Chao-ying Fu  <fu@mips.com>
	Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips-protos.h (micromips_load_store_pair_p): Add
	argument.
	* config/mips/mips.c (micromips_load_store_pair_p): New
	argument swap_p.  Check for base + offset.  Check for
	anti-dependence.
	* config/mips/micromips.md: Adjust callers of
	micromips_load_store_p to pass additional argument.
	
	2010-02-02  Joseph Myers  <joseph@codesourcery.com>
	gcc/
	* config/mips/linux.h (SUBTARGET_OVERRIDE_OPTIONS): Set
	TARGET_INTERLINK_MIPS16.

	2010-02-20  Joseph Myers  <joseph@codesourcery.com>
	gcc/
	* config/mips/linux-unwind.h (mips_fallback_frame_state): Return
	early if pc not 4-byte aligned.

	2010-02-24  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/linux.h (SUBTARGET_CC1_SPEC): Pass -mno-jals
	in the absence of -mjals.
	* config/mips/mips.opt (mjals): Fix typo.

	2010-03-23  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips.c (mips_cpu_info_table): Add m14kc.


	2009-12-22  Catherine Moore  <clm@codesourcery.com>
	Merge from micromips branch:
	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	* config/mips/mips.opt (mjals): Fix a typo.

	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-10-01  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.opt (TARGET_JALS): Set to 1 by default.
	* config/mips/mips.md (indirect_jump<mode>): Use JR for
	microMIPS.
	(tablejump<mode>): Likewise.
	* config/mips/micromips.md (peephole2): New patterns for the
	MOVEP instruction.
	(*movepsisi, *movepsisf, *movepsfsi, *movepsfsf): Likewise.
	* config/mips/mips-protos.h (micromips_movep_target_p): New
	prototype.
	* config/mips/mips.c (micromips_movep_target_p): New function.

	* passes.c (init_optimization_passes): Run pass_peephole2 after
	pass_sched2 too.

	gcc/testsuite/
	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	* gcc.target/mips/near-far-1.c: Adjust scan-assembler to handle
	the JALS instruction.
	* gcc.target/mips/near-far-2.c: Likewise.

	2009-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	* config/mips/t-sgxx-sde (MULTILIB_EXTRA_OPTS): New variable,
	set to "mno-jals".

	2009-07-30  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-07-30  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.h (MIPS_ISA_LEVEL_SPEC): Add march=m14k* to
	-mips32r2 targets.

	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.opt (mmucon): Rename to...
	(mmcu): ... this.  Replace MUCON with MCU.
	* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Update
	accordingly.
	(ASM_SPEC): Likewise.
	* doc/invoke.texi (MIPS Options): Likewise.

	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>
	gcc/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	* config/mips/mips.h (MIPS_ARCH_FLOAT_SPEC): Add march=m14k* to
	-msoft-float targets.
	* config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Likewise.
	
	2009-07-10  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips.c (micromips_build_save_restore): Mark the
	built PARALLEL as RTX_FRAME_RELATED_P.

	2009-06-30  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips.md (clear_hazard): Remove TARGET_MICROMIPS code.

	2009-06-30  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips.md (clear_hazard): Don't use <d>.

	2009-06-30  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/mips/mips-protos.h (micromips_load_store_pair_p): Adjust
	prototype.
	* config/mips/mips.c (micromips_load_store_pair_p): Add check for
	invalid load instruction.
	* config/mips/micromips.md (*lwp, *swp): Adjust calls to
	micromips_load_store_pair_p.

	2009-06-09  Nathan Sidwell  <nathan@codesourcery.com>
	Port 2009-05-28 Chao-ying Fu <fu@mips.com>
	gcc/
	* config/mips/mips.c (mips_address_insns): Add a new parameter
	check_micromips_12bit_p.
	(mips_load_store_insns): Pass false to mips_address_insns for the new
	parameter.
	(mips_rtx_costs): Pass false to mips_address_insns for the new
	parameter.
	(mips_address_costs): Pass false to mips_address_insns for the new
	parameter.
	* config/mips/constraints.md (YC): New memory constraint.
	(YD): New address constraint.
	* config/mips/mips-protos.h (mips_address_insns): Add a new parameter.
	* doc/md.texi (Constraints for Particular Machines): Document YC.
	* config/mips/mips.md (mov_<load>l, mov_<load>r, mov_<store>l,
	mov_<store>r): Use YC, instead of m.
	(prefetch): Use YD, instead of p.
	(sync_compare_and_swap<mode>, sync_add<mode>, sync_sub<mode>,
	sync_old_add<mode>, sync_old_sub<mode>, sync_new_add<mode>,
	sync_new_sub<mode>, sync_<optab><mode>, sync_old_<optab><mode>,
	sync_new_<optab><mode>, sync_nand<mode>, sync_old_nand<mode>,
	sync_new_nand<mode>, sync_lock_test_and_set<mode>): Use YC,
	instead of R for memory constraints.

	gcc/
	* config/mips/t-sgxx-sde (MULTILIB_OPTIONS): Add mmicromips.
	(MULTILIB_DIRNAMES): Add micromips.
	(MULTILIB_EXCLUSIONS): Exclude -mcode-readable=no when !mips16.
	(MULTILIB_EXCEPTIONS): Remove no-float and fp-64 micromips libraries.

	Port 2009-05-13  Chao-ying Fu  <fu@mips.com>
	gcc/
	* doc/extend.texi (Declare Attributes of Functions): Add "micromips"
	and "nomicromips".
	* doc/invoke.texi (MIPS Options): Add "-mmicromips"/"-mno-mmicromips",
	"-mmucon"/"-mno-mucon", and "-mjals"/"-mno-jals".
	Add "m14k" for processor names.
	Update descriptions for "-minterlink-mips16" for microMIPS.
	Document "-mmicromips"/"-mno-mmicromips".
	Document "-mmucon"/"-mno-mucon".
	Document "-mjals"/"-mno-jals".
	* config/mips/micromips.md (*store_word_multiple, *load_word_multiple):
	New instructions for save to/load from the stack.
	New peephole2 to match load/store word pair.
	(*lwp, *swp): New instructions for load/store word pair.
	(mips_jraddiusp): New instruction.
	* config/mips/crtn.asm: Add labels of "init" and "fini", as
	objdump needs labels before microMIPS/MIPS16 instructions to dump
	instructions correctly.
	* config/mips/mips.md (micromips_type): New attribute for 16-bit
	microMIPS instructions.
	(*add<mode>3): Set micromips_type to add.
	(sub<mode>3): Set micromips_type to sub.
	(one_cmpl<mode>2): Set micromips_type to logical_not.
	(*and<mode>3): Set micromips_type to logical_and.
	(*ior<mode>3): Set micromips_type to logical_or.
	Set micromips_type to logical_xor for unamed xor instructions.
	(*zero_extend<SHORT:mode><GPR:mode>2): Set micromips_type to
	zero_extend.
	(mfhi<GPR:mode>_<HILO:mode>): Set micromips_type to mfhi.
	(clear_hazard_<mode>): Use jrs.hb for microMIPS.
	(*<optab><mode>3): Disable microMIPS for this instruction.
	(*micromips_ashl<mode>3): New instruction for microMIPS.
	(*micromips_ashr<mode>3): New instruction for microMIPS.
	(*micromips_lshr<mode>3): New instruction for microMIPS.
	(*branch_equality<mode>): Check if it is not
	microMIPS.
	(*branch_equality<mode>_micromips): New instruction for microMIPS.
	(*branch_equality<mode>_inverted): Check if it is not microMIPS.
	(*branch_equality<mode>_inverted_micromips): New isntruction for
	microMIPS.
	(jump): Use "b" for microMIPS to save code size.
	(*return): Use "jr" for microMIPS to save code size.
	(return_internal): Use "jr" for microMIPS to save code size.
	(sibcall_internal): Use MICROMIPS_J to enable jrs.
	(sibcall_value_internal): Use MICROMIPS_J to enable jrs.
	(sibcall_value_multiple_internal): Use MICROMIPS_J to enable jrs.
	(micromips.md): New include.
	* config/mips/mips.opt (mjals, mmicromips, mmucon): New options.
	* config/mips/mips16.S: Skip code when __mips_micromips is defined.
	* config/mips/mips-protos.h (micromips_output_save_restore,
	micromips_save_restore_pattern_p, micromips_load_store_pair_p,
	micromips_output_load_store_pair): New prototypes.
	* config/mips/mips.c (MIPS_MAX_FIRST_STACK_STEP): Use 0x7f0 for
	microMIPS.
	(mips_base_micromips): New variable.
	(mips_attribute_table): Add "micromips" and "nomicromips".
	(mips_cpu_info_table): Add "m14k".
	(mips_micromips_decl_p, mips_nomicromips_decl_p): New functions.
	(mips_use_micromips_mode_p): New function.
	(mips_insert_attributes):  Add micromips_p and nomicromips_p.
	Cannot use both mips16 and microMIPS.
	(mips_start_function_definition): Set micromips/nomicromips.
	(mips_function_ok_for_sibcall): Check if sibcall is ok for microMIPS.
	For MIPS32, check if the called function is a microMIPS function.
	(mips_print_operand_punctuation): Add ':' to support compact branches.
	Add '!' to support branches with 16-bit delay slots.
	(mips_init_print_operand_punct): Add ':' to generate compact branches.
	Add '!' to generate branch with 16-bit delay slots by recognizing
	16-bit instructions in delay slots.
	(mips_init_print_operand_punct): Add : and !.
	(mips_save_reg): Add prototype, because it will be used later.
	(micromips_build_save_restore): New function.
	(mips_for_each_saved_reg): Add support for microMIPS lwm/swm.
	(mips_expand_epilogue): Add jraddiusp support.
	(was_micromips_p, was_micromips_pch_p): New variables.
	(mips_set_mips16_micromips_mode): Change it from mips_set_mips16_mode.
	Support the microMIPS mode for functions.
	For microMIPS, we disable branch likely instructions.
	(mips_set_current_function): Rename mips_set_mips16_mode to
	mips_set_mips16_micromips_mode.
	(mips_override_options): Check mips16 and microMIPS.
	Rename mips_set_mips16_mode to mips_set_mips16_micromips_mode.
	(micromips_save_restore_pattern_p, micromips_output_save_restore,
	micromips_load_store_pair_p, micromips_output_load_store_pair):
	New functions.
	* config/mips/mips.h (TARGET_CPU_CPP_BUILTINS): Add __mips_micromips
	and __mips_mucon.
	(ISA_HAS_LWXS): Enable for microMIPS.
	(ASM_SPEC): Pass -mmicromips/-mno-micromips and -mmucon/-mno-mucon.
	(M16STORE_REG_P): New define for microMIPS store source register.
	(MIPS_CALL): For microMIPS, we try to enable jals and jalrs.
	(MICROMIPS_J): New define for microMIPS to enable jrs.
	* config/mips/t-sde (MULTILIB_OPTIONS): Add mmicromips.
	(MULTILIB_DIRNAMES): Add micromips
	Exclude -mcode-readable=no when !mips16.

2010-07-20  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from mainline:

	2010-07-20  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/rs6000/rs6000.opt (mblock-move-inline-limit): New option.
	* config/rs6000/rs6000.c (rs6000_override_options): Set
	rs6000_block_move_inline_limit appropriately.
	(expand_block_move): Use rs6000_block_move_inline_limit.
	* doc/invoke.texi (mblock-move-inline-limit): Document.

	gcc/testsuite/
	* gcc.target/powerpc/block-move-1.c: New test.
	* gcc.target/powerpc/block-move-2.c: New test.

2010-07-20  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from mainline:

	2010-07-20  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/rs6000/rs6000.md (abs<mode>2_isel, nabs<mode>2_isel):
	Reverse sense of if_then_else condition.

	2010-07-16  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/rs6000/rs6000.c (rs6000_emit_sISEL): Let rs6000_emit_int_cmove
	do all the work.
	(rs6000_emit_int_cmove): Use function pointers for insn generation.
	Don't force values into registers unnecessarily.
	(output_isel): Assert that we're not given conditions we can't handle.
	Delete corresponding code.
	* config/rs6000/rs6000.md (isel_signed_<mode>): Use
	scc_comparison_operator constraint.  Permit 0 for the consequent
	operand.  Permit any GPR for the alternative operand.
	(isel_unsigned_<mode>): Likewise.

2010-07-20  Catherine Moore  <clm@codesourcery.com>

	gcc/
	* config/mips/mips.c (mips_legitimize_move): Move
	misapplied patch to...
	(mips_legitimize_address): ...here.

2010-07-20  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-06-15  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* config/mips/t-netlogic: Define NetLogic multilibs.
	* config.gcc (mips64-nelogic-linux-gnu): New target.

	2010-07-20  Maxim Kuvyrkov  <maxim@codesourcery.com>
	gcc/
	* config.gcc (mips64*-*-linux*): Make O32 the default ABI for NetLogic
	target.
	* config/mips/netlogic.h: New file, make O32 the default ABI for
	NetLogic target.
	* config/mips/t-netlogic: Update.

2010-07-16  Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/rs6000.h (ASM_CPU_SPEC): Add mcpu=e5500 case.

2010-07-16  Nathan Froyd  <froydnj@codesourcery.com>

	NOT ASSIGNED TO THE FSF
	COPYRIGHT FREESCALE

	Merge from Sourcery G++ 4.4:

	2010-04-02  Nathan Froyd  <froydnj@codesourcery.com>
	libgcc/
	* configure.ac: Check for __SPE__ when compiling for powerpc*.
	* configure: Regenerate.
	* config.host: Add t-spe-fprules if compiling for SPE.
	* config/rs6000/spe_adddf3.S: New file.
	* config/rs6000/spe_subdf3.S: New file.
	* config/rs6000/spe_muldf3.S: New file.
	* config/rs6000/spe_divdf3.S: New file.
	* config/rs6000/spe_add_exception.S: New file.
	* config/rs6000/spe_muldiv_scale2.S: New file.
	* config/rs6000/spe_cmpdf2.S: New file.
	* config/rs6000/spe_eqdf2.S: New file.
	* config/rs6000/spe_gedf2.S: New file.
	* config/rs6000/spe_ledf2.S: New file.
	* config/rs6000/spe_unorddf2.S: New file.
	* config/rs6000/spe_unord_sub.S: New file.
	* config/rs6000/fixdfdi.S: New file.
	* config/rs6000/fixdfsi.S: New file.
	* config/rs6000/fixunsdfdi.S: New file.
	* config/rs6000/fixunsdfsi.S: New file.
	* config/rs6000/floatdidf.S: New file.
	* config/rs6000/floatsidf.S: New file.
	* config/rs6000/floatundidf.S: New file.
	* config/rs6000/floatunsidf.S: New file.
	* config/rs6000/extendsfdf2.S: New file.
	* config/rs6000/truncdfsf2.S: New file.


2010-07-16  Nathan Froyd  <froydnj@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-04-02  Nathan Froyd  <froydnj@codesourcery.com>
	2010-04-05  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config.gcc (powerpc-*-eabi*): Use rs6000/t-fprules-softfp and
	soft-fp/t-softfp.

2010-07-16  Jie Zhang  <jie@codesourcery.com>

	Issue #7688

	Backport from mainline:

	gcc/
	2010-07-12  Jie Zhang  <jie@codesourcery.com>
	* postreload.c (reg_symbol_ref[]): New.
	(move2add_use_add2_insn): New.
	(move2add_use_add3_insn): New.
	(reload_cse_move2add): Handle SYMBOL + OFFSET case.
	(move2add_note_store): Likewise.

2010-07-16  Jie Zhang  <jie@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-09-08  Paul Brook  <paul@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #6027

	* release-notes-csl.xml (Optimizer improvements): New note.

	Merge submitted patches:
	http://gcc.gnu.org/ml/gcc-patches/2009-03/msg00250.html

	2009-02-02  J"orn Rennecke <amylaar@spamcop.net>

	gcc/
	* tree-ssa-pre.c (ppre_n_insert_for_speed_p): New function.
	* (do_partial_partial_insertion): Use it to throttle
	insert_into_preds_of_block calls.
	* common.opt (-ftree-pre-partial-partial-obliviously): New option.

	2009-01-15  J"orn Rennecke  <joern.rennecke@arc.com>

	gcc/
	* common.opt (ftree-pre-partial-partial): New option.
	* opts.c (decode_options): Initialize flag_tree_pre_partial_partial.
	* tree-ssa-pre.c (execute_pre): Use flag_tree_pre_partial_partial.

2010-07-15  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-06-19  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge from Sourcery G++ 4.3:

	2007-02-16  Richard Sandiford  <richard@codesourcery.com>

	gcc/
	* Makefile.in (postreload.o): Depend on addresses.h.
	* addresses.h (index_reg_class, ok_for_index_p_1): New functions.
	(regno_ok_for_index_p): New function.
	* postreload.c: Include addresses.h.
	(reload_combine): Use index_reg_class instead of INDEX_REG_CLASS.
	* ira-costs.c (ok_for_index_p_nonstrict): Add a mode argument.
	Use ok_for_index_p_1 instead of REGNO_OK_FOR_INDEX_P.
	(record_address_regs): Use index_reg_class instead of INDEX_REG_CLASS.
	Update calls to ok_for_index_p_nonstrict.
	* regrename.c (scan_rtx_address): Use regno_ok_for_index_p instead of
	REGNO_OK_FOR_INDEX_P and index_reg_class instead of INDEX_REG_CLASS.
	(replace_oldest_value_addr): Likewise.
	* reload.c (find_reloads_address): Use index_reg_class instead
	of INDEX_REG_CLASS.  Do not push an index register reload if
	index_reg_class returns NO_REGS.
	(find_reloads_address_1): Use index_reg_class instead
	of INDEX_REG_CLASS and regno_ok_for_index_p instead of
	REGNO_OK_FOR_INDEX_P.
	* doc/tm.texi (MODE_INDEX_REG_CLASS): Document new macro.
	(REGNO_MODE_OK_FOR_INDEX_P): Likewise.

2010-07-15  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-02-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gcc/
	* tree.c (initializer_zerop): Handle STRING_CST.
	
2010-07-15  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-09-08  Paul Brook  <paul@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>

	Merge submitted patch:
	http://gcc.gnu.org/ml/gcc-patches/2008-12/msg00199.html
	2008-12-03  Steven Bosscher  <stevenb.gcc@gmail.com>

	gcc/
	* opts.c (decode_options): Fix initialization of	
	flag_tree_switch_conversion.  Don't set optimize_size in block
	that is conditional on optimize_size (sic).  Explicitly disable
	PRE when optimizing for size (and add comment for rationale).
	* tree-ssa-pre.c: Update outline of the algorithm.
	(bitmap_set_and): Prototype.
	(insert_into_preds_of_block): Don't report discovery of partial
	redundancies here, do so from the callers instead (see below).
	(do_regular_insertion): Add counter for an estimate for the number
	of inserts required to eliminate a partial redundancy.  If the
	current function is optimized for size, only perform the partial
	redundancy elimination if this requires inserting in only one
	predecessor.  Report all found partial redundancies from here.
	(do_partial_partial_insertion): Report them from here too.		
	(insert_aux): Do not insert for partial-partial redundancies when
	optimizing for size.
	(execute_pre): Remove bogus ATTRIBUTE_UNUSED.
	(do_pre): Run FRE at least, if PRE is disabled.
	(gate_pre): Return true if flag_tree pre or flag_tree_fre is set.

2010-07-15  Sandra Loosemore  <sandra@codesourcery.com>

	Backport from mainline:

	2010-06-09  Sandra Loosemore  <sandra@codesourcery.com>

	gcc/	
	* tree-ssa-loop-ivopts.c (adjust_setup_cost): New function.
	(get_computation_cost_at): Use it.
	(determine_use_iv_cost_condition): Likewise.
	(determine_iv_cost): Likewise.

	2010-07-05  Sandra Loosemore  <sandra@codesourcery.com>

	PR middle-end/42505

	gcc/
	* tree-ssa-loop-ivopts.c (determine_set_costs): Delete obsolete
	comments about cost model.
	(try_add_cand_for):  Add second strategy for choosing initial set
	based on original IVs, controlled by ORIGINALP argument.
	(get_initial_solution): Add ORIGINALP argument.
	(find_optimal_iv_set_1): New function, split from find_optimal_iv_set.
	(find_optimal_iv_set): Try two different strategies for choosing
	the IV set, and return the one with lower cost.

	gcc/testsuite/
	* gcc.target/arm/pr42505.c: New test case.

	2010-07-10  Sandra Loosemore  <sandra@codesourcery.com>

	PR middle-end/42505

	gcc/
	* tree-inline.c (estimate_num_insns): Refactor builtin complexity
	lookup code into....
	* builtins.c (is_simple_builtin, is_inexpensive_builtin): ...these
	new functions.
	* tree.h (is_simple_builtin, is_inexpensive_builtin): Declare.
	* cfgloopanal.c (target_clobbered_regs): Define.
	(init_set_costs): Initialize target_clobbered_regs.
	(estimate_reg_pressure_cost): Add call_p argument.  When true,
	adjust the number of available registers to exclude the
	call-clobbered registers.
	* cfgloop.h (target_clobbered_regs): Declare.
	(estimate_reg_pressure_cost): Adjust declaration.
	* tree-ssa-loop-ivopts.c (struct ivopts_data): Add body_includes_call.
	(ivopts_global_cost_for_size): Pass it to estimate_reg_pressure_cost.
	(determine_set_costs): Dump target_clobbered_regs.
	(loop_body_includes_call): New function.
	(tree_ssa_iv_optimize_loop): Use it to initialize new field.
	* loop-invariant.c (gain_for_invariant): Adjust arguments to pass
	call_p flag through.
	(best_gain_for_invariant): Likewise.
	(find_invariants_to_move): Likewise.
	(move_single_loop_invariants): Likewise, using already-computed
	has_call field.

2010-07-15  Jie Zhang  <jie@codesourcery.com>

	Issue #8497, #8893

	* release-notes-csl.xml: Document.

	Backport from mainline (originally from Sourcery G++ 4.4):

	gcc/
	2010-07-12  Jie Zhang  <jie@codesourcery.com>
	* config/arm/arm.c (arm_get_frame_offsets): Don't use r3 to
	align the stack when it's going to be saved.

	gcc/testsuite/
	2010-07-12  Jie Zhang  <jie@codesourcery.com>
	* gcc.target/arm/interrupt-1.c: New test.
	* gcc.target/arm/interrupt-2.c: New test.

2010-07-15  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline (originally from Sourcery G++ 4.4):

	gcc/
	2010-07-07  Jie Zhang  <jie@codesourcery.com>
	* genautomata.c (output_automata_list_min_issue_delay_code):
	Correctly decompress min_issue_delay.

2010-07-15  Jie Zhang  <jie@codesourcery.com>

	Issue #8980

	* release-notes-csl.xml: Document.

	Backport from mainline (originally from Sourcery G++ 4.4):

	gcc/
	2010-07-03  Jie Zhang  <jie@codesourcery.com>
	* config/arm/vfp.md (*push_multi_vfp): Use vfp_register_operand
	as predicate for operand 1 and remove its constraint.
	* config/arm/predicates.md (vfp_register_operand): New.
	* config/arm/arm.md (*push_multi): Remove the constraint of
	operand 1.
	(*push_fp_multi): Likewise.

2010-07-15  Jie Zhang  <jie@codesourcery.com>

	* release-notes-csl.xml: Document.

	Backport from mainline (originally from Sourcery G++ 4.4):

	gcc/cp/
	2010-04-07  Jie Zhang  <jie@codesourcery.com>

	PR c++/42556
	* typeck2.c (split_nonconstant_init_1): Drop empty CONSTRUCTOR
	when all of its elements are non-constant and have been split out.

	gcc/testsuite/
	2010-04-07  Jie Zhang  <jie@codesourcery.com>

	PR c++/42556
	* g++.dg/init/pr42556.C: New test.

2010-07-14  Nathan Froyd  <froydnj@codesourcery.com>

	Merge from Sourcery G++ 4.3/4.4:

	2007-08-16  Daniel Jacobowitz  <dan@codesourcery.com>
	gcc/
	* config/rs6000/rs6000.c (rs6000_conditional_register_usage): Mark
	call-saved AltiVec registers call-used if ! TARGET_ALTIVEC_ABI.
	* config/rs6000/rs6000.h (CALL_USED_REGISTERS): Mark the first 20
	AltiVec registers call-used.
	(CALL_REALLY_USED_REGISTERS): Likewise.

	gcc/testsuite/
	* gcc.target/powerpc/altivec-consts.c: Remove -mabi=altivec.
	* gcc.target/powerpc/altivec-varargs-1.c: Likewise.
	* gcc.dg/vmx/vmx.exp: Likewise.

2010-07-14  Nathan Froyd  <froydnj@codesourcery.com>

	Merge from Sourcery G++ 4.3/4.4:
	2008-02-12  Nathan Sidwell  <nathan@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>
	gcc/
	* config/rs6000/eabi-ci.asm (__init): Add _init func start.
	(__fini): Also declare _fini for newlib.

2010-07-12  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:
 
	2009-10-06  Paul Brook  <paul@codesourcery.com>
	Issue #3869        gcc/
	* target.h (gcc_target): Add warn_func_result.
	* target-def.h (TARGET_WARN_FUNC_RESULT): Define and use.
	* tree-cfg.h (execute_warn_function_return): Use
	targetm.warn_func_result.
	* config/arm/arm.c (TARGET_WARN_FUNC_RESULT): Define.
	(arm_warn_func_result): New function.

	gcc/testuite/
	 * gcc.target/arm/naked-3.c: New test.
	

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	2008-02-11  David Ung  <davidu@mips.com>
	gcc/
	* config/mips/mips.c (mips_output_division): When
	GENERATE_DIVIDE_TRAPS, generate the trap instrutions
	against zero before the actual divide.  This is friendlier
	to out-of-order cpus like the 74k.

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

 	gcc/
	2008-02-12  Julian Brown  <julian@codesourcery.com>
	Merge from MIPS:
	2008-01-16  David Ung  <davidu@mips.com>
	* config/mips/sdemtk.h: Define macro TARGET_MIPS_SDEMTK.
	* config/mips/mips.c (mips_file_start): Check against
	TARGET_MIPS_SDEMTK which supports the TARGET_NO_FLOAT option.

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-08-04  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips.opt (muclibc): Delete.

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2008-07-08  Catherine Moore  <clm@codesourcery.com>
	gcc/testsuite/
	* gcc.dg/torture/type-generic-1.c: Link with floating point
	emulation for target mips-sde-elf.

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2008-07-07  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/mips.md (abs<mode>2):  Remove checks for HARD_FLOAT
	and TARGET_SDE.

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-07-01  Catherine Moore  <clm@codesourcery.com>
	gcc/testsuite/
	* gcc.c-torture/execute/ieee/ieee.exp: Link with floating
	point emulation for mips-sde-elf targets.

2010-07-12  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

 	2009-06-10  Catherine Moore  <clm@codesourcery.com>
	Merge from Sourcery G++ 4.3:
	gcc/
	2008-11-23  Richard Sandiford  <rsandiford@googlemail.com>
	* config/mips/mips.c (mips_legitimize_address): Handle
	illegitimate CONST_INT addresses.

2010-07-11  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2008-02-12  Julian Brown  <julian@codesourcery.com>
	Merge from MIPS:
	2007-12-21  David Ung  <davidu@mips.com>
	gcc/
	* config/mips/mips.h (TARGET_MIPS_SDE): Define macro as 0.
	* config/mips/mips.md (abs<mode>2): Enable abs.[sd] patterns if
	TARGET_MIPS_SDE && TARGET_HARD_FLOAT.

	2008-07-17  Catherine Moore  <clm@codesourcery.com>
	gcc/
	* config/mips/sde.h (TARGET_MIPS_SDE): Define to 1.

2010-07-11  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-07-07  Catherine Moore  <clm@codesourcery.com>
	gcc/testsuite/
	* gcc.target/mips/clear-cache-2.c: Add target checks for
	mips-sde-elf.

2010-07-11  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	gcc/
	2008-03-17  Julian Brown  <julian@codesourcery.com>
	* config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Override, adding
	-mno-float option.

	2009-08-04  Sandra Loosemore  <sandra@codesourcery.com>
 	Issue #6004
	* release-notes-csl.xml (Support for MIPS 1004K cores): New note.
	gcc/
	* config/mips/sdemtk.h (MIPS_ARCH_FLOAT_SPEC): Add pattern for 1004K.
	Issue #6004
 	Backport from FSF:
 	gcc/
 	* doc/invoke.texi (MIPS Options): Document new 1004K -march options.

2010-07-10  Sandra Loosemore  <sandra@codesourcery.com>

	Backport from mainline:

	2010-05-08  Sandra Loosemore  <sandra@codesourcery.com>

	PR middle-end/28685

	gcc/
	* tree-ssa-reassoc.c (eliminate_redundant_comparison): New function.
	(optimize_ops_list): Call it.

	gcc/testsuite/
	* gcc.dg/pr28685-1.c: New file.

	2010-06-08  Sandra Loosemore  <sandra@codesourcery.com>

	PR tree-optimization/39874
	PR middle-end/28685

	gcc/
	* gimple.h (maybe_fold_and_comparisons, maybe_fold_or_comparisons):
	Declare.
	* gimple-fold.c (canonicalize_bool, same_bool_comparison_p,
	same_bool_result_p): New.
	(and_var_with_comparison, and_var_with_comparison_1,
	and_comparisons_1, and_comparisons, maybe_fold_and_comparisons): New.
	(or_var_with_comparison, or_var_with_comparison_1,
	or_comparisons_1, or_comparisons, maybe_fold_or_comparisons): New.
	* tree-ssa-reassoc.c (eliminate_redundant_comparison): Use
	maybe_fold_and_comparisons or maybe_fold_or_comparisons instead
	of combine_comparisons.
	* tree-ssa-ifcombine.c (ifcombine_ifandif, ifcombine_iforif): Likewise.

	gcc/testsuite/
	* gcc.dg/pr39874.c: New file.

2010-07-10  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-09-02  Daniel Jacobowitz  <dan@codesourcery.com>

	libgcc/
	* shared-object.mk (c_flags-$(base)$(objext)): New.
	($(base)$(objext)): Use above.
	($(base)_s$(objext)): Likewise.
	* static-object.mk (c_flags-$(base)$(objext)): New.
	($(base)$(objext)): Use above.
	
2010-07-10  Yao Qi  <yao@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-05-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.3:

	libgcc/
	* config.host (arm*-*-linux*, arm*-*-uclinux*, arm*-*-eabi*)
	(arm*-*-symbianelf): Add arm/t-divmod-ef to tmake_file.
	* Makefile.in (LIB2_DIVMOD_EXCEPTION_FLAGS): Set to previous
	default if not set by a target-specific Makefile fragment.
	(lib2-divmod-o, lib2-divmod-s-o): Use above.
	* config/arm/t-divmod-ef: New.

2010-07-09  Sandra Loosemore  <sandra@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-05-26  Sandra Loosemore  <sandra@codesourcery.com>
		    Mark Shinwell  <shinwell@codesourcery.com>
		    Joseph Myers  <joseph@codesourcery.com>

	Revised patch merged from Sourcery G++ 4.3.

	gcc/
	* doc/invoke.texi (-falign-arrays): Document.
	* function.h (alignment_for_aligned_arrays): Declare.
	* function.c (get_stack_local_alignment): Use it.
	(alignment_for_aligned_arrays): Define.
	* cfgexpand.c (get_decl_align_unit): Use it here, too.
	* common.opt (-falign-arrays): New.
	* varasm.c (assemble_variable): Use alignment_for_aligned_arrays,
	and use it irrespective of whether DATA_ALIGNMENT is defined.

2010-07-09  Sandra Loosemore  <sandra@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2009-05-21  Sandra Loosemore  <sandra@codesourcery.com>

	Merge from Sourcery G++ 4.3:

	2009-04-04  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #5104
	PR tree-optimization/39604

	gcc/testsuite
	* g++.dg/tree-ssa/sink-1.C: New.

	gcc/
	* tree_ssa-sink.c (sink_code_in_bb): Do not sink statements out
	of a lexical block containing variable definitions.

2010-07-09  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	* gcc/config/mips/linux.h (SUBTARGET_OVERRIDE_OPTIONS):
	Disable thread support for uclibc.
	* gcc/config/mips/mips.opt (muclibc): Add.

2010-07-09  Catherine Moore  <clm@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-04-10  Catherine Moore  <clm@codesourcery.com>
	Issue #7474
	* release-notes-csl.xml: New note.
	gcc/
	* gcc/config.gcc (mips-sde-elf): Enable soft-fp.
	* gcc/config/mips/t-fprules-softfp: New.
	* gcc/config/mips/sfp-machine: New.

2010-07-09  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Precision improvement with vectorization
	enabled): New note.

	Backport from mainline (originally on Sourcery G++ 4.4):

	2010-07-02  Julian Brown  <julian@codesourcery.com>
		    Sandra Loosemore <sandra@codesourcery.com>

	PR target/43703

	gcc/
	* config/arm/vec-common.md (add<mode>3, sub<mode>3, smin<mode>3)
	(smax<mode>3): Disable for NEON float modes when
	flag_unsafe_math_optimizations is false.
	* config/arm/neon.md (*add<mode>3_neon, *sub<mode>3_neon)
	(*mul<mode>3_neon)
	(mul<mode>3add<mode>_neon, mul<mode>3neg<mode>add<mode>_neon)
	(reduc_splus_<mode>, reduc_smin_<mode>, reduc_smax_<mode>): Disable
	for NEON float modes when flag_unsafe_math_optimizations is false.
	(quad_halves_<code>v4sf): Only enable if flag_unsafe_math_optimizations
	is true.
	* doc/invoke.texi (ARM Options): Add note about floating point
	vectorization requiring -funsafe-math-optimizations.

	gcc/testsuite/
	* gcc.dg/vect/vect.exp: Add -ffast-math for NEON.
	* gcc.dg/vect/vect-reduc-6.c: Add XFAIL for NEON.

2010-07-08  Sandra Loosemore  <sandra@codesourcery.com>

	Backport from upstream (originally from Sourcery G++ 4.4):

	2010-07-02  Daniel Jacobowitz  <dan@codesourcery.com>
		    Julian Brown  <julian@codesourcery.com>
		    Sandra Loosemore <sandra@codesourcery.com>

	gcc/
	* config/arm/arm.c (arm_canonicalize_comparison): Canonicalize DImode
	comparisons.  Adjust to take both operands.
	(arm_select_cc_mode): Handle DImode comparisons.
	(arm_gen_compare_reg): Generate a scratch register for DImode
	comparisons which require one.  Use xor for Thumb equality checks.
	(arm_const_double_by_immediates): New.
	(arm_print_operand): Allow 'Q' and 'R' for constants.
	(get_arm_condition_code): Handle new CC_CZmode and CC_NCVmode.
	* config/arm/arm.h (CANONICALIZE_COMPARISON): Always use
	arm_canonicalize_comparison.
	* config/arm/arm-modes.def: Add CC_CZmode and CC_NCVmode.
	* config/arm/arm-protos.h (arm_canonicalize_comparison): Update
	prototype.
	(arm_const_double_by_immediates): Declare.
	* config/arm/constraints.md (Di): New constraint.
	* config/arm/predicates.md (arm_immediate_di_operand)
	(arm_di_operand, cmpdi_operand): New.
	* config/arm/arm.md (cbranchdi4): Handle non-Cirrus also.
	(*arm_cmpdi_insn, *arm_cmpdi_unsigned)
	(*arm_cmpdi_zero, *thumb_cmpdi_zero): New insns.
	(cstoredi4): Handle non-Cirrus also.

	gcc/testsuite/
	* gcc.c-torture/execute/20100416-1.c: New test case.

2010-07-08  Sandra Loosemore  <sandra@codesourcery.com>

	Backport from upstream (originally from Sourcery G++ 4.4):

	2010-07-02  Sandra Loosemore  <sandra@codesourcery.com>

	gcc/
	* config/arm/neon.md (vec_extractv2di): Correct error in register
	numbering to reconcile with neon_vget_lanev2di.

	2010-07-02  Sandra Loosemore  <sandra@codesourcery.com>

	gcc/
	* config/arm/arm.c (neon_vdup_constant): Expand into canonical RTL
	instead of an unspec.
	(neon_expand_vector_init): Likewise.
	* config/arm/neon.md (UNSPEC_VCOMBINE): Delete.
	(UNSPEC_VDUP_LANE): Delete.
	(UNSPEC VDUP_N): Delete.
	(UNSPEC_VGET_HIGH): Delete.
	(UNSPEC_VGET_LANE): Delete.
	(UNSPEC_VGET_LOW): Delete.
	(UNSPEC_VMVN): Delete.
	(UNSPEC_VSET_LANE): Delete.
	(V_double_vector_mode): New.
	(vec_set<mode>_internal): Make code emitted match that for the
	corresponding intrinsics.
	(vec_setv2di_internal): Likewise.
	(neon_vget_lanedi): Rewrite to expand into emit_move_insn.
	(neon_vget_lanev2di): Rewrite to expand into vec_extractv2di.
	(neon_vset_lane<mode>): Combine double and quad patterns and
	expand into vec_set<mode>_internal instead of UNSPEC_VSET_LANE.
	(neon_vset_lanedi): Rewrite to expand into emit_move_insn.
	(neon_vdup_n<mode>): Rewrite RTL without unspec.
	(neon_vdup_ndi): Rewrite as define_expand and use emit_move_insn.
	(neon_vdup_nv2di): Rewrite RTL without unspec and merge with
	with neon_vdup_lanev2di, adjusting the pattern from the latter
	to be predicable for consistency.
	(neon_vdup_lane<mode>_internal): New.
	(neon_vdup_lane<mode>): Turn into a define_expand and rewrite
	to avoid using an unspec.
	(neon_vdup_lanedi): Rewrite RTL pattern to avoid unspec.
	(neon_vdup_lanev2di): Turn into a define_expand.
	(neon_vcombine): Rewrite pattern to eliminate UNPSEC_VCOMBINE.
	(neon_vget_high<mode>): Replace with....
	(neon_vget_highv16qi): New pattern using canonical RTL.
	(neon_vget_highv8hi): Likewise.
	(neon_vget_highv4si): Likewise.
	(neon_vget_highv4sf): Likewise.
	(neon_vget_highv2di): Likewise.
	(neon_vget_low<mode>): Replace with....
	(neon_vget_lowv16qi): New pattern using canonical RTL.
	(neon_vget_lowv8hi): Likewise.
	(neon_vget_lowv4si): Likewise.
	(neon_vget_lowv4sf): Likewise.
	(neon_vget_lowv2di): Likewise.

	* config/arm/neon.ml (Vget_lane): Add No_op attribute to suppress
	test for this emitting vmov.
	(Vset_lane): Likewise.
	(Vdup_n): Likewise.
	(Vmov_n): Likewise.

	* doc/arm-neon-intrinsics.texi: Regenerated.

	gcc/testsuite/
	* gcc.target/arm/neon/vdup_ns64.c: Regenerated.
	* gcc.target/arm/neon/vdup_nu64.c: Regenerated.
	* gcc.target/arm/neon/vdupQ_ns64.c: Regenerated.
	* gcc.target/arm/neon/vdupQ_nu64.c: Regenerated.
	* gcc.target/arm/neon/vmov_ns64.c: Regenerated.
	* gcc.target/arm/neon/vmov_nu64.c: Regenerated.
	* gcc.target/arm/neon/vmovQ_ns64.c: Regenerated.
	* gcc.target/arm/neon/vmovQ_nu64.c: Regenerated.
	* gcc.target/arm/neon/vget_lanes64.c: Regenerated.
	* gcc.target/arm/neon/vget_laneu64.c: Regenerated.
	* gcc.target/arm/neon/vset_lanes64.c: Regenerated.
	* gcc.target/arm/neon/vset_laneu64.c: Regenerated.
	* gcc.target/arm/neon-vdup_ns64.c: New.
	* gcc.target/arm/neon-vdup_nu64.c: New.
	* gcc.target/arm/neon-vdupQ_ns64.c: New.
	* gcc.target/arm/neon-vdupQ_nu64.c: New.
	* gcc.target/arm/neon-vdupQ_lanes64.c: New.
	* gcc.target/arm/neon-vdupQ_laneu64.c: New.
	* gcc.target/arm/neon-vmov_ns64.c: New.
	* gcc.target/arm/neon-vmov_nu64.c: New.
	* gcc.target/arm/neon-vmovQ_ns64.c: New.
	* gcc.target/arm/neon-vmovQ_nu64.c: New.
	* gcc.target/arm/neon-vget_lanes64.c: New.
	* gcc.target/arm/neon-vget_laneu64.c: New.
	* gcc.target/arm/neon-vset_lanes64.c: New.
	* gcc.target/arm/neon-vset_laneu64.c: New.

	2010-07-02  Sandra Loosemore  <sandra@codesourcery.com>
		    Julian Brown  <julian@codesourcery.com>

	gcc/
	* config/arm/neon.md (UNSPEC_VABA): Delete.
	(UNSPEC_VABAL): Delete.
	(UNSPEC_VABS): Delete.
	(UNSPEC_VMUL_N): Delete.
	(adddi3_neon): New.
	(subdi3_neon): New.
	(mul<mode>3add<mode>_neon): Make the pattern named.
	(mul<mode>3neg<mode>add<mode>_neon): Likewise.
	(neon_vadd<mode>): Replace with define_expand, and move the remaining
	unspec parts...
	(neon_vadd<mode>_unspec): ...to this.
	(neon_vmla<mode>, neon_vmla<mode>_unspec): Likewise.
	(neon_vlms<mode>, neon_vmls<mode>_unspec): Likewise.
	(neon_vsub<mode>, neon_vsub<mode>_unspec): Likewise.
	(neon_vaba<mode>): Rewrite in terms of vabd.
	(neon_vabal<mode>): Rewrite in terms of vabdl.
	(neon_vabs<mode>): Rewrite without unspec.
	* config/arm/arm.md (*arm_adddi3): Disable for TARGET_NEON.
	(*arm_subdi3): Likewise.
	* config/arm/neon.ml (Vadd, Vsub): Split out 64-bit variants and add
	No_op attribute to disable assembly output checks.
	* config/arm/arm_neon.h: Regenerated.
	* doc/arm-neon-intrinsics.texi: Regenerated.

	gcc/testsuite/
	* gcc.target/arm/neon/vadds64.c: Regenerated.
	* gcc.target/arm/neon/vaddu64.c: Regenerated.
	* gcc.target/arm/neon/vsubs64.c: Regenerated.
	* gcc.target/arm/neon/vsubu64.c: Regenerated.
	* gcc.target/arm/neon-vmla-1.c: Add -ffast-math to options.
	* gcc.target/arm/neon-vmls-1.c: Likewise.
	* gcc.target/arm/neon-vsubs64.c: New execution test.
	* gcc.target/arm/neon-vsubu64.c: New execution test.
	* gcc.target/arm/neon-vadds64.c: New execution test.
	* gcc.target/arm/neon-vaddu64.c: New execution test.
2010-07-07  Sandra Loosemore  <sandra@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2010-03-08  Paul Brook  <paul@codesourcery.com>

	gcc/
	* doc/invoke.texi: Document ARM -mcpu=cortex-m4.
	* config/arm/arm.c (all_architectures): Change v7e-m default to
	cortexm4.
	* config/arm/arm-cores.def: Add cortex-m4.
	* config/arm/arm-tune.md: Regenerate.

2010-07-07 Sandra Loosemore  <sandra@codesourcery.com>

	Backport from mainline (originally from Sourcery G++ 4.4):

	2010-05-24  Daniel Jacobowitz  <dan@codesourcery.com>
		    Sandra Loosemore  <sandra@codesourcery.com>

	gcc/
	* config/arm/neon-testgen.ml: Use dg-add-options arm_neon.
	* doc/sourcebuild.texi (Effective-Target Keywords): Update arm_neon_ok
	description.  Add arm_neon_fp16_ok.
	(Add Options): Add arm_neon and arm_neon_fp16.

	gcc/testsuite/
	* gcc.target/arm/neon/: Regenerated test cases.

	* gcc.target/arm/neon/polytypes.c,
	gcc.target/arm/neon-vmla-1.c, gcc.target/arm/neon-vmls-1.c,
	gcc.target/arm/neon-cond-1.c, gcc.target/arm/neon/vfp-shift-a2t2.c,
	gcc.target/arm/neon-thumb2-move.c, gcc.dg/torture/arm-fp16-ops-8.c, 
	gcc.dg/torture/arm-fp16-ops-7.c, g++.dg/ext/arm-fp16/arm-fp16-ops-7.C,
	g++.dg/ext/arm-fp16/arm-fp16-ops-8.C, g++.dg/abi/mangle-neon.C: Use
	dg-add-options arm_neon.

	* gcc.target/arm/fp16-compile-vcvt.c, gcc.dg/torture/arm-fp16-ops-5.c,
	gcc.dg/torture/arm-fp16-ops-6.c, g++.dg/ext/arm-fp16/arm-fp16-ops-5.C,
	g++.dg/ext/arm-fp16/arm-fp16-ops-6.C: Use dg-add-options arm_neon_fp16
	and arm_neon_fp16_ok.

	* gcc.dg/vect/vect.exp, g++.dg/vect/vect.exp,
	gfortran.dg/vect/vect.exp: Use add_options_for_arm_neon.

	* lib/target-supports.exp (add_options_for_arm_neon): New.
	(check_effective_target_arm_neon_ok_nocache): New, from
	check_effective_target_arm_neon_ok.  Check multiple possibilities.
	(check_effective_target_arm_neon_ok): Use
	check_effective_target_arm_neon_ok_nocache.
	(add_options_for_arm_neon_fp16)
	(check_effective_target_arm_neon_fp16_ok)
	check_effective_target_arm_neon_fp16_ok_nocache): New.
	(check_effective_target_arm_neon_hw): Use add_options_for_arm_neon.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Joseph Myers  <joseph@codesourcery.com>
	Paul Brook  <paul@codesourcery.com>
	Daniel Gutson  <dgutson@codesourcery.com>
	Julian Brown  <julian@codesourcery.com>
	Sandra Loosemore  <sandra@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>

	gcc/
	* config.gcc: Add ARM multilib configurations.

	* config/arm/nocrt0.h, config/arm/t-cs-eabi,
	config/arm/t-cs-eabi-lite, config/arm/t-cs-linux,
	config/arm/t-cs-linux-lite, config/arm/t-cs-uclinux-eabi: New.
	* config/arm/t-arm-elf (MULTILIB_MATCHES): Add armv7e-m.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Julian Brown  <julian@codesourcery.com>
	Catherine Moore  <clm@codesourcery.com>
	Sandra Loosemore  <sandra@codesourcery.com>
	Richard Sandiford  <richard@codesourcery.com>
	Nigel Stephens  <nigel@mips.com>
	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc: Add MIPS multilib configurations.
	* config/mips/cs-sgxx-linux.h, config/mips/cs-sgxxlite-linux.h,
	config/mips/t-sgxx-linux, config/mips/t-sgxx-sde,
	config/mips/t-sgxxlite-linux: New.
	* config/mips/mips.opt (mips16e): Add as deprecated alias
	for -mips16.
	* doc/invoke.texi (Option Summary, MIPS Options): Document it.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	Joseph Myers  <joseph@codesourcery.com>
	
	gcc/
	* config.gcc (i[34567]86-*-linux*): Use extra config files if
	--enable-extra-sgxx-multilibs or --enable-extra-sgxxlite-multilibs.
	* config/i386/cs-linux-lite.h, config/i386/t-cs-linux-lite,
	config/i386/cs-linux.h, config/i386/cs-linux.opt,
	config/i386/t-cs-linux: New.
	* configure.ac (gcc_cv_libc_provides_ssp): Set to yes for
	GNU/Linux targets with libssp disabled.
	* configure: Regenerate.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	2009-05-01  Andrew Stubbs  <ams@codesourcery.com>
	gcc/
	* config/sh/cs-sgxxlite-linux.h, config/sh/t-sgxxlite-linux: New.
	* config.gcc: Add SH multilib configurations.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Nathan Froyd  <froydnj@codesourcery.com>
	Kazu Hirata <kazu@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Nathan Sidwell  <nathan@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* config.gcc: Add Power multilib configurations.
	* config/rs6000/e500mc.h, config/rs6000/t-cs-eabi,
	config/rs6000/t-cs-eabi-lite, config/rs6000/t-cs-linux,
	config/rs6000/t-ppc-e500mc: New.
	* config/rs6000/cs-linux.h: New.
	* config/rs6000/eabi.h (CC1_EXTRA_SPEC, ASM_DEFAULT_SPEC): Define.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	2008-08-25  Nathan Froyd  <froydnj@codesourcery.com>
	gcc/
	* config/rs6000/sysv4.h (LIB_SIM_SPEC): Use LIB_DEFAULT_SPEC.
	(STARTFILE_SIM_SPEC): Remove sim-crt0.o%s.
	(ENDFILE_SIM_SPEC): Add -Tsim-hosted.ld.
	(LINK_OS_SIM_SPEC): Define to empty.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Joseph Myers  <joseph@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Nathan Froyd  <froydnj@codesourcery.com>

	gcc/
	* config/rs6000/option-defaults.h (OPTION_DEFAULT_SPECS): Handle
	-te500mc, -te500v1, -te500v2 and -te600.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	gcc/
	* config/rs6000/sysv4.h (CC1_EXTRA_SPEC): Define and use.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	Nathan Froyd  <froydnj@codesourcery.com>
	Andrew Stubbs  <ams@codesourcery.com>
	Bernd Schmidt  <bernds@codesourcery.com>

	gcc/
	* doc/invoke.texi: Document -fremove-local-statics.
	* Makefile.in (OBJS-common): Add tree-ssa-remove-local-statics.o.
	* c.opt (fremove-local-statics): New option (for C and C++).
	* cgraph.c (cgraph_node): Set ever_was_nested in the node and
	its parent when creating a new node.
	* cgraph.h (struct cgraph_node): Add 'ever_was_nested'.
	* passes.c (init_optimization_passes): Add
	pass_remove_local_statics to the optimization passes.
	* timevar.def (TV_RLS): New timevar.
	* toplev.h (flag_remove_local_statics): Declare.
	* tree-pass.h (pass_remove_local_statics): Declare.
	* tree-ssa-remove-local-statics.c: New file. NOTE: Pass currently
	disabled in gate_rls function.

	gcc/cp/
	* decl2.c (mark_used): Mark _DECLs as DECL_NONLOCAL if appropriate.

	gcc/testsuite/
	* g++.dg/remove-local-statics-1.C: New test.
	* g++.dg/remove-local-statics-2.C: New test.
	* gcc.dg/remove-local-statics-1.c: New file.
	* gcc.dg/remove-local-statics-2.c: New file.
	* gcc.dg/remove-local-statics-3.c: New file.
	* gcc.dg/remove-local-statics-4.c: New file.
	* gcc.dg/remove-local-statics-5.c: New file.
	* gcc.dg/remove-local-statics-6.c: New file.
	* gcc.dg/remove-local-statics-7.c: New file.
	* gcc.dg/remove-local-statics-8.c: New file.
	* gcc.dg/remove-local-statics-9.c: New file.
	* gcc.dg/remove-local-statics-10.c: New file.
	* gcc.dg/remove-local-statics-11.c: New file.
	* gcc.dg/remove-local-statics-12.c: New file.
	* gcc.dg/remove-local-statics-13.c: New test.
	* gcc.dg/remove-local-statics-14.c: New test.
	* gcc.dg/remove-local-statics-15.c: New test.
	* gcc.dg/remove-local-statics-16.c: New test.
	* gcc.dg/remove-local-statics-17.c: New test.
	* gcc.dg/tree-ssa/pr21559.c: Compile with -fno-remove-local-statics.
	* gcc.dg/tree-ssa/ssa-dse-6.c: Likewise.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	Mark Mitchell  <mark@codesourcery.com>
	Vladimir Prus  <vladimir@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>
	Carlos O'Donell  <carlos@codesourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Kazu Hirata  <kazu@codesourcery.com>
	Pedro Alves  <pedro@codesourcery.com>

	libiberty/
	* configure.ac: Add cygpath for mingw hosts.
	* configure: Regenerate.
	* Makefile.in: Add cygpath.
	* cygpath.c: New.
	* lrealpath.c (lrealpath): Use cygpath on Windows.
	* pex-win32.c (pex_win32_open_read, pex_win32_open_write): Use
	open not _open.

	include/
	* libiberty.h (cygpath): Declare.

	config/
	* mh-mingw (CFLAGS, BOOT_CFLAGS): Do not use -D__USE_MINGW_ACCESS.
	Add a comment.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Paul Brook  <paul@codesourcery.com>
	Andrew Stubbs  <ams@codesourcery.com>

	gcc/
	* doc/fragments.texi: Document MULTILIB_ALIASES.
	* genmultilib: Add aliases.
	* Makefile.in (s-mlib): Pass MULTILIB_ALIASES.
	* config/print-sysroot-suffix.sh: Add support for MULTILIB_ALIASES.
	* config/t-sysroot-suffix: Pass MULTILIB_ALIASES.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.4:
	
	2008-09-03  Nathan Froyd  <froydnj@codesourcery.com>
	libgomp/
	* libgomp.texi (Library Index): Renamed from "Index" to prevent
	conflict with index.html on case-insensitive file systems.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.4:

	2009-02-10  Mark Mitchell  <mark@codesourcery.com>
	libjava/classpath/
	* m4/acinclude.m4 (CLASSPATH_TOOLEXECLIBDIR): Match libjava.
	* configure.ac (--enable-version-specific-runtime-libs): Support.
	* Makefile.in, */Makefile.in: Regenerated.
	libjava/
	* Makefile.am (pkgconfigdir): Use toolexeclibdir, not $(libdir).
	* configure.ac (dbexecdir): Likewise.
	* configure: Regenerated.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merged from Sourcery G++ 4.4:

	2009-02-10  Mark Mitchell  <mark@codesourcery.com>

	libjava/
	* Makefile.am (jardir): Set to a target-specific location.
	* Makefile.in: Regenerate.
	gcc/java/
	* Make-lang.in: Adjust to match.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Daniel Jacobowitz  <dan@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>

	gcc/
	* doc/invoke.texi (-Wno-poison-system-directories): Document.
	* gcc.c (LINK_COMMAND_SPEC): Pass --no-poison-system-directories
	if -Wno-poison-system-directories and --error-poison-system-directories
	if -Werror=poison-system-directories to linker.
	* incpath.c: Include flags.h. Include toplev.h.
	(merge_include_chains): If ENABLE_POISON_SYSTEM_DIRECTORIES defined
	and flag_poison_system_directories is true, warn for use of
	/usr/include, /usr/local/include or /usr/X11R6/include.
	* Makefile.in (incpath.o): Depend on $(FLAGS_H) and toplev.h.
	* common.opt (--Wno-poison-system-directories): New.
	* configure.ac (--enable-poison-system-directories): New option.
	* configure: Regenerate.
	* config.in: Regenerate.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:
	
	2008-05-01  Carlos O'Donell  <carlos@codesourcery.com>

	* Makefile.tpl (install): Call install-html and install-pdf.
	* Makefile.in: Regenerate.
	
	gcc/
	* Makefile.in (install): Depend on install-html and install-pdf.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	Merge from Sourcery G++ 4.4:

	Mark Mitchell  <mark@codesourcery.com>
	Richard Sandiford  <richard@codesourcery.com>
	Joseph Myers  <joseph@codesourcery.com>
	Nathan Sidwell  <nathan@codesourcery.com>
	Nathan Froyd  <froydnj@codesourcery.com>

	NOT ASSIGNED TO FSF
	COPYRIGHT CODESOURCERY
	
	gcc/
	* Makefile.in (CSL_LICENSEINC): Define it.
	(CSL_LICENSELIB): Likewise.
	(CSL_LICENSE_PROG): Likewise.
	(LIBS): Depend on CSL_LICENSELIB.
	(GCC_PASSES): Depend on CSL_LICENSE_PROG.
	(INCLUDES): Add CSL_LICENSEINC.
	* acinclude.m4 (--with-license): New option.
	(--with-csl-license-feature): Likewise.
	(--with-csl-license-version): Likewise.
	* gcc.c (csl/license.h): Include, if required.
	(license_checked, license_me_flag, feature_proxy_flag): New variables.
	Define license_me_flag 1 if not TARGET_FLEXLM.
	(process_command): Handle -flicense-me, -ffeature-proxy and
	-fno-feature-proxy.  Initialize license_checked.
	(main): Check licenses.
	* configure.ac (CSL_AC_LICENSE_VERSION): Use it.
	(CSL_AC_LICENSE): Likewise.
	(CSL_AC_LICENSE_FEATURE): Likewise.
	* config.in: Regenerated.
	* configure: Regenerated.

2010-06-28  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml: New.


Local Variables:
mode: change-log
change-log-default-name: "ChangeLog.csl"
End:

